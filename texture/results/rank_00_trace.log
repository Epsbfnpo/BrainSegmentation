2025-11-09 09:03:50 [rank 0] starting dataloader creation
2025-11-09 09:03:50 [rank 0] dataloaders ready
2025-11-09 09:03:50 [rank 0] dataset stats -> train_samples=851, val_samples=18, train_steps_per_epoch=426, val_steps=18
2025-11-09 09:03:50 [rank 0] train dataset length=851
2025-11-09 09:03:55 [rank 0] train[0]: domain=0, fg_frac=0.910, unique_labels=[-1, 1, 8, 9, 11, 13, 15, 16, 17, 18, 19, 21]..., texture_stats=mean=1.3667, std=4.5866, min=-8.5097, max=10.0000
2025-11-09 09:03:57 [rank 0] train[1]: domain=0, fg_frac=0.990, unique_labels=[-1, 0, 1, 2, 3, 8, 9, 11, 13, 18, 19, 21]..., texture_stats=mean=1.3442, std=4.7558, min=-9.7258, max=10.0000
2025-11-09 09:03:58 [rank 0] train[2]: domain=0, fg_frac=0.606, unique_labels=[-1, 10, 20, 22, 28, 30, 32, 33, 34, 35, 36, 37]..., texture_stats=mean=1.1347, std=4.8878, min=-8.1937, max=10.0000
2025-11-09 09:04:00 [rank 0] train[3]: domain=0, fg_frac=0.294, unique_labels=[-1, 9, 9, 19, 19, 20, 30, 30, 30, 30, 31, 31]..., texture_stats=mean=1.1817, std=4.9264, min=-8.4646, max=10.0000
2025-11-09 09:04:00 [rank 0] train foreground fraction stats -> mean=0.700, min=0.294, max=0.990
2025-11-09 09:04:00 [rank 0] train domain counts (first 4 samples) -> {0: 4}
2025-11-09 09:04:00 [rank 0] train union of labels across inspected samples: [-1, 0, 1, 2, 3, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]...
2025-11-09 09:04:00 [rank 0] val dataset length=18
2025-11-09 09:04:01 [rank 0] val[0]: domain=1, fg_frac=0.780, unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., texture_stats=mean=1.2037, std=3.4528, min=-3.6254, max=10.0000
2025-11-09 09:04:02 [rank 0] val[1]: domain=1, fg_frac=0.752, unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., texture_stats=mean=1.1999, std=3.4036, min=-3.4090, max=10.0000
2025-11-09 09:04:02 [rank 0] val foreground fraction stats -> mean=0.766, min=0.752, max=0.780
2025-11-09 09:04:02 [rank 0] val domain counts (first 2 samples) -> {1: 2}
2025-11-09 09:04:02 [rank 0] val union of labels across inspected samples: [-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]...
2025-11-09 09:04:03 [rank 0] texture feature dimension inferred
2025-11-09 09:04:03 [rank 0] model constructed and moved to device
2025-11-09 09:04:04 [rank 0] segmenter parameter summary before loading weights -> params=62190873, rms=1.5857e-02, max=1.0000e+00
2025-11-09 09:04:04 [rank 0] optimizer and scheduler ready
2025-11-09 09:04:06 [rank 0] segmenter parameter summary after loading weights -> params=62190873, rms=2.2317e-02, max=1.5882e+00
2025-11-09 09:04:06 [rank 0] entered training loop
2025-11-09 09:04:06 [rank 0] before can_start_epoch decision
2025-11-09 09:04:06 [rank 0] after can_start_epoch decision -> True
2025-11-09 09:04:06 [rank 0] starting train_epoch
2025-11-09 09:04:34 [rank 0] step 0050: total=1.8566, seg=1.8566, domain=0.6917, align=0.0000, stats_align=0.0000, dom_acc=0.500, fg_frac=0.270, label_range=[-1,83], unique_labels=[-1, 9, 16, 17, 19, 20, 21, 22, 25, 27, 30, 32]..., domain_counts=d0=2, grad_norm=2.285e+01, seg_grad=2.285e+01, tex_grad=0.000e+00, stats_grad=0.000e+00, enc_grad=0.000e+00, dom_grad=0.000e+00, pred_conf=0.667±0.257, pred_entropy=1.154, prob_range=[0.000,1.000], fg_match=0.442, top_preds=[(82, 514634), (84, 260511), (83, 205808), (78, 122898), (46, 120168)], dom_logits={'mean': 0.10160064697265625, 'std': 0.0953538790345192, 'max': 0.2318115234375, 'min': -0.034820556640625, 'margin': 0.0566936731338501}
2025-11-09 09:04:44 [rank 0] step 0100: total=1.6142, seg=1.6142, domain=0.6653, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.427, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=0, d1=2, grad_norm=8.041e+00, seg_grad=8.041e+00, tex_grad=0.000e+00, stats_grad=0.000e+00, enc_grad=0.000e+00, dom_grad=0.000e+00, pred_conf=0.581±0.303, pred_entropy=1.559, prob_range=[0.000,1.000], fg_match=0.416, top_preds=[(82, 470287), (83, 196569), (84, 169007), (78, 56941), (70, 52086)], dom_logits={'mean': 0.021976828575134277, 'std': 0.04653408005833626, 'max': 0.10003662109375, 'min': -0.0223236083984375, 'margin': 0.02845369279384613}
2025-11-09 09:04:53 [rank 0] step 0150: total=1.1829, seg=1.1829, domain=0.6511, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.197, label_range=[-1,83], unique_labels=[-1, 33, 34, 35, 36, 37, 38, 76, 77, 78, 79, 80]..., domain_counts=d0=2, grad_norm=1.051e+01, seg_grad=1.051e+01, tex_grad=0.000e+00, stats_grad=0.000e+00, enc_grad=0.000e+00, dom_grad=0.000e+00, pred_conf=0.588±0.278, pred_entropy=1.473, prob_range=[0.000,1.000], fg_match=0.528, top_preds=[(82, 516708), (84, 233836), (83, 156204), (22, 154910), (46, 104072)], dom_logits={'mean': 0.1531982421875, 'std': 0.0833253487944603, 'max': 0.2529296875, 'min': 0.0267333984375, 'margin': 0.04293462634086609}
2025-11-09 09:05:03 [rank 0] step 0200: total=1.8543, seg=1.8543, domain=0.6265, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.403, label_range=[-1,85], unique_labels=[-1, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]..., domain_counts=d0=1, d1=1, grad_norm=9.195e+00, seg_grad=9.195e+00, tex_grad=0.000e+00, stats_grad=0.000e+00, enc_grad=0.000e+00, dom_grad=0.000e+00, pred_conf=0.607±0.281, pred_entropy=1.451, prob_range=[0.000,1.000], fg_match=0.358, top_preds=[(82, 388109), (83, 214869), (84, 157566), (79, 67388), (16, 66714)], dom_logits={'mean': 0.05969047546386719, 'std': 0.06958278268575668, 'max': 0.1419677734375, 'min': -0.0130767822265625, 'margin': 0.06876976788043976}
2025-11-09 09:05:13 [rank 0] step 0250: total=0.7254, seg=0.7254, domain=0.6558, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.514, label_range=[-1,83], unique_labels=[-1, 6, 8, 9, 13, 14, 15, 16, 17, 18, 19, 20]..., domain_counts=d0=2, grad_norm=2.613e+00, seg_grad=2.613e+00, tex_grad=0.000e+00, stats_grad=0.000e+00, enc_grad=0.000e+00, dom_grad=0.000e+00, pred_conf=0.720±0.231, pred_entropy=1.034, prob_range=[0.000,1.000], fg_match=0.889, top_preds=[(82, 387669), (83, 263146), (84, 179865), (79, 123837), (17, 110457)], dom_logits={'mean': 0.1126251220703125, 'std': 0.05102253332734108, 'max': 0.192138671875, 'min': 0.05023193359375, 'margin': 0.0379885733127594}
2025-11-09 09:05:23 [rank 0] step 0300: total=0.7904, seg=0.7904, domain=0.6685, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.355, label_range=[-1,86], unique_labels=[-1, 11, 19, 31, 32, 33, 34, 35, 36, 37, 39, 40]..., domain_counts=d0=2, grad_norm=7.016e+00, seg_grad=7.016e+00, tex_grad=0.000e+00, stats_grad=0.000e+00, enc_grad=0.000e+00, dom_grad=0.000e+00, pred_conf=0.664±0.270, pred_entropy=1.221, prob_range=[0.000,1.000], fg_match=0.777, top_preds=[(82, 508820), (84, 230388), (78, 226173), (83, 207693), (35, 157250)], dom_logits={'mean': 0.187957763671875, 'std': 0.03592865169048309, 'max': 0.2418212890625, 'min': 0.140625, 'margin': 0.02552163600921631}
2025-11-09 09:05:33 [rank 0] step 0350: total=1.7380, seg=1.7380, domain=0.7095, align=0.0000, stats_align=0.0000, dom_acc=0.500, fg_frac=0.550, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=2, grad_norm=4.314e+00, seg_grad=4.314e+00, tex_grad=0.000e+00, stats_grad=0.000e+00, enc_grad=0.000e+00, dom_grad=0.000e+00, pred_conf=0.682±0.279, pred_entropy=1.124, prob_range=[0.000,1.000], fg_match=0.569, top_preds=[(82, 420664), (83, 187250), (84, 163878), (78, 130011), (79, 106950)], dom_logits={'mean': 0.05169963836669922, 'std': 0.05466809868812561, 'max': 0.1412353515625, 'min': -0.007129669189453125, 'margin': 0.037888139486312866}
2025-11-09 09:05:43 [rank 0] step 0400: total=0.8856, seg=0.8856, domain=0.6960, align=0.0000, stats_align=0.0000, dom_acc=0.500, fg_frac=0.374, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 8, 9, 10, 12]..., domain_counts=d0=1, d1=1, grad_norm=5.897e+00, seg_grad=5.897e+00, tex_grad=0.000e+00, stats_grad=0.000e+00, enc_grad=0.000e+00, dom_grad=0.000e+00, pred_conf=0.650±0.265, pred_entropy=1.239, prob_range=[0.000,1.000], fg_match=0.707, top_preds=[(82, 513027), (83, 333818), (84, 148636), (79, 135172), (36, 91202)], dom_logits={'mean': -0.00553131103515625, 'std': 0.06696911156177521, 'max': 0.073486328125, 'min': -0.078857421875, 'margin': 0.010016962885856628}
2025-11-09 09:05:48 [rank 0] finished train_epoch
2025-11-09 09:05:48 [rank 0] epoch 1 train summary -> total=1.2140, seg=1.2140, domain=0.6734, align=0.0000, stats=0.0000, dom_acc=0.641, batches=426
2025-11-09 09:05:48 [rank 0] epoch 1 train label dist top -> [(82, 52500720, 0.1497528636711897), (83, 32086984, 0.09152479700414862), (78, 23376914, 0.06668022486729946), (79, 22107864, 0.06306039124136208), (35, 16491226, 0.04703951334284138)], pred dist top -> [(82, 57312052, 0.16347668638648044), (83, 33416840, 0.09531807154116896), (78, 26139396, 0.07455991703497236), (79, 22398838, 0.06389036314992841), (36, 18057858, 0.051508167759856116)], fg_fraction=0.466
2025-11-09 09:05:48 [rank 0] epoch 1 parameter stats -> seg_rms=2.2327e-02 (Δ9.21e-06), domain_rms=1.0046e-01 (Δ0.00e+00), texproj_rms=6.2314e-02 (Δ0.00e+00), statsproj_rms=1.2761e-01 (Δ0.00e+00), encoder_rms=3.2163e-02 (Δ0.00e+00)
2025-11-09 09:05:48 [rank 0] checking should_stop
2025-11-09 09:05:48 [rank 0] should_stop -> False
2025-11-09 09:05:48 [rank 0] before can_run_validation decision
2025-11-09 09:05:48 [rank 0] after can_run_validation -> True
2025-11-09 09:05:48 [rank 0] starting validation on main rank
2025-11-09 09:05:51 [rank 0] val-step 001: loss=0.8834, fg_frac=0.780, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.698±0.238, pred_entropy=1.061, prob_range=[0.000,1.000], fg_match=0.640, top_preds=[(82, 158045), (83, 120413), (79, 74236), (36, 48034), (84, 38991)], batch_label_top=[(82, 81983.0), (78, 50461.0), (79, 48532.0), (83, 45983.0), (36, 37134.0)], batch_pred_top=[(82, 94304.0), (79, 74234.0), (83, 53213.0), (36, 47804.0), (81, 35803.0)]
2025-11-09 09:05:51 [rank 0] val-step 002: loss=0.9032, fg_frac=0.752, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.684±0.241, pred_entropy=1.073, prob_range=[0.000,1.000], fg_match=0.636, top_preds=[(82, 149859), (83, 127507), (79, 79433), (84, 44236), (36, 38049)], batch_label_top=[(82, 81668.0), (83, 55922.0), (79, 48795.0), (78, 46165.0), (36, 40828.0)], batch_pred_top=[(82, 101288.0), (79, 77583.0), (83, 60051.0), (78, 36448.0), (36, 34425.0)]
2025-11-09 09:05:52 [rank 0] finished validation on main rank
2025-11-09 09:05:52 [rank 0] epoch 1 val summary -> loss=1.0443, dice=0.0214, duration=3.72s
2025-11-09 09:05:52 [rank 0] epoch 1 val label dist top -> [(82, 1584556, 0.14381113912911525), (83, 1574683, 0.14291508535971753), (78, 733782, 0.06659658938683166), (79, 730461, 0.06629518205692488), (36, 469411, 0.04260280522098122)], pred dist top -> [(82, 1856280, 0.16847226689532843), (83, 1379570, 0.1252070190061781), (79, 1056569, 0.09589209309012124), (36, 588040, 0.053369336428302265), (78, 564060, 0.05119295950232667)], dice top -> [(83, 0.8401), (18, 0.8175), (82, 0.8015), (16, 0.6753), (48, 0.6629)]
2025-11-09 09:05:52 [rank 0] scheduler stepped
2025-11-09 09:05:52 [rank 0] epoch 1 lr=4.999692e-05, remaining=108.23 min (avg train=2.05, avg val=0.07)
2025-11-09 09:05:53 [rank 0] metrics logged and best model check complete
2025-11-09 09:05:53 [rank 0] epoch loop completed
2025-11-09 09:05:53 [rank 0] before can_start_epoch decision
2025-11-09 09:05:53 [rank 0] after can_start_epoch decision -> True
2025-11-09 09:05:53 [rank 0] starting train_epoch
2025-11-09 09:06:16 [rank 0] step 0050: total=1.2003, seg=1.1449, domain=0.7894, align=0.0002, stats_align=0.0034, dom_acc=0.500, fg_frac=0.373, label_range=[-1,84], unique_labels=[-1, 4, 6, 10, 11, 12, 20, 21, 22, 29, 31, 32]..., domain_counts=d0=1, d1=1, grad_norm=1.177e+01, seg_grad=1.177e+01, tex_grad=1.077e-02, stats_grad=2.203e-03, enc_grad=2.465e-04, dom_grad=1.649e-01, pred_conf=0.601±0.267, pred_entropy=1.501, prob_range=[0.000,1.000], fg_match=0.489, top_preds=[(82, 421446), (83, 359461), (80, 171417), (37, 157808), (84, 128220)], dom_logits={'mean': 0.047393798828125, 'std': 0.2993272542953491, 'max': 0.353515625, 'min': -0.336181640625, 'margin': 0.2833257019519806}
2025-11-09 09:06:26 [rank 0] step 0100: total=0.7142, seg=0.6437, domain=1.0076, align=0.0000, stats_align=0.0000, dom_acc=0.000, fg_frac=0.451, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11]..., domain_counts=d0=2, grad_norm=5.488e+00, seg_grad=5.475e+00, tex_grad=1.843e-02, stats_grad=2.904e-03, enc_grad=3.647e-04, dom_grad=3.821e-01, pred_conf=0.677±0.278, pred_entropy=1.161, prob_range=[0.000,1.000], fg_match=0.821, top_preds=[(82, 397791), (83, 231827), (84, 139380), (46, 75748), (35, 74650)], dom_logits={'mean': 0.02178955078125, 'std': 0.31536436080932617, 'max': 0.5146484375, 'min': -0.28564453125, 'margin': 0.26481378078460693}
2025-11-09 09:06:36 [rank 0] step 0150: total=1.2696, seg=1.2200, domain=0.7078, align=0.0000, stats_align=0.0000, dom_acc=0.500, fg_frac=0.515, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 7, 8, 9, 11, 13]..., domain_counts=d0=0, d1=2, grad_norm=4.036e+00, seg_grad=4.025e+00, tex_grad=1.514e-02, stats_grad=2.235e-03, enc_grad=3.531e-04, dom_grad=2.924e-01, pred_conf=0.657±0.272, pred_entropy=1.288, prob_range=[0.000,1.000], fg_match=0.433, top_preds=[(82, 404101), (83, 327653), (84, 138512), (38, 61132), (81, 53592)], dom_logits={'mean': -0.10137557983398438, 'std': 0.07668492197990417, 'max': -0.0074310302734375, 'min': -0.2210693359375, 'margin': 0.055540427565574646}
2025-11-09 09:06:45 [rank 0] step 0200: total=0.9077, seg=0.8584, domain=0.7036, align=0.0000, stats_align=0.0004, dom_acc=0.500, fg_frac=0.420, label_range=[-1,84], unique_labels=[-1, 16, 17, 21, 22, 23, 24, 25, 26, 27, 28, 29]..., domain_counts=d0=1, d1=1, grad_norm=2.958e+00, seg_grad=2.957e+00, tex_grad=5.918e-03, stats_grad=9.000e-04, enc_grad=1.121e-04, dom_grad=7.770e-02, pred_conf=0.645±0.260, pred_entropy=1.326, prob_range=[0.000,1.000], fg_match=0.782, top_preds=[(82, 444785), (83, 350173), (84, 226707), (21, 86521), (17, 66590)], dom_logits={'mean': -0.208892822265625, 'std': 0.04502619057893753, 'max': -0.13720703125, 'min': -0.26123046875, 'margin': 0.03334023058414459}
2025-11-09 09:06:55 [rank 0] step 0250: total=1.1513, seg=1.1030, domain=0.6907, align=0.0000, stats_align=0.0000, dom_acc=0.500, fg_frac=0.423, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 8, 9, 10, 12]..., domain_counts=d0=2, grad_norm=1.084e+01, seg_grad=1.083e+01, tex_grad=1.573e-02, stats_grad=2.563e-03, enc_grad=2.531e-04, dom_grad=2.797e-01, pred_conf=0.647±0.262, pred_entropy=1.239, prob_range=[0.000,1.000], fg_match=0.598, top_preds=[(82, 449515), (83, 276016), (84, 157799), (16, 86950), (22, 80045)], dom_logits={'mean': -0.1566162109375, 'std': 0.10080955922603607, 'max': -0.04925537109375, 'min': -0.265380859375, 'margin': 0.10018204152584076}
2025-11-09 09:07:05 [rank 0] step 0300: total=0.8295, seg=0.7713, domain=0.8306, align=0.0000, stats_align=0.0000, dom_acc=0.000, fg_frac=0.788, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 8, 9, 10, 12]..., domain_counts=d0=2, grad_norm=5.153e+00, seg_grad=5.142e+00, tex_grad=2.200e-02, stats_grad=3.945e-03, enc_grad=4.525e-04, dom_grad=3.392e-01, pred_conf=0.792±0.213, pred_entropy=0.680, prob_range=[0.000,1.000], fg_match=0.662, top_preds=[(82, 253787), (83, 190283), (79, 167299), (84, 100691), (36, 97406)], dom_logits={'mean': -0.139373779296875, 'std': 0.1580718606710434, 'max': 0.09271240234375, 'min': -0.34619140625, 'margin': 0.12832686305046082}
2025-11-09 09:07:15 [rank 0] step 0350: total=0.6773, seg=0.5964, domain=1.1553, align=0.0000, stats_align=0.0000, dom_acc=0.000, fg_frac=0.267, label_range=[-1,84], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11]..., domain_counts=d0=2, grad_norm=5.971e+00, seg_grad=5.955e+00, tex_grad=2.572e-02, stats_grad=3.995e-03, enc_grad=4.934e-04, dom_grad=4.334e-01, pred_conf=0.641±0.307, pred_entropy=1.389, prob_range=[0.000,1.000], fg_match=0.917, top_preds=[(82, 435104), (83, 361991), (84, 199351), (46, 139611), (22, 66692)], dom_logits={'mean': -0.0933837890625, 'std': 0.39086759090423584, 'max': 0.33154296875, 'min': -0.52978515625, 'margin': 0.3700988292694092}
2025-11-09 09:07:25 [rank 0] step 0400: total=0.8466, seg=0.7912, domain=0.7904, align=0.0001, stats_align=0.0037, dom_acc=0.500, fg_frac=0.474, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=1, d1=1, grad_norm=8.597e+00, seg_grad=8.595e+00, tex_grad=9.272e-03, stats_grad=1.096e-03, enc_grad=1.200e-04, dom_grad=2.010e-01, pred_conf=0.680±0.251, pred_entropy=1.140, prob_range=[0.000,1.000], fg_match=0.716, top_preds=[(83, 367701), (82, 351341), (84, 170249), (78, 150736), (46, 107832)], dom_logits={'mean': 0.21539306640625, 'std': 0.6072651743888855, 'max': 0.91796875, 'min': -0.43798828125, 'margin': 0.5362609624862671}
2025-11-09 09:07:30 [rank 0] finished train_epoch
2025-11-09 09:07:30 [rank 0] epoch 2 train summary -> total=1.0355, seg=0.9730, domain=0.8934, align=0.0000, stats=0.0010, dom_acc=0.325, batches=426
2025-11-09 09:07:30 [rank 0] epoch 2 train label dist top -> [(82, 53876060, 0.1505445266531011), (83, 31525808, 0.08809177662057226), (78, 24874616, 0.06950651720630008), (79, 23551556, 0.06580952374698527), (35, 17529484, 0.04898219861016395)], pred dist top -> [(82, 58116656, 0.16239392069253403), (83, 34160704, 0.09545440219714517), (79, 25468252, 0.07116530062337845), (78, 25155248, 0.07029068136186337), (36, 20509716, 0.057309787292826965)], fg_fraction=0.475
2025-11-09 09:07:30 [rank 0] epoch 2 parameter stats -> seg_rms=2.2337e-02 (Δ1.09e-05), domain_rms=9.9874e-02 (Δ-5.90e-04), texproj_rms=6.2716e-02 (Δ4.02e-04), statsproj_rms=1.2789e-01 (Δ2.75e-04), encoder_rms=3.2365e-02 (Δ2.01e-04)
2025-11-09 09:07:30 [rank 0] checking should_stop
2025-11-09 09:07:30 [rank 0] should_stop -> False
2025-11-09 09:07:30 [rank 0] before can_run_validation decision
2025-11-09 09:07:30 [rank 0] after can_run_validation -> True
2025-11-09 09:07:30 [rank 0] starting validation on main rank
2025-11-09 09:07:32 [rank 0] val-step 001: loss=0.6837, fg_frac=0.780, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.692±0.224, pred_entropy=1.124, prob_range=[0.000,1.000], fg_match=0.785, top_preds=[(82, 144599), (83, 128381), (79, 48909), (78, 45089), (36, 45056)], batch_label_top=[(82, 81983.0), (78, 50461.0), (79, 48532.0), (83, 45983.0), (36, 37134.0)], batch_pred_top=[(82, 89596.0), (83, 56114.0), (79, 48901.0), (36, 44976.0), (78, 44805.0)]
2025-11-09 09:07:32 [rank 0] val-step 002: loss=0.6743, fg_frac=0.752, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.702±0.226, pred_entropy=1.072, prob_range=[0.000,1.000], fg_match=0.770, top_preds=[(83, 143704), (82, 142707), (79, 57118), (78, 46547), (36, 42183)], batch_label_top=[(82, 81668.0), (83, 55922.0), (79, 48795.0), (78, 46165.0), (36, 40828.0)], batch_pred_top=[(82, 93143.0), (83, 62546.0), (79, 56892.0), (78, 44728.0), (36, 41883.0)]
2025-11-09 09:07:33 [rank 0] finished validation on main rank
2025-11-09 09:07:33 [rank 0] epoch 2 val summary -> loss=0.8179, dice=0.0300, duration=2.78s
2025-11-09 09:07:33 [rank 0] epoch 2 val label dist top -> [(82, 1584556, 0.14381113912911525), (83, 1574683, 0.14291508535971753), (78, 733782, 0.06659658938683166), (79, 730461, 0.06629518205692488), (36, 469411, 0.04260280522098122)], pred dist top -> [(82, 1742168, 0.1581156895902022), (83, 1460907, 0.13258900274379595), (79, 887457, 0.08054382558780329), (36, 690577, 0.0626753898419286), (78, 591450, 0.05367882122052815)], dice top -> [(83, 0.8689), (18, 0.855), (82, 0.8285), (16, 0.8097), (17, 0.7838)]
2025-11-09 09:07:33 [rank 0] scheduler stepped
2025-11-09 09:07:33 [rank 0] epoch 2 lr=4.998766e-05, remaining=106.55 min (avg train=1.99, avg val=0.07)
2025-11-09 09:07:34 [rank 0] metrics logged and best model check complete
2025-11-09 09:07:34 [rank 0] epoch loop completed
2025-11-09 09:07:34 [rank 0] before can_start_epoch decision
2025-11-09 09:07:34 [rank 0] after can_start_epoch decision -> True
2025-11-09 09:07:34 [rank 0] starting train_epoch
2025-11-09 09:07:57 [rank 0] step 0050: total=1.1107, seg=1.0411, domain=0.4973, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.388, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=0, d1=2, grad_norm=6.770e+00, seg_grad=6.748e+00, tex_grad=3.718e-02, stats_grad=5.622e-03, enc_grad=9.461e-04, dom_grad=5.467e-01, pred_conf=0.572±0.259, pred_entropy=1.648, prob_range=[0.000,1.000], fg_match=0.636, top_preds=[(83, 436755), (82, 412959), (84, 140833), (46, 137516), (78, 51562)], dom_logits={'mean': 0.24205780029296875, 'std': 0.22612515091896057, 'max': 0.53076171875, 'min': 0.01007080078125, 'margin': 0.21698875725269318}
2025-11-09 09:08:07 [rank 0] step 0100: total=1.1272, seg=0.9989, domain=0.9167, align=0.0000, stats_align=0.0000, dom_acc=0.000, fg_frac=0.280, label_range=[-1,84], unique_labels=[-1, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15]..., domain_counts=d0=2, grad_norm=2.429e+01, seg_grad=2.428e+01, tex_grad=5.922e-02, stats_grad=8.757e-03, enc_grad=1.320e-03, dom_grad=7.629e-01, pred_conf=0.594±0.271, pred_entropy=1.528, prob_range=[0.000,1.000], fg_match=0.536, top_preds=[(83, 418364), (82, 365350), (84, 137715), (80, 126990), (37, 109509)], dom_logits={'mean': 0.11199951171875, 'std': 0.21267248690128326, 'max': 0.3330078125, 'min': -0.1822509765625, 'margin': 0.1986716091632843}
2025-11-09 09:08:17 [rank 0] step 0150: total=1.0871, seg=0.9879, domain=0.7073, align=0.0000, stats_align=0.0026, dom_acc=0.500, fg_frac=0.455, label_range=[-1,86], unique_labels=[-1, 1, 3, 5, 7, 9, 11, 13, 15, 16, 17, 18]..., domain_counts=d0=1, d1=1, grad_norm=7.070e+00, seg_grad=7.067e+00, tex_grad=1.765e-02, stats_grad=2.115e-03, enc_grad=2.641e-04, dom_grad=2.003e-01, pred_conf=0.631±0.283, pred_entropy=1.433, prob_range=[0.000,1.000], fg_match=0.627, top_preds=[(83, 407612), (82, 393123), (84, 110482), (46, 79088), (79, 50866)], dom_logits={'mean': 0.043121337890625, 'std': 0.17613258957862854, 'max': 0.22802734375, 'min': -0.1446533203125, 'margin': 0.1740221232175827}
2025-11-09 09:08:27 [rank 0] step 0200: total=1.6895, seg=1.5452, domain=1.0303, align=0.0000, stats_align=0.0000, dom_acc=0.000, fg_frac=0.373, label_range=[-1,86], unique_labels=[-1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13]..., domain_counts=d0=2, grad_norm=5.276e+00, seg_grad=5.228e+00, tex_grad=3.711e-02, stats_grad=5.082e-03, enc_grad=6.665e-04, dom_grad=7.090e-01, pred_conf=0.550±0.264, pred_entropy=1.645, prob_range=[0.000,1.000], fg_match=0.575, top_preds=[(82, 399454), (83, 275762), (78, 120471), (36, 117435), (84, 116357)], dom_logits={'mean': 0.10308837890625, 'std': 0.29474231600761414, 'max': 0.400634765625, 'min': -0.2119140625, 'margin': 0.2861343026161194}
2025-11-09 09:08:37 [rank 0] step 0250: total=0.6413, seg=0.5403, domain=0.7217, align=0.0000, stats_align=0.0000, dom_acc=0.500, fg_frac=0.721, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=2, grad_norm=1.955e+00, seg_grad=1.881e+00, tex_grad=3.367e-02, stats_grad=4.723e-03, enc_grad=6.574e-04, dom_grad=5.331e-01, pred_conf=0.819±0.211, pred_entropy=0.672, prob_range=[0.000,1.000], fg_match=0.889, top_preds=[(83, 288229), (82, 262965), (78, 172166), (79, 147220), (35, 104557)], dom_logits={'mean': 0.1193389892578125, 'std': 0.05449267849326134, 'max': 0.213134765625, 'min': 0.08123779296875, 'margin': 0.029829442501068115}
2025-11-09 09:08:47 [rank 0] step 0300: total=0.5541, seg=0.4807, domain=0.5247, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.795, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=2, grad_norm=2.535e+00, seg_grad=2.489e+00, tex_grad=3.247e-02, stats_grad=3.988e-03, enc_grad=6.143e-04, dom_grad=4.788e-01, pred_conf=0.802±0.196, pred_entropy=0.740, prob_range=[0.000,1.000], fg_match=0.900, top_preds=[(82, 318228), (83, 243826), (79, 153669), (36, 111303), (78, 97970)], dom_logits={'mean': -0.03436279296875, 'std': 0.18864774703979492, 'max': 0.194580078125, 'min': -0.231201171875, 'margin': 0.1837901622056961}
2025-11-09 09:08:56 [rank 0] step 0350: total=0.8333, seg=0.7298, domain=0.7391, align=0.0000, stats_align=0.0011, dom_acc=0.500, fg_frac=0.367, label_range=[-1,86], unique_labels=[-1, 1, 3, 5, 7, 8, 9, 11, 13, 15, 16, 17]..., domain_counts=d0=1, d1=1, grad_norm=1.119e+01, seg_grad=1.119e+01, tex_grad=2.160e-02, stats_grad=2.445e-03, enc_grad=3.875e-04, dom_grad=2.767e-01, pred_conf=0.628±0.252, pred_entropy=1.418, prob_range=[0.000,1.000], fg_match=0.794, top_preds=[(83, 417771), (82, 362099), (84, 177572), (46, 142208), (17, 78322)], dom_logits={'mean': -0.1179962158203125, 'std': 0.2478412538766861, 'max': 0.1585693359375, 'min': -0.4287109375, 'margin': 0.23707804083824158}
2025-11-09 09:09:06 [rank 0] step 0400: total=0.9458, seg=0.8313, domain=0.8173, align=0.0001, stats_align=0.0022, dom_acc=0.500, fg_frac=0.540, label_range=[-1,86], unique_labels=[-1, 1, 3, 5, 7, 8, 9, 11, 13, 15, 16, 17]..., domain_counts=d0=1, d1=1, grad_norm=4.338e+00, seg_grad=4.328e+00, tex_grad=2.543e-02, stats_grad=4.412e-03, enc_grad=7.528e-04, dom_grad=2.924e-01, pred_conf=0.743±0.239, pred_entropy=0.964, prob_range=[0.000,1.000], fg_match=0.654, top_preds=[(83, 404707), (82, 299868), (84, 149098), (46, 76309), (16, 62800)], dom_logits={'mean': -0.097900390625, 'std': 0.3961198627948761, 'max': 0.31591796875, 'min': -0.564453125, 'margin': 0.37263569235801697}
2025-11-09 09:09:11 [rank 0] finished train_epoch
2025-11-09 09:09:11 [rank 0] epoch 3 train summary -> total=1.0496, seg=0.9441, domain=0.7535, align=0.0000, stats=0.0011, dom_acc=0.466, batches=426
2025-11-09 09:09:11 [rank 0] epoch 3 train label dist top -> [(82, 53751064, 0.1494672935385325), (83, 32395632, 0.09008356443902724), (79, 22065440, 0.06135807093115174), (78, 21905240, 0.060912597695033606), (36, 15989659, 0.044462953427936575)], pred dist top -> [(82, 57842656, 0.16084491133412895), (83, 35422968, 0.09850177258720082), (79, 23420172, 0.0651252163934182), (78, 21724592, 0.06041026321492096), (36, 18577940, 0.05166026802211101)], fg_fraction=0.478
2025-11-09 09:09:11 [rank 0] epoch 3 parameter stats -> seg_rms=2.2352e-02 (Δ1.44e-05), domain_rms=9.9602e-02 (Δ-2.71e-04), texproj_rms=6.2965e-02 (Δ2.49e-04), statsproj_rms=1.2812e-01 (Δ2.32e-04), encoder_rms=3.2561e-02 (Δ1.96e-04)
2025-11-09 09:09:11 [rank 0] checking should_stop
2025-11-09 09:09:11 [rank 0] should_stop -> False
2025-11-09 09:09:11 [rank 0] before can_run_validation decision
2025-11-09 09:09:11 [rank 0] after can_run_validation -> True
2025-11-09 09:09:11 [rank 0] starting validation on main rank
2025-11-09 09:09:13 [rank 0] val-step 001: loss=0.6754, fg_frac=0.780, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.672±0.222, pred_entropy=1.130, prob_range=[0.000,1.000], fg_match=0.778, top_preds=[(83, 136507), (82, 124552), (79, 52538), (78, 44501), (36, 41033)], batch_label_top=[(82, 81983.0), (78, 50461.0), (79, 48532.0), (83, 45983.0), (36, 37134.0)], batch_pred_top=[(82, 90205.0), (83, 52976.0), (79, 52538.0), (78, 43907.0), (36, 40924.0)]
2025-11-09 09:09:13 [rank 0] val-step 002: loss=0.7038, fg_frac=0.752, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.694±0.223, pred_entropy=1.042, prob_range=[0.000,1.000], fg_match=0.735, top_preds=[(83, 149391), (82, 124125), (79, 51545), (78, 50553), (80, 44530)], batch_label_top=[(82, 81668.0), (83, 55922.0), (79, 48795.0), (78, 46165.0), (36, 40828.0)], batch_pred_top=[(82, 90463.0), (83, 57654.0), (79, 51384.0), (78, 50245.0), (80, 44517.0)]
2025-11-09 09:09:14 [rank 0] finished validation on main rank
2025-11-09 09:09:14 [rank 0] epoch 3 val summary -> loss=0.7729, dice=0.0316, duration=2.73s
2025-11-09 09:09:14 [rank 0] epoch 3 val label dist top -> [(82, 1584556, 0.14381113912911525), (83, 1574683, 0.14291508535971753), (78, 733782, 0.06659658938683166), (79, 730461, 0.06629518205692488), (36, 469411, 0.04260280522098122)], pred dist top -> [(82, 1704711, 0.15471616704990745), (83, 1413059, 0.12824641378824633), (78, 761988, 0.06915650963595876), (79, 756421, 0.06865125982999937), (80, 566445, 0.051409417340877624)], dice top -> [(83, 0.8825), (18, 0.8687), (82, 0.8465), (17, 0.7741), (16, 0.7731)]
2025-11-09 09:09:14 [rank 0] scheduler stepped
2025-11-09 09:09:14 [rank 0] epoch 3 lr=4.997225e-05, remaining=104.86 min (avg train=1.97, avg val=0.06)
2025-11-09 09:09:15 [rank 0] metrics logged and best model check complete
2025-11-09 09:09:15 [rank 0] epoch loop completed
2025-11-09 09:09:15 [rank 0] before can_start_epoch decision
2025-11-09 09:09:15 [rank 0] after can_start_epoch decision -> True
2025-11-09 09:09:15 [rank 0] starting train_epoch
2025-11-09 09:09:38 [rank 0] step 0050: total=0.6744, seg=0.5659, domain=0.5170, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.730, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=2, grad_norm=2.061e+00, seg_grad=1.971e+00, tex_grad=9.203e-02, stats_grad=2.038e-02, enc_grad=2.163e-03, dom_grad=5.975e-01, pred_conf=0.763±0.221, pred_entropy=0.856, prob_range=[0.000,1.000], fg_match=0.880, top_preds=[(82, 265864), (83, 255321), (79, 129629), (46, 123520), (84, 94073)], dom_logits={'mean': -0.1034393310546875, 'std': 0.19828571379184723, 'max': 0.1142578125, 'min': -0.339111328125, 'margin': 0.1929955929517746}
2025-11-09 09:09:48 [rank 0] step 0100: total=1.2354, seg=1.1083, domain=0.6052, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.444, label_range=[-1,84], unique_labels=[-1, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12]..., domain_counts=d0=2, grad_norm=4.867e+00, seg_grad=4.821e+00, tex_grad=1.004e-01, stats_grad=2.568e-02, enc_grad=2.826e-03, dom_grad=6.550e-01, pred_conf=0.692±0.257, pred_entropy=1.146, prob_range=[0.000,1.000], fg_match=0.762, top_preds=[(83, 411668), (82, 343105), (84, 166297), (79, 160445), (36, 79676)], dom_logits={'mean': -0.1042938232421875, 'std': 0.11568748950958252, 'max': 0.04833984375, 'min': -0.274658203125, 'margin': 0.0919715166091919}
2025-11-09 09:09:58 [rank 0] step 0150: total=1.1427, seg=0.9631, domain=0.8538, align=0.0029, stats_align=0.0015, dom_acc=0.500, fg_frac=0.467, label_range=[-1,85], unique_labels=[-1, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 13]..., domain_counts=d0=1, d1=1, grad_norm=2.916e+00, seg_grad=2.837e+00, tex_grad=1.725e-01, stats_grad=8.374e-02, enc_grad=1.276e-02, dom_grad=6.444e-01, pred_conf=0.635±0.263, pred_entropy=1.369, prob_range=[0.000,1.000], fg_match=0.572, top_preds=[(83, 485492), (82, 377311), (84, 113159), (36, 104410), (79, 101922)], dom_logits={'mean': -0.0131988525390625, 'std': 0.2119811326265335, 'max': 0.33837890625, 'min': -0.2301025390625, 'margin': 0.1400453746318817}
2025-11-09 09:10:08 [rank 0] step 0200: total=1.0667, seg=0.8919, domain=0.8323, align=0.0000, stats_align=0.0000, dom_acc=0.000, fg_frac=0.641, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=2, grad_norm=3.049e+00, seg_grad=2.936e+00, tex_grad=1.511e-01, stats_grad=3.412e-02, enc_grad=6.062e-03, dom_grad=8.055e-01, pred_conf=0.704±0.265, pred_entropy=1.095, prob_range=[0.000,1.000], fg_match=0.759, top_preds=[(82, 213499), (83, 185462), (84, 141671), (46, 100047), (17, 85022)], dom_logits={'mean': 0.0929412841796875, 'std': 0.15430596470832825, 'max': 0.27783203125, 'min': -0.1431884765625, 'margin': 0.12603621184825897}
2025-11-09 09:10:18 [rank 0] step 0250: total=1.2400, seg=1.0811, domain=0.7561, align=0.0006, stats_align=0.0009, dom_acc=0.500, fg_frac=0.468, label_range=[-1,85], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=1, d1=1, grad_norm=5.222e+00, seg_grad=5.203e+00, tex_grad=5.836e-02, stats_grad=1.223e-02, enc_grad=1.642e-03, dom_grad=4.364e-01, pred_conf=0.649±0.265, pred_entropy=1.371, prob_range=[0.000,1.000], fg_match=0.636, top_preds=[(83, 402090), (82, 307308), (84, 167616), (46, 144366), (78, 97202)], dom_logits={'mean': 0.07275390625, 'std': 0.2242230623960495, 'max': 0.291748046875, 'min': -0.223876953125, 'margin': 0.21338899433612823}
2025-11-09 09:10:28 [rank 0] step 0300: total=0.8888, seg=0.7373, domain=0.7195, align=0.0013, stats_align=0.0056, dom_acc=0.500, fg_frac=0.509, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=1, d1=1, grad_norm=2.400e+00, seg_grad=2.362e+00, tex_grad=5.384e-02, stats_grad=1.209e-02, enc_grad=1.493e-03, dom_grad=4.248e-01, pred_conf=0.671±0.256, pred_entropy=1.270, prob_range=[0.000,1.000], fg_match=0.815, top_preds=[(83, 361547), (82, 331735), (84, 177714), (22, 81519), (36, 66155)], dom_logits={'mean': -0.2635650634765625, 'std': 0.13189785182476044, 'max': -0.10479736328125, 'min': -0.468505859375, 'margin': 0.07790999114513397}
2025-11-09 09:10:38 [rank 0] step 0350: total=1.3489, seg=1.2032, domain=0.6931, align=0.0001, stats_align=0.0011, dom_acc=0.500, fg_frac=0.526, label_range=[-1,86], unique_labels=[-1, 11, 16, 17, 19, 20, 21, 22, 23, 24, 25, 27]..., domain_counts=d0=1, d1=1, grad_norm=1.330e+01, seg_grad=1.330e+01, tex_grad=3.916e-02, stats_grad=5.571e-03, enc_grad=8.778e-04, dom_grad=3.489e-01, pred_conf=0.636±0.260, pred_entropy=1.360, prob_range=[0.000,1.000], fg_match=0.338, top_preds=[(83, 367097), (82, 260606), (79, 195271), (36, 114533), (84, 112904)], dom_logits={'mean': -0.2822113037109375, 'std': 0.13484102487564087, 'max': -0.09771728515625, 'min': -0.472412109375, 'margin': 0.07585738599300385}
2025-11-09 09:10:48 [rank 0] step 0400: total=1.3257, seg=1.2036, domain=0.5818, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.539, label_range=[-1,84], unique_labels=[-1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]..., domain_counts=d0=2, grad_norm=4.616e+00, seg_grad=4.535e+00, tex_grad=8.311e-02, stats_grad=1.196e-02, enc_grad=1.857e-03, dom_grad=8.538e-01, pred_conf=0.697±0.248, pred_entropy=1.074, prob_range=[0.000,1.000], fg_match=0.761, top_preds=[(83, 372003), (82, 292178), (78, 192898), (35, 158865), (84, 138017)], dom_logits={'mean': -0.38726806640625, 'std': 0.15517814457416534, 'max': -0.140869140625, 'min': -0.5625, 'margin': 0.12107859551906586}
2025-11-09 09:10:53 [rank 0] finished train_epoch
2025-11-09 09:10:53 [rank 0] epoch 4 train summary -> total=1.0746, seg=0.9242, domain=0.7155, align=0.0005, stats=0.0011, dom_acc=0.567, batches=426
2025-11-09 09:10:53 [rank 0] epoch 4 train label dist top -> [(82, 52411800, 0.14760023731816116), (83, 31157512, 0.08774467134201562), (79, 23338368, 0.06572467756151436), (78, 20871298, 0.05877700323091484), (36, 16534105, 0.046562755368893934)], pred dist top -> [(82, 55932316, 0.15751460103129014), (83, 34263480, 0.09649159498676202), (79, 25531210, 0.07190008647230135), (78, 20603992, 0.058024230205877644), (36, 19498512, 0.0549110167078335)], fg_fraction=0.472
2025-11-09 09:10:53 [rank 0] epoch 4 parameter stats -> seg_rms=2.2366e-02 (Δ1.45e-05), domain_rms=9.9333e-02 (Δ-2.69e-04), texproj_rms=6.3421e-02 (Δ4.56e-04), statsproj_rms=1.2903e-01 (Δ9.09e-04), encoder_rms=3.2947e-02 (Δ3.86e-04)
2025-11-09 09:10:53 [rank 0] checking should_stop
2025-11-09 09:10:53 [rank 0] should_stop -> False
2025-11-09 09:10:53 [rank 0] before can_run_validation decision
2025-11-09 09:10:53 [rank 0] after can_run_validation -> True
2025-11-09 09:10:53 [rank 0] starting validation on main rank
2025-11-09 09:10:54 [rank 0] val-step 001: loss=0.5369, fg_frac=0.780, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.755±0.211, pred_entropy=0.916, prob_range=[0.000,1.000], fg_match=0.831, top_preds=[(83, 148362), (82, 120850), (78, 48738), (79, 48444), (36, 35197)], batch_label_top=[(82, 81983.0), (78, 50461.0), (79, 48532.0), (83, 45983.0), (36, 37134.0)], batch_pred_top=[(82, 92011.0), (83, 50969.0), (78, 48738.0), (79, 48425.0), (36, 35196.0)]
2025-11-09 09:10:54 [rank 0] val-step 002: loss=0.5328, fg_frac=0.752, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.765±0.214, pred_entropy=0.876, prob_range=[0.000,1.000], fg_match=0.822, top_preds=[(83, 170113), (82, 121597), (79, 58121), (78, 48271), (36, 33252)], batch_label_top=[(82, 81668.0), (83, 55922.0), (79, 48795.0), (78, 46165.0), (36, 40828.0)], batch_pred_top=[(82, 90909.0), (83, 58938.0), (79, 57097.0), (78, 48026.0), (36, 32996.0)]
2025-11-09 09:10:55 [rank 0] finished validation on main rank
2025-11-09 09:10:55 [rank 0] epoch 4 val summary -> loss=0.7460, dice=0.0312, duration=2.74s
2025-11-09 09:10:55 [rank 0] epoch 4 val label dist top -> [(82, 1584556, 0.14381113912911525), (83, 1574683, 0.14291508535971753), (78, 733782, 0.06659658938683166), (79, 730461, 0.06629518205692488), (36, 469411, 0.04260280522098122)], pred dist top -> [(82, 1718699, 0.1559856900040587), (83, 1492995, 0.1355012455628412), (79, 783895, 0.07114474522050201), (78, 757639, 0.06876180307836627), (36, 454515, 0.04125087399957453)], dice top -> [(83, 0.9038), (18, 0.8762), (82, 0.8449), (16, 0.7884), (17, 0.7622)]
2025-11-09 09:10:55 [rank 0] scheduler stepped
2025-11-09 09:10:55 [rank 0] epoch 4 lr=4.995067e-05, remaining=103.17 min (avg train=1.97, avg val=0.06)
2025-11-09 09:10:55 [rank 0] metrics logged and best model check complete
2025-11-09 09:10:55 [rank 0] epoch loop completed
2025-11-09 09:10:55 [rank 0] before can_start_epoch decision
2025-11-09 09:10:55 [rank 0] after can_start_epoch decision -> True
2025-11-09 09:10:55 [rank 0] starting train_epoch
2025-11-09 09:11:18 [rank 0] step 0050: total=1.2142, seg=1.0784, domain=0.4851, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.205, label_range=[-1,83], unique_labels=[-1, 9, 20, 30, 31, 32, 33, 34, 35, 36, 37, 38]..., domain_counts=d0=2, grad_norm=3.900e+00, seg_grad=3.784e+00, tex_grad=1.302e-01, stats_grad=2.826e-02, enc_grad=3.306e-03, dom_grad=9.353e-01, pred_conf=0.498±0.291, pred_entropy=1.968, prob_range=[0.000,1.000], fg_match=0.647, top_preds=[(82, 426793), (83, 332234), (22, 255410), (84, 145259), (35, 82934)], dom_logits={'mean': -0.19999313354492188, 'std': 0.24009816348552704, 'max': 0.08172607421875, 'min': -0.473388671875, 'margin': 0.2318463921546936}
2025-11-09 09:11:28 [rank 0] step 0100: total=0.9573, seg=0.8135, domain=0.5137, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.681, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=2, grad_norm=2.494e+00, seg_grad=2.355e+00, tex_grad=1.377e-01, stats_grad=2.022e-02, enc_grad=4.043e-03, dom_grad=8.081e-01, pred_conf=0.758±0.244, pred_entropy=0.918, prob_range=[0.000,1.000], fg_match=0.798, top_preds=[(83, 302994), (82, 284461), (79, 128762), (78, 119631), (36, 77587)], dom_logits={'mean': 0.040985107421875, 'std': 0.2059488594532013, 'max': 0.283203125, 'min': -0.2115478515625, 'margin': 0.19740931689739227}
2025-11-09 09:11:38 [rank 0] step 0150: total=1.3541, seg=1.1647, domain=0.6765, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.501, label_range=[-1,86], unique_labels=[-1, 0, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17]..., domain_counts=d0=2, grad_norm=6.890e+00, seg_grad=6.831e+00, tex_grad=1.698e-01, stats_grad=3.050e-02, enc_grad=4.735e-03, dom_grad=8.769e-01, pred_conf=0.687±0.240, pred_entropy=1.088, prob_range=[0.000,1.000], fg_match=0.663, top_preds=[(83, 355149), (82, 274956), (84, 148111), (46, 140021), (79, 74333)], dom_logits={'mean': 0.0761871337890625, 'std': 0.017126282677054405, 'max': 0.09478759765625, 'min': 0.05621337890625, 'margin': 0.016950905323028564}
2025-11-09 09:11:48 [rank 0] step 0200: total=0.8517, seg=0.6300, domain=0.7917, align=0.0000, stats_align=0.0000, dom_acc=0.000, fg_frac=0.701, label_range=[-1,85], unique_labels=[-1, 1, 3, 5, 7, 9, 11, 13, 15, 17, 18, 19]..., domain_counts=d0=2, grad_norm=1.651e+00, seg_grad=1.387e+00, tex_grad=1.782e-01, stats_grad=4.821e-02, enc_grad=5.892e-03, dom_grad=8.771e-01, pred_conf=0.745±0.236, pred_entropy=0.939, prob_range=[0.000,1.000], fg_match=0.876, top_preds=[(82, 262809), (83, 245368), (78, 155218), (35, 124661), (84, 109419)], dom_logits={'mean': 0.09410858154296875, 'std': 0.09943920373916626, 'max': 0.21630859375, 'min': -0.03564453125, 'margin': 0.09384554624557495}
2025-11-09 09:11:58 [rank 0] step 0250: total=0.9707, seg=0.7349, domain=0.8423, align=0.0000, stats_align=0.0000, dom_acc=0.000, fg_frac=0.362, label_range=[-1,84], unique_labels=[-1, 1, 3, 5, 7, 9, 11, 13, 15, 17, 18, 20]..., domain_counts=d0=2, grad_norm=2.870e+00, seg_grad=2.678e+00, tex_grad=1.628e-01, stats_grad=3.565e-02, enc_grad=4.893e-03, dom_grad=1.020e+00, pred_conf=0.574±0.267, pred_entropy=1.582, prob_range=[0.000,1.000], fg_match=0.903, top_preds=[(83, 369680), (82, 315659), (79, 169725), (46, 136404), (36, 120246)], dom_logits={'mean': 0.08387374877929688, 'std': 0.14407603442668915, 'max': 0.25830078125, 'min': -0.09228515625, 'margin': 0.1386764794588089}
2025-11-09 09:12:07 [rank 0] step 0300: total=1.0150, seg=0.7768, domain=0.8508, align=0.0000, stats_align=0.0000, dom_acc=0.000, fg_frac=0.574, label_range=[-1,86], unique_labels=[-1, 0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20]..., domain_counts=d0=2, grad_norm=3.341e+00, seg_grad=3.156e+00, tex_grad=2.208e-01, stats_grad=4.198e-02, enc_grad=5.999e-03, dom_grad=1.073e+00, pred_conf=0.668±0.269, pred_entropy=1.206, prob_range=[0.000,1.000], fg_match=0.701, top_preds=[(83, 333252), (82, 331609), (78, 183830), (35, 134054), (84, 124853)], dom_logits={'mean': 0.09929656982421875, 'std': 0.15227286517620087, 'max': 0.27490234375, 'min': -0.1002197265625, 'margin': 0.14473021030426025}
2025-11-09 09:12:18 [rank 0] step 0350: total=1.4793, seg=1.2429, domain=0.8445, align=0.0000, stats_align=0.0000, dom_acc=0.000, fg_frac=0.525, label_range=[-1,86], unique_labels=[-1, 2, 3, 5, 6, 8, 9, 10, 11, 12, 13, 14]..., domain_counts=d0=2, grad_norm=4.181e+00, seg_grad=3.946e+00, tex_grad=1.725e-01, stats_grad=5.123e-02, enc_grad=4.514e-03, dom_grad=1.372e+00, pred_conf=0.686±0.257, pred_entropy=1.212, prob_range=[0.000,1.000], fg_match=0.722, top_preds=[(82, 370298), (83, 242861), (38, 132535), (81, 131043), (84, 129667)], dom_logits={'mean': 0.20702362060546875, 'std': 0.15547028183937073, 'max': 0.44091796875, 'min': 0.050384521484375, 'margin': 0.13881997764110565}
2025-11-09 09:12:27 [rank 0] step 0400: total=0.8152, seg=0.6335, domain=0.6489, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.541, label_range=[-1,86], unique_labels=[-1, 0, 2, 4, 5, 6, 7, 8, 10, 12, 14, 16]..., domain_counts=d0=2, grad_norm=2.396e+00, seg_grad=2.135e+00, tex_grad=1.387e-01, stats_grad=1.941e-02, enc_grad=3.412e-03, dom_grad=1.079e+00, pred_conf=0.746±0.239, pred_entropy=0.967, prob_range=[0.000,1.000], fg_match=0.877, top_preds=[(83, 391673), (82, 347631), (79, 145469), (84, 106405), (81, 68382)], dom_logits={'mean': 0.12625503540039062, 'std': 0.09547839313745499, 'max': 0.2724609375, 'min': 0.0178375244140625, 'margin': 0.04551120102405548}
2025-11-09 09:12:32 [rank 0] finished train_epoch
2025-11-09 09:12:32 [rank 0] epoch 5 train summary -> total=1.1208, seg=0.9169, domain=0.7279, align=0.0006, stats=0.0010, dom_acc=0.445, batches=426
2025-11-09 09:12:32 [rank 0] epoch 5 train label dist top -> [(82, 53249836, 0.14499207616544077), (83, 31642046, 0.0861569966837528), (79, 23814856, 0.06484462064861579), (78, 22137364, 0.06027703760796722), (36, 16655221, 0.045349906275471884)], pred dist top -> [(82, 56631228, 0.1541991690595814), (83, 34894580, 0.09501321851405178), (79, 25839094, 0.07035635575573984), (78, 21721688, 0.05914521649029896), (36, 19200752, 0.052281048959755834)], fg_fraction=0.488
2025-11-09 09:12:32 [rank 0] epoch 5 parameter stats -> seg_rms=2.2387e-02 (Δ2.04e-05), domain_rms=9.9046e-02 (Δ-2.87e-04), texproj_rms=6.3710e-02 (Δ2.90e-04), statsproj_rms=1.2976e-01 (Δ7.36e-04), encoder_rms=3.2983e-02 (Δ3.58e-05)
2025-11-09 09:12:32 [rank 0] checking should_stop
2025-11-09 09:12:32 [rank 0] should_stop -> False
2025-11-09 09:12:32 [rank 0] before can_run_validation decision
2025-11-09 09:12:32 [rank 0] after can_run_validation -> True
2025-11-09 09:12:32 [rank 0] starting validation on main rank
2025-11-09 09:12:34 [rank 0] val-step 001: loss=0.6554, fg_frac=0.780, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.669±0.221, pred_entropy=1.173, prob_range=[0.000,1.000], fg_match=0.803, top_preds=[(83, 144873), (82, 134815), (78, 50831), (79, 47829), (36, 40503)], batch_label_top=[(82, 81983.0), (78, 50461.0), (79, 48532.0), (83, 45983.0), (36, 37134.0)], batch_pred_top=[(82, 95679.0), (78, 50763.0), (83, 49087.0), (79, 47760.0), (36, 40399.0)]
2025-11-09 09:12:34 [rank 0] val-step 002: loss=0.7167, fg_frac=0.752, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.653±0.226, pred_entropy=1.182, prob_range=[0.000,1.000], fg_match=0.721, top_preds=[(83, 166919), (82, 128103), (78, 67609), (79, 46357), (35, 44741)], batch_label_top=[(82, 81668.0), (83, 55922.0), (79, 48795.0), (78, 46165.0), (36, 40828.0)], batch_pred_top=[(82, 94759.0), (78, 67603.0), (83, 59091.0), (79, 46148.0), (35, 44670.0)]
2025-11-09 09:12:35 [rank 0] finished validation on main rank
2025-11-09 09:12:35 [rank 0] epoch 5 val summary -> loss=0.9119, dice=0.0219, duration=2.73s
2025-11-09 09:12:35 [rank 0] epoch 5 val label dist top -> [(82, 1584556, 0.14381113912911525), (83, 1574683, 0.14291508535971753), (78, 733782, 0.06659658938683166), (79, 730461, 0.06629518205692488), (36, 469411, 0.04260280522098122)], pred dist top -> [(82, 1757326, 0.15949139940854823), (83, 1487898, 0.1350386520185669), (78, 1131304, 0.10267489248806895), (35, 616684, 0.05596900868299972), (79, 522159, 0.047390108394098844)], dice top -> [(83, 0.9078), (18, 0.8598), (82, 0.8515), (47, 0.6989), (84, 0.6838)]
2025-11-09 09:12:35 [rank 0] scheduler stepped
2025-11-09 09:12:35 [rank 0] epoch 5 lr=4.992293e-05, remaining=101.51 min (avg train=1.96, avg val=0.05)
2025-11-09 09:12:35 [rank 0] metrics logged and best model check complete
2025-11-09 09:12:35 [rank 0] epoch loop completed
2025-11-09 09:12:35 [rank 0] before can_start_epoch decision
2025-11-09 09:12:35 [rank 0] after can_start_epoch decision -> True
2025-11-09 09:12:35 [rank 0] starting train_epoch
2025-11-09 09:12:57 [rank 0] step 0050: total=1.2126, seg=0.9913, domain=0.6321, align=0.0002, stats_align=0.0005, dom_acc=0.500, fg_frac=0.454, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=1, d1=1, grad_norm=3.710e+00, seg_grad=3.678e+00, tex_grad=1.116e-01, stats_grad=1.635e-02, enc_grad=2.356e-03, dom_grad=4.763e-01, pred_conf=0.619±0.262, pred_entropy=1.382, prob_range=[0.000,1.000], fg_match=0.614, top_preds=[(83, 384307), (82, 302884), (84, 105762), (46, 101044), (79, 95080)], dom_logits={'mean': -0.0200347900390625, 'std': 0.18858957290649414, 'max': 0.261962890625, 'min': -0.2298583984375, 'margin': 0.16529135406017303}
2025-11-09 09:13:07 [rank 0] step 0100: total=1.2034, seg=0.9958, domain=0.5933, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.730, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=2, grad_norm=1.445e+01, seg_grad=1.440e+01, tex_grad=2.309e-01, stats_grad=4.230e-02, enc_grad=4.999e-03, dom_grad=1.203e+00, pred_conf=0.727±0.240, pred_entropy=1.028, prob_range=[0.000,1.000], fg_match=0.728, top_preds=[(83, 337994), (82, 301104), (79, 160957), (78, 128938), (36, 103929)], dom_logits={'mean': -0.13146305084228516, 'std': 0.12711159884929657, 'max': -0.007572174072265625, 'min': -0.334716796875, 'margin': 0.10576625168323517}
2025-11-09 09:13:17 [rank 0] step 0150: total=1.1100, seg=0.9393, domain=0.4878, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.145, label_range=[-1,84], unique_labels=[-1, 10, 16, 17, 18, 20, 30, 31, 32, 33, 34, 35]..., domain_counts=d0=2, grad_norm=8.317e+00, seg_grad=8.234e+00, tex_grad=2.172e-01, stats_grad=3.330e-02, enc_grad=5.170e-03, dom_grad=1.153e+00, pred_conf=0.516±0.272, pred_entropy=1.832, prob_range=[0.000,1.000], fg_match=0.512, top_preds=[(82, 419506), (83, 352439), (84, 201933), (35, 140476), (78, 122025)], dom_logits={'mean': 0.0308837890625, 'std': 0.2513355314731598, 'max': 0.387939453125, 'min': -0.251708984375, 'margin': 0.22842992842197418}
2025-11-09 09:13:27 [rank 0] step 0200: total=1.3893, seg=1.2065, domain=0.5222, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.583, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=2, grad_norm=2.575e+00, seg_grad=2.287e+00, tex_grad=2.144e-01, stats_grad=5.482e-02, enc_grad=5.998e-03, dom_grad=1.163e+00, pred_conf=0.679±0.258, pred_entropy=1.237, prob_range=[0.000,1.000], fg_match=0.714, top_preds=[(82, 341498), (83, 285452), (84, 135268), (79, 113180), (16, 84551)], dom_logits={'mean': -0.080322265625, 'std': 0.19392473995685577, 'max': 0.164794921875, 'min': -0.29736328125, 'margin': 0.1864762306213379}
2025-11-09 09:13:37 [rank 0] step 0250: total=1.1726, seg=0.9716, domain=0.5742, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.738, label_range=[-1,86], unique_labels=[-1, 7, 9, 11, 19, 20, 21, 22, 23, 24, 25, 26]..., domain_counts=d0=2, grad_norm=1.912e+00, seg_grad=1.495e+00, tex_grad=2.772e-01, stats_grad=8.535e-02, enc_grad=8.621e-03, dom_grad=1.156e+00, pred_conf=0.759±0.202, pred_entropy=0.870, prob_range=[0.000,1.000], fg_match=0.793, top_preds=[(82, 217947), (80, 207804), (83, 194229), (37, 187010), (84, 101451)], dom_logits={'mean': -0.07469558715820312, 'std': 0.15241114795207977, 'max': 0.121826171875, 'min': -0.294921875, 'margin': 0.128937229514122}
2025-11-09 09:13:47 [rank 0] step 0300: total=1.3110, seg=1.0547, domain=0.7324, align=0.0000, stats_align=0.0000, dom_acc=0.000, fg_frac=0.704, label_range=[-1,86], unique_labels=[-1, 0, 2, 4, 6, 8, 10, 11, 12, 14, 16, 18]..., domain_counts=d0=2, grad_norm=1.990e+01, seg_grad=1.986e+01, tex_grad=3.075e-01, stats_grad=1.269e-01, enc_grad=1.303e-02, dom_grad=1.094e+00, pred_conf=0.711±0.233, pred_entropy=1.034, prob_range=[0.000,1.000], fg_match=0.496, top_preds=[(82, 316595), (83, 227945), (79, 146732), (35, 133666), (81, 99706)], dom_logits={'mean': -0.152740478515625, 'std': 0.052127622067928314, 'max': -0.0992431640625, 'min': -0.2386474609375, 'margin': 0.03839266300201416}
2025-11-09 09:13:57 [rank 0] step 0350: total=0.9066, seg=0.6648, domain=0.6907, align=0.0000, stats_align=0.0000, dom_acc=0.500, fg_frac=0.532, label_range=[-1,86], unique_labels=[-1, 4, 6, 8, 9, 10, 12, 18, 20, 23, 24, 28]..., domain_counts=d0=2, grad_norm=2.040e+00, seg_grad=1.685e+00, tex_grad=2.812e-01, stats_grad=1.044e-01, enc_grad=9.326e-03, dom_grad=1.111e+00, pred_conf=0.671±0.277, pred_entropy=1.297, prob_range=[0.000,1.000], fg_match=0.823, top_preds=[(82, 326159), (83, 298350), (79, 204971), (36, 145960), (84, 108108)], dom_logits={'mean': -0.16717529296875, 'std': 0.023649606853723526, 'max': -0.1314697265625, 'min': -0.197998046875, 'margin': 0.016844019293785095}
2025-11-09 09:14:07 [rank 0] step 0400: total=0.8712, seg=0.6426, domain=0.6531, align=0.0000, stats_align=0.0000, dom_acc=0.500, fg_frac=0.338, label_range=[-1,84], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 7, 8, 9, 13, 14]..., domain_counts=d0=2, grad_norm=2.566e+00, seg_grad=2.288e+00, tex_grad=2.003e-01, stats_grad=3.850e-02, enc_grad=6.162e-03, dom_grad=1.143e+00, pred_conf=0.681±0.279, pred_entropy=1.229, prob_range=[0.000,1.000], fg_match=0.913, top_preds=[(83, 422933), (82, 325666), (84, 175765), (46, 131830), (17, 117508)], dom_logits={'mean': -0.08798980712890625, 'std': 0.06980670988559723, 'max': 0.009307861328125, 'min': -0.1864013671875, 'margin': 0.05528688430786133}
2025-11-09 09:14:12 [rank 0] finished train_epoch
2025-11-09 09:14:12 [rank 0] epoch 6 train summary -> total=1.1454, seg=0.8997, domain=0.7016, align=0.0006, stats=0.0011, dom_acc=0.550, batches=426
2025-11-09 09:14:12 [rank 0] epoch 6 train label dist top -> [(82, 53096868, 0.1523554351729326), (83, 31763784, 0.09114257236526707), (79, 22146062, 0.06354561088945483), (78, 21832436, 0.06264569668525834), (36, 15996535, 0.04590024125686749)], pred dist top -> [(82, 56185464, 0.1612177881105008), (83, 34976896, 0.10036221838607622), (79, 24254692, 0.06959607551770791), (78, 21705780, 0.0622822629143571), (36, 18330624, 0.052597637281508625)], fg_fraction=0.463
2025-11-09 09:14:12 [rank 0] epoch 6 parameter stats -> seg_rms=2.2409e-02 (Δ2.25e-05), domain_rms=9.8818e-02 (Δ-2.27e-04), texproj_rms=6.3920e-02 (Δ2.09e-04), statsproj_rms=1.3040e-01 (Δ6.41e-04), encoder_rms=3.2980e-02 (Δ-2.64e-06)
2025-11-09 09:14:12 [rank 0] checking should_stop
2025-11-09 09:14:12 [rank 0] should_stop -> False
2025-11-09 09:14:12 [rank 0] before can_run_validation decision
2025-11-09 09:14:12 [rank 0] after can_run_validation -> True
2025-11-09 09:14:12 [rank 0] starting validation on main rank
2025-11-09 09:14:14 [rank 0] val-step 001: loss=0.5267, fg_frac=0.780, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.732±0.208, pred_entropy=0.973, prob_range=[0.000,1.000], fg_match=0.832, top_preds=[(83, 157577), (82, 119360), (78, 48582), (79, 45981), (36, 37985)], batch_label_top=[(82, 81983.0), (78, 50461.0), (79, 48532.0), (83, 45983.0), (36, 37134.0)], batch_pred_top=[(82, 87284.0), (83, 51382.0), (78, 46744.0), (79, 45959.0), (36, 37983.0)]
2025-11-09 09:14:14 [rank 0] val-step 002: loss=0.5167, fg_frac=0.752, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.723±0.213, pred_entropy=0.989, prob_range=[0.000,1.000], fg_match=0.836, top_preds=[(83, 168065), (82, 129321), (79, 55278), (78, 45186), (36, 35192)], batch_label_top=[(82, 81668.0), (83, 55922.0), (79, 48795.0), (78, 46165.0), (36, 40828.0)], batch_pred_top=[(82, 84483.0), (83, 59175.0), (79, 55196.0), (78, 43942.0), (36, 35125.0)]
2025-11-09 09:14:15 [rank 0] finished validation on main rank
2025-11-09 09:14:15 [rank 0] epoch 6 val summary -> loss=0.7225, dice=0.0319, duration=2.72s
2025-11-09 09:14:15 [rank 0] epoch 6 val label dist top -> [(82, 1584556, 0.14381113912911525), (83, 1574683, 0.14291508535971753), (78, 733782, 0.06659658938683166), (79, 730461, 0.06629518205692488), (36, 469411, 0.04260280522098122)], pred dist top -> [(82, 1655496, 0.15024951190345673), (83, 1492679, 0.13547256603370825), (79, 855125, 0.07760943781588323), (78, 622062, 0.05645710522628149), (36, 513949, 0.04664498518466349)], dice top -> [(83, 0.9108), (18, 0.8615), (82, 0.8538), (16, 0.7776), (17, 0.7632)]
2025-11-09 09:14:15 [rank 0] scheduler stepped
2025-11-09 09:14:15 [rank 0] epoch 6 lr=4.988905e-05, remaining=99.85 min (avg train=1.96, avg val=0.05)
2025-11-09 09:14:16 [rank 0] metrics logged and best model check complete
2025-11-09 09:14:16 [rank 0] epoch loop completed
2025-11-09 09:14:16 [rank 0] before can_start_epoch decision
2025-11-09 09:14:16 [rank 0] after can_start_epoch decision -> True
2025-11-09 09:14:16 [rank 0] starting train_epoch
2025-11-09 09:14:38 [rank 0] step 0050: total=0.9992, seg=0.6915, domain=0.7319, align=0.0014, stats_align=0.0012, dom_acc=0.500, fg_frac=0.600, label_range=[-1,85], unique_labels=[-1, 1, 3, 5, 7, 9, 11, 13, 15, 17, 18, 19]..., domain_counts=d0=1, d1=1, grad_norm=2.359e+00, seg_grad=2.221e+00, tex_grad=1.993e-01, stats_grad=5.046e-02, enc_grad=6.739e-03, dom_grad=7.692e-01, pred_conf=0.677±0.274, pred_entropy=1.219, prob_range=[0.000,1.000], fg_match=0.759, top_preds=[(83, 331825), (82, 300271), (78, 132836), (84, 109021), (35, 78819)], dom_logits={'mean': -0.1118927001953125, 'std': 0.16238775849342346, 'max': 0.05072021484375, 'min': -0.326904296875, 'margin': 0.15570537745952606}
2025-11-09 09:14:48 [rank 0] step 0100: total=0.8376, seg=0.6057, domain=0.5522, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.452, label_range=[-1,85], unique_labels=[-1, 1, 3, 5, 7, 9, 11, 13, 15, 16, 17, 18]..., domain_counts=d0=2, grad_norm=1.720e+00, seg_grad=1.220e+00, tex_grad=2.655e-01, stats_grad=4.466e-02, enc_grad=5.260e-03, dom_grad=1.182e+00, pred_conf=0.684±0.262, pred_entropy=1.232, prob_range=[0.000,1.000], fg_match=0.897, top_preds=[(83, 403983), (82, 293531), (84, 133900), (46, 118641), (79, 102356)], dom_logits={'mean': -0.0093841552734375, 'std': 0.16541501879692078, 'max': 0.21923828125, 'min': -0.2103271484375, 'margin': 0.15149059891700745}
2025-11-09 09:14:58 [rank 0] step 0150: total=0.8288, seg=0.6177, domain=0.5027, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.737, label_range=[-1,86], unique_labels=[-1, 6, 10, 20, 30, 31, 32, 33, 34, 35, 36, 38]..., domain_counts=d0=2, grad_norm=1.728e+00, seg_grad=1.245e+00, tex_grad=2.372e-01, stats_grad=3.919e-02, enc_grad=4.697e-03, dom_grad=1.174e+00, pred_conf=0.775±0.195, pred_entropy=0.844, prob_range=[0.000,1.000], fg_match=0.922, top_preds=[(79, 342156), (82, 310599), (83, 289729), (36, 263617), (84, 73789)], dom_logits={'mean': -0.051055908203125, 'std': 0.2170022577047348, 'max': 0.21728515625, 'min': -0.275390625, 'margin': 0.21007199585437775}
2025-11-09 09:15:08 [rank 0] step 0200: total=1.2588, seg=0.9692, domain=0.6880, align=0.0018, stats_align=0.0039, dom_acc=0.500, fg_frac=0.634, label_range=[-1,84], unique_labels=[-1, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]..., domain_counts=d0=1, d1=1, grad_norm=2.428e+00, seg_grad=2.268e+00, tex_grad=2.280e-01, stats_grad=2.925e-02, enc_grad=3.882e-03, dom_grad=8.350e-01, pred_conf=0.669±0.242, pred_entropy=1.265, prob_range=[0.000,1.000], fg_match=0.714, top_preds=[(83, 370051), (82, 318640), (80, 88123), (78, 81810), (21, 79953)], dom_logits={'mean': -0.049285888671875, 'std': 0.19460457563400269, 'max': 0.14453125, 'min': -0.29052734375, 'margin': 0.18897061049938202}
2025-11-09 09:15:18 [rank 0] step 0250: total=0.7505, seg=0.5654, domain=0.4407, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.897, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11]..., domain_counts=d0=2, grad_norm=1.720e+00, seg_grad=1.284e+00, tex_grad=2.384e-01, stats_grad=6.415e-02, enc_grad=8.702e-03, dom_grad=1.118e+00, pred_conf=0.863±0.168, pred_entropy=0.498, prob_range=[0.000,1.000], fg_match=0.867, top_preds=[(82, 177609), (78, 162392), (83, 145826), (79, 135500), (80, 103443)], dom_logits={'mean': 0.121002197265625, 'std': 0.30172574520111084, 'max': 0.425048828125, 'min': -0.255126953125, 'margin': 0.28763172030448914}
2025-11-09 09:15:28 [rank 0] step 0300: total=1.9713, seg=1.6478, domain=0.7671, align=0.0019, stats_align=0.0088, dom_acc=0.500, fg_frac=0.514, label_range=[-1,86], unique_labels=[-1, 1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]..., domain_counts=d0=1, d1=1, grad_norm=4.226e+00, seg_grad=4.108e+00, tex_grad=2.332e-01, stats_grad=2.691e-02, enc_grad=3.946e-03, dom_grad=9.631e-01, pred_conf=0.657±0.266, pred_entropy=1.307, prob_range=[0.000,1.000], fg_match=0.474, top_preds=[(83, 335557), (82, 284467), (84, 199579), (46, 140163), (37, 70908)], dom_logits={'mean': -0.1047515869140625, 'std': 0.3108501732349396, 'max': 0.267822265625, 'min': -0.54541015625, 'margin': 0.27567046880722046}
2025-11-09 09:15:38 [rank 0] step 0350: total=1.4267, seg=0.9497, domain=1.1357, align=0.0000, stats_align=0.0000, dom_acc=0.000, fg_frac=0.344, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 8, 9, 10, 11]..., domain_counts=d0=0, d1=2, grad_norm=5.210e+00, seg_grad=4.559e+00, tex_grad=5.561e-01, stats_grad=7.845e-02, enc_grad=1.448e-02, dom_grad=2.459e+00, pred_conf=0.540±0.271, pred_entropy=1.804, prob_range=[0.000,1.000], fg_match=0.703, top_preds=[(83, 521551), (82, 401647), (84, 171643), (79, 86854), (78, 82740)], dom_logits={'mean': -0.07830810546875, 'std': 0.3790135681629181, 'max': 0.341552734375, 'min': -0.525390625, 'margin': 0.35750138759613037}
2025-11-09 09:15:48 [rank 0] step 0400: total=1.2571, seg=0.9398, domain=0.7549, align=0.0004, stats_align=0.0016, dom_acc=0.500, fg_frac=0.242, label_range=[-1,85], unique_labels=[-1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13]..., domain_counts=d0=1, d1=1, grad_norm=2.641e+00, seg_grad=2.534e+00, tex_grad=2.163e-01, stats_grad=3.620e-02, enc_grad=4.580e-03, dom_grad=7.102e-01, pred_conf=0.558±0.267, pred_entropy=1.677, prob_range=[0.000,1.000], fg_match=0.631, top_preds=[(83, 523861), (82, 363320), (78, 182230), (84, 175696), (79, 94101)], dom_logits={'mean': -0.10408782958984375, 'std': 0.17707695066928864, 'max': 0.11328125, 'min': -0.321044921875, 'margin': 0.16894003748893738}
2025-11-09 09:15:53 [rank 0] finished train_epoch
2025-11-09 09:15:53 [rank 0] epoch 7 train summary -> total=1.1551, seg=0.8843, domain=0.6443, align=0.0004, stats=0.0009, dom_acc=0.714, batches=426
2025-11-09 09:15:53 [rank 0] epoch 7 train label dist top -> [(82, 53346308, 0.14759897004259276), (83, 32074252, 0.08874328397921316), (78, 22838524, 0.06318980162025525), (79, 22021116, 0.06092819095912805), (35, 16627983, 0.046006429623690955)], pred dist top -> [(82, 56521316, 0.1563835959010047), (83, 35212620, 0.097426537922359), (78, 23439348, 0.06485216171921798), (79, 22674892, 0.06273705919421488), (36, 17055764, 0.04719001420913313)], fg_fraction=0.480
2025-11-09 09:15:53 [rank 0] epoch 7 parameter stats -> seg_rms=2.2427e-02 (Δ1.82e-05), domain_rms=9.8803e-02 (Δ-1.50e-05), texproj_rms=6.4219e-02 (Δ2.99e-04), statsproj_rms=1.3064e-01 (Δ2.34e-04), encoder_rms=3.3237e-02 (Δ2.57e-04)
2025-11-09 09:15:53 [rank 0] checking should_stop
2025-11-09 09:15:53 [rank 0] should_stop -> False
2025-11-09 09:15:53 [rank 0] before can_run_validation decision
2025-11-09 09:15:53 [rank 0] after can_run_validation -> True
2025-11-09 09:15:53 [rank 0] starting validation on main rank
2025-11-09 09:15:54 [rank 0] val-step 001: loss=0.6103, fg_frac=0.780, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.679±0.210, pred_entropy=1.073, prob_range=[0.000,1.000], fg_match=0.811, top_preds=[(83, 147879), (82, 116955), (78, 46972), (79, 46705), (84, 38871)], batch_label_top=[(82, 81983.0), (78, 50461.0), (79, 48532.0), (83, 45983.0), (36, 37134.0)], batch_pred_top=[(82, 94416.0), (83, 49929.0), (78, 46659.0), (79, 46634.0), (36, 33690.0)]
2025-11-09 09:15:55 [rank 0] val-step 002: loss=0.6119, fg_frac=0.752, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.677±0.216, pred_entropy=1.079, prob_range=[0.000,1.000], fg_match=0.789, top_preds=[(83, 154373), (82, 119596), (78, 52269), (79, 49132), (84, 42437)], batch_label_top=[(82, 81668.0), (83, 55922.0), (79, 48795.0), (78, 46165.0), (36, 40828.0)], batch_pred_top=[(82, 90609.0), (83, 59430.0), (78, 51758.0), (79, 49073.0), (35, 38444.0)]
2025-11-09 09:15:55 [rank 0] finished validation on main rank
2025-11-09 09:15:55 [rank 0] epoch 7 val summary -> loss=0.7238, dice=0.0323, duration=2.73s
2025-11-09 09:15:55 [rank 0] epoch 7 val label dist top -> [(82, 1584556, 0.14381113912911525), (83, 1574683, 0.14291508535971753), (78, 733782, 0.06659658938683166), (79, 730461, 0.06629518205692488), (36, 469411, 0.04260280522098122)], pred dist top -> [(82, 1733454, 0.15732482434695985), (83, 1479289, 0.134257316365701), (78, 833868, 0.07568019493367042), (79, 644072, 0.05845468888519403), (35, 512102, 0.04647735515204144)], dice top -> [(83, 0.9106), (18, 0.8834), (82, 0.8588), (16, 0.7808), (42, 0.7703)]
2025-11-09 09:15:55 [rank 0] scheduler stepped
2025-11-09 09:15:55 [rank 0] epoch 7 lr=4.984902e-05, remaining=98.17 min (avg train=1.95, avg val=0.05)
2025-11-09 09:15:57 [rank 0] metrics logged and best model check complete
2025-11-09 09:15:57 [rank 0] epoch loop completed
2025-11-09 09:15:57 [rank 0] before can_start_epoch decision
2025-11-09 09:15:57 [rank 0] after can_start_epoch decision -> True
2025-11-09 09:15:57 [rank 0] starting train_epoch
2025-11-09 09:16:20 [rank 0] step 0050: total=1.3612, seg=0.8468, domain=1.0498, align=0.0000, stats_align=0.0000, dom_acc=0.000, fg_frac=0.180, label_range=[-1,83], unique_labels=[-1, 16, 17, 21, 22, 23, 24, 25, 27, 29, 31, 32]..., domain_counts=d0=0, d1=2, grad_norm=4.040e+00, seg_grad=3.032e+00, tex_grad=7.106e-01, stats_grad=1.297e-01, enc_grad=1.863e-02, dom_grad=2.572e+00, pred_conf=0.526±0.261, pred_entropy=1.793, prob_range=[0.000,1.000], fg_match=0.740, top_preds=[(83, 499561), (82, 327555), (84, 194016), (79, 118416), (35, 98561)], dom_logits={'mean': -0.1623992919921875, 'std': 0.314354807138443, 'max': 0.17822265625, 'min': -0.55126953125, 'margin': 0.2980276942253113}
2025-11-09 09:16:30 [rank 0] step 0100: total=1.2625, seg=0.9403, domain=0.6565, align=0.0015, stats_align=0.0022, dom_acc=0.500, fg_frac=0.389, label_range=[-1,85], unique_labels=[-1, 1, 3, 5, 7, 9, 11, 13, 15, 17, 18, 19]..., domain_counts=d0=1, d1=1, grad_norm=4.668e+00, seg_grad=4.577e+00, tex_grad=2.991e-01, stats_grad=5.391e-02, enc_grad=6.615e-03, dom_grad=8.648e-01, pred_conf=0.601±0.269, pred_entropy=1.470, prob_range=[0.000,1.000], fg_match=0.556, top_preds=[(83, 437548), (82, 322511), (84, 156599), (79, 150785), (36, 94371)], dom_logits={'mean': -0.05137014389038086, 'std': 0.22184595465660095, 'max': 0.2900390625, 'min': -0.278564453125, 'margin': 0.19175516068935394}
2025-11-09 09:16:40 [rank 0] step 0150: total=1.7498, seg=1.4990, domain=0.5117, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.538, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=2, grad_norm=3.156e+00, seg_grad=2.762e+00, tex_grad=4.557e-01, stats_grad=1.229e-01, enc_grad=1.476e-02, dom_grad=1.451e+00, pred_conf=0.709±0.293, pred_entropy=1.156, prob_range=[0.000,1.000], fg_match=0.699, top_preds=[(83, 288239), (82, 204096), (78, 122319), (84, 105653), (81, 92265)], dom_logits={'mean': -0.0406341552734375, 'std': 0.21111942827701569, 'max': 0.216064453125, 'min': -0.303466796875, 'margin': 0.20007452368736267}
2025-11-09 09:16:50 [rank 0] step 0200: total=2.1813, seg=1.8830, domain=0.6086, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.357, label_range=[-1,84], unique_labels=[-1, 9, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21]..., domain_counts=d0=2, grad_norm=1.204e+01, seg_grad=1.196e+01, tex_grad=3.751e-01, stats_grad=7.263e-02, enc_grad=1.175e-02, dom_grad=1.351e+00, pred_conf=0.549±0.258, pred_entropy=1.677, prob_range=[0.000,1.000], fg_match=0.191, top_preds=[(83, 268173), (82, 265360), (84, 190695), (81, 127396), (78, 126393)], dom_logits={'mean': 0.04862105846405029, 'std': 0.09287574142217636, 'max': 0.1417236328125, 'min': -0.07916259765625, 'margin': 0.08831305801868439}
2025-11-09 09:16:59 [rank 0] step 0250: total=1.5254, seg=1.2686, domain=0.5239, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.586, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=2, grad_norm=3.068e+00, seg_grad=2.839e+00, tex_grad=3.194e-01, stats_grad=6.685e-02, enc_grad=7.855e-03, dom_grad=1.117e+00, pred_conf=0.675±0.295, pred_entropy=1.250, prob_range=[0.000,1.000], fg_match=0.685, top_preds=[(82, 298648), (83, 214857), (84, 145915), (22, 106932), (46, 84476)], dom_logits={'mean': 0.0668182373046875, 'std': 0.19637982547283173, 'max': 0.330322265625, 'min': -0.15869140625, 'margin': 0.1845172494649887}
2025-11-09 09:17:09 [rank 0] step 0300: total=1.0733, seg=0.8060, domain=0.5457, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.302, label_range=[-1,84], unique_labels=[-1, 11, 19, 21, 27, 29, 31, 33, 35, 37, 39, 41]..., domain_counts=d0=2, grad_norm=4.192e+00, seg_grad=3.919e+00, tex_grad=3.866e-01, stats_grad=5.876e-02, enc_grad=8.352e-03, dom_grad=1.436e+00, pred_conf=0.543±0.260, pred_entropy=1.735, prob_range=[0.000,1.000], fg_match=0.825, top_preds=[(83, 341839), (82, 331465), (84, 164697), (22, 121547), (46, 115767)], dom_logits={'mean': 0.0684967041015625, 'std': 0.1613456755876541, 'max': 0.23583984375, 'min': -0.1171875, 'margin': 0.15889188647270203}
2025-11-09 09:17:19 [rank 0] step 0350: total=0.9787, seg=0.7352, domain=0.4968, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.234, label_range=[-1,84], unique_labels=[-1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13]..., domain_counts=d0=2, grad_norm=2.769e+00, seg_grad=2.522e+00, tex_grad=3.406e-01, stats_grad=1.133e-01, enc_grad=1.040e-02, dom_grad=1.086e+00, pred_conf=0.637±0.250, pred_entropy=1.429, prob_range=[0.000,1.000], fg_match=0.856, top_preds=[(83, 685797), (82, 264136), (46, 176831), (79, 154595), (84, 121574)], dom_logits={'mean': 0.001739501953125, 'std': 0.23795174062252045, 'max': 0.29638671875, 'min': -0.32080078125, 'margin': 0.2171187698841095}
2025-11-09 09:17:29 [rank 0] step 0400: total=2.0528, seg=1.6626, domain=0.7960, align=0.0002, stats_align=0.0013, dom_acc=0.500, fg_frac=0.143, label_range=[-1,84], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=1, d1=1, grad_norm=7.129e+00, seg_grad=7.061e+00, tex_grad=2.856e-01, stats_grad=4.074e-02, enc_grad=6.464e-03, dom_grad=9.351e-01, pred_conf=0.537±0.262, pred_entropy=1.763, prob_range=[0.000,1.000], fg_match=0.394, top_preds=[(83, 461980), (82, 374801), (36, 226960), (84, 160892), (46, 131183)], dom_logits={'mean': -0.004974365234375, 'std': 0.2998446226119995, 'max': 0.319580078125, 'min': -0.384033203125, 'margin': 0.28370046615600586}
2025-11-09 09:17:34 [rank 0] finished train_epoch
2025-11-09 09:17:34 [rank 0] epoch 8 train summary -> total=1.2014, seg=0.8824, domain=0.6507, align=0.0005, stats=0.0010, dom_acc=0.728, batches=426
2025-11-09 09:17:34 [rank 0] epoch 8 train label dist top -> [(82, 53356432, 0.1504144276341824), (83, 32000198, 0.09021014498028106), (79, 22675872, 0.06392440761379964), (78, 20886636, 0.058880462605586305), (36, 16118263, 0.04543818266562913)], pred dist top -> [(82, 56453108, 0.15914409289001888), (83, 35330660, 0.09959887127747998), (79, 23751420, 0.06695642320968143), (78, 21395072, 0.06031376210069147), (36, 17636064, 0.04971693334280759)], fg_fraction=0.471
2025-11-09 09:17:34 [rank 0] epoch 8 parameter stats -> seg_rms=2.2447e-02 (Δ1.98e-05), domain_rms=9.8805e-02 (Δ2.20e-06), texproj_rms=6.4544e-02 (Δ3.25e-04), statsproj_rms=1.3122e-01 (Δ5.87e-04), encoder_rms=3.3517e-02 (Δ2.79e-04)
2025-11-09 09:17:34 [rank 0] checking should_stop
2025-11-09 09:17:34 [rank 0] should_stop -> False
2025-11-09 09:17:34 [rank 0] before can_run_validation decision
2025-11-09 09:17:34 [rank 0] after can_run_validation -> True
2025-11-09 09:17:34 [rank 0] starting validation on main rank
2025-11-09 09:17:36 [rank 0] val-step 001: loss=0.8881, fg_frac=0.780, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.606±0.219, pred_entropy=1.326, prob_range=[0.000,1.000], fg_match=0.495, top_preds=[(83, 135070), (82, 123749), (78, 55676), (35, 55571), (37, 52474)], batch_label_top=[(82, 81983.0), (78, 50461.0), (79, 48532.0), (83, 45983.0), (36, 37134.0)], batch_pred_top=[(82, 97942.0), (78, 55639.0), (35, 55200.0), (37, 52293.0), (83, 49607.0)]
2025-11-09 09:17:36 [rank 0] val-step 002: loss=0.9191, fg_frac=0.752, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.634±0.218, pred_entropy=1.229, prob_range=[0.000,1.000], fg_match=0.470, top_preds=[(83, 159618), (82, 125161), (78, 55440), (35, 49339), (80, 47135)], batch_label_top=[(82, 81668.0), (83, 55922.0), (79, 48795.0), (78, 46165.0), (36, 40828.0)], batch_pred_top=[(82, 92246.0), (83, 58953.0), (78, 55175.0), (35, 48846.0), (80, 46978.0)]
2025-11-09 09:17:37 [rank 0] finished validation on main rank
2025-11-09 09:17:37 [rank 0] epoch 8 val summary -> loss=0.9418, dice=0.0206, duration=2.87s
2025-11-09 09:17:37 [rank 0] epoch 8 val label dist top -> [(82, 1584556, 0.14381113912911525), (83, 1574683, 0.14291508535971753), (78, 733782, 0.06659658938683166), (79, 730461, 0.06629518205692488), (36, 469411, 0.04260280522098122)], pred dist top -> [(82, 1755765, 0.15934972616495158), (83, 1459799, 0.13248844287582345), (78, 750340, 0.06809936041019714), (79, 700412, 0.06356799480719007), (35, 535287, 0.04858157946516672)], dice top -> [(83, 0.8984), (18, 0.868), (82, 0.849), (47, 0.7155), (84, 0.679)]
2025-11-09 09:17:37 [rank 0] scheduler stepped
2025-11-09 09:17:37 [rank 0] epoch 8 lr=4.980287e-05, remaining=96.48 min (avg train=1.95, avg val=0.06)
2025-11-09 09:17:37 [rank 0] metrics logged and best model check complete
2025-11-09 09:17:37 [rank 0] epoch loop completed
2025-11-09 09:17:37 [rank 0] before can_start_epoch decision
2025-11-09 09:17:37 [rank 0] after can_start_epoch decision -> True
2025-11-09 09:17:37 [rank 0] starting train_epoch
2025-11-09 09:17:59 [rank 0] step 0050: total=1.1862, seg=0.7914, domain=0.7031, align=0.0023, stats_align=0.0045, dom_acc=0.500, fg_frac=0.539, label_range=[-1,84], unique_labels=[-1, 0, 1, 4, 5, 6, 8, 9, 10, 11, 12, 14]..., domain_counts=d0=1, d1=1, grad_norm=3.379e+00, seg_grad=3.062e+00, tex_grad=5.026e-01, stats_grad=8.454e-02, enc_grad=1.101e-02, dom_grad=1.334e+00, pred_conf=0.646±0.225, pred_entropy=1.304, prob_range=[0.000,1.000], fg_match=0.769, top_preds=[(83, 431129), (82, 327002), (84, 165453), (79, 119659), (78, 104183)], dom_logits={'mean': -0.0431671142578125, 'std': 0.2186729907989502, 'max': 0.26123046875, 'min': -0.33056640625, 'margin': 0.1901337057352066}
2025-11-09 09:18:09 [rank 0] step 0100: total=0.9031, seg=0.5873, domain=0.5640, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.669, label_range=[-1,86], unique_labels=[-1, 0, 2, 4, 6, 8, 10, 11, 12, 14, 16, 18]..., domain_counts=d0=2, grad_norm=2.453e+00, seg_grad=1.074e+00, tex_grad=6.525e-01, stats_grad=1.056e-01, enc_grad=1.368e-02, dom_grad=2.104e+00, pred_conf=0.779±0.238, pred_entropy=0.859, prob_range=[0.000,1.000], fg_match=0.889, top_preds=[(83, 298883), (82, 234965), (80, 143479), (37, 130670), (84, 72787)], dom_logits={'mean': 0.0255126953125, 'std': 0.14591515064239502, 'max': 0.2261962890625, 'min': -0.11383056640625, 'margin': 0.13829055428504944}
2025-11-09 09:18:19 [rank 0] step 0150: total=1.1180, seg=0.6543, domain=0.8276, align=0.0005, stats_align=0.0010, dom_acc=0.500, fg_frac=0.519, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 8, 9, 10, 12]..., domain_counts=d0=1, d1=1, grad_norm=3.828e+00, seg_grad=3.604e+00, tex_grad=4.392e-01, stats_grad=1.011e-01, enc_grad=8.621e-03, dom_grad=1.211e+00, pred_conf=0.666±0.248, pred_entropy=1.300, prob_range=[0.000,1.000], fg_match=0.864, top_preds=[(83, 394821), (82, 285208), (79, 259025), (36, 131400), (84, 118920)], dom_logits={'mean': -0.172332763671875, 'std': 0.29501932859420776, 'max': 0.09600830078125, 'min': -0.623046875, 'margin': 0.2555577754974365}
2025-11-09 09:18:29 [rank 0] step 0200: total=1.7574, seg=1.2580, domain=0.8903, align=0.0006, stats_align=0.0044, dom_acc=0.500, fg_frac=0.258, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=1, d1=1, grad_norm=9.089e+00, seg_grad=8.946e+00, tex_grad=3.847e-01, stats_grad=8.206e-02, enc_grad=8.114e-03, dom_grad=1.557e+00, pred_conf=0.475±0.271, pred_entropy=2.070, prob_range=[0.000,1.000], fg_match=0.550, top_preds=[(83, 435594), (82, 406482), (84, 157251), (36, 108312), (79, 91904)], dom_logits={'mean': -0.224517822265625, 'std': 0.43106019496917725, 'max': 0.2083740234375, 'min': -0.82861328125, 'margin': 0.38249337673187256}
2025-11-09 09:18:39 [rank 0] step 0250: total=1.7168, seg=1.2589, domain=0.8154, align=0.0013, stats_align=0.0066, dom_acc=0.500, fg_frac=0.401, label_range=[-1,85], unique_labels=[-1, 1, 8, 9, 11, 13, 14, 15, 16, 17, 18, 19]..., domain_counts=d0=1, d1=1, grad_norm=1.291e+01, seg_grad=1.282e+01, tex_grad=4.309e-01, stats_grad=6.245e-02, enc_grad=1.360e-02, dom_grad=1.440e+00, pred_conf=0.571±0.264, pred_entropy=1.558, prob_range=[0.000,1.000], fg_match=0.551, top_preds=[(83, 344217), (82, 309624), (84, 184062), (46, 88801), (21, 82980)], dom_logits={'mean': -0.1663970947265625, 'std': 0.30193594098091125, 'max': 0.11474609375, 'min': -0.6064453125, 'margin': 0.2711668610572815}
2025-11-09 09:18:49 [rank 0] step 0300: total=0.9078, seg=0.6443, domain=0.4705, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.953, label_range=[-1,86], unique_labels=[-1, 0, 1, 3, 8, 9, 10, 11, 12, 13, 14, 15]..., domain_counts=d0=2, grad_norm=3.259e+00, seg_grad=2.778e+00, tex_grad=5.075e-01, stats_grad=1.392e-01, enc_grad=1.085e-02, dom_grad=1.620e+00, pred_conf=0.787±0.199, pred_entropy=0.756, prob_range=[0.000,1.000], fg_match=0.777, top_preds=[(80, 145715), (81, 136886), (38, 136253), (82, 134597), (37, 102413)], dom_logits={'mean': -0.116485595703125, 'std': 0.2659131586551666, 'max': 0.212646484375, 'min': -0.43359375, 'margin': 0.2510964274406433}
2025-11-09 09:18:59 [rank 0] step 0350: total=1.2172, seg=0.7200, domain=0.8865, align=0.0016, stats_align=0.0031, dom_acc=0.500, fg_frac=0.584, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 8, 9, 10, 11]..., domain_counts=d0=1, d1=1, grad_norm=3.700e+00, seg_grad=3.425e+00, tex_grad=3.650e-01, stats_grad=7.092e-02, enc_grad=7.876e-03, dom_grad=1.350e+00, pred_conf=0.705±0.259, pred_entropy=1.078, prob_range=[0.000,1.000], fg_match=0.802, top_preds=[(83, 390525), (82, 272582), (46, 109441), (84, 104644), (16, 78782)], dom_logits={'mean': -0.058258056640625, 'std': 0.3279970586299896, 'max': 0.3525390625, 'min': -0.52001953125, 'margin': 0.28137266635894775}
2025-11-09 09:19:09 [rank 0] step 0400: total=0.8522, seg=0.5186, domain=0.5957, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.756, label_range=[-1,86], unique_labels=[-1, 0, 2, 3, 4, 5, 6, 7, 8, 10, 11, 12]..., domain_counts=d0=2, grad_norm=1.749e+00, seg_grad=8.295e-01, tex_grad=5.104e-01, stats_grad=1.329e-01, enc_grad=1.643e-02, dom_grad=1.447e+00, pred_conf=0.820±0.201, pred_entropy=0.694, prob_range=[0.000,1.000], fg_match=0.930, top_preds=[(83, 259789), (82, 251568), (79, 164488), (78, 152759), (36, 103770)], dom_logits={'mean': -0.05431365966796875, 'std': 0.10280923545360565, 'max': 0.053192138671875, 'min': -0.162841796875, 'margin': 0.10230663418769836}
2025-11-09 09:19:14 [rank 0] finished train_epoch
2025-11-09 09:19:14 [rank 0] epoch 9 train summary -> total=1.2267, seg=0.8540, domain=0.6651, align=0.0005, stats=0.0010, dom_acc=0.729, batches=426
2025-11-09 09:19:14 [rank 0] epoch 9 train label dist top -> [(82, 53846880, 0.14791058750860703), (83, 32248616, 0.08858288054757238), (79, 23982740, 0.06587756177268153), (78, 22972622, 0.06310289503557404), (36, 16775605, 0.04608047098294879)], pred dist top -> [(82, 56628292, 0.15555076091818876), (83, 35180552, 0.09663652990137699), (78, 24047952, 0.06605668474203812), (79, 24022240, 0.06598605712775782), (35, 17300450, 0.04752214955957137)], fg_fraction=0.484
2025-11-09 09:19:14 [rank 0] epoch 9 parameter stats -> seg_rms=2.2467e-02 (Δ2.02e-05), domain_rms=9.8666e-02 (Δ-1.39e-04), texproj_rms=6.4749e-02 (Δ2.06e-04), statsproj_rms=1.3180e-01 (Δ5.75e-04), encoder_rms=3.3468e-02 (Δ-4.82e-05)
2025-11-09 09:19:14 [rank 0] checking should_stop
2025-11-09 09:19:14 [rank 0] should_stop -> False
2025-11-09 09:19:14 [rank 0] before can_run_validation decision
2025-11-09 09:19:14 [rank 0] after can_run_validation -> True
2025-11-09 09:19:14 [rank 0] starting validation on main rank
2025-11-09 09:19:16 [rank 0] val-step 001: loss=0.7635, fg_frac=0.780, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.677±0.214, pred_entropy=1.059, prob_range=[0.000,1.000], fg_match=0.652, top_preds=[(83, 149287), (82, 133915), (79, 64041), (36, 41971), (37, 33924)], batch_label_top=[(82, 81983.0), (78, 50461.0), (79, 48532.0), (83, 45983.0), (36, 37134.0)], batch_pred_top=[(82, 92128.0), (79, 63370.0), (83, 49954.0), (36, 41917.0), (37, 33653.0)]
2025-11-09 09:19:16 [rank 0] val-step 002: loss=0.6095, fg_frac=0.752, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.703±0.208, pred_entropy=0.996, prob_range=[0.000,1.000], fg_match=0.766, top_preds=[(83, 169641), (82, 125401), (78, 55486), (79, 50313), (35, 43381)], batch_label_top=[(82, 81668.0), (83, 55922.0), (79, 48795.0), (78, 46165.0), (36, 40828.0)], batch_pred_top=[(82, 90022.0), (83, 57842.0), (78, 55458.0), (79, 49506.0), (35, 43081.0)]
2025-11-09 09:19:17 [rank 0] finished validation on main rank
2025-11-09 09:19:17 [rank 0] epoch 9 val summary -> loss=0.8982, dice=0.0217, duration=2.76s
2025-11-09 09:19:17 [rank 0] epoch 9 val label dist top -> [(82, 1584556, 0.14381113912911525), (83, 1574683, 0.14291508535971753), (78, 733782, 0.06659658938683166), (79, 730461, 0.06629518205692488), (36, 469411, 0.04260280522098122)], pred dist top -> [(82, 1672464, 0.15178949370829217), (83, 1520936, 0.1380371149410182), (79, 771882, 0.07005446932343176), (78, 739708, 0.06713442131607818), (35, 477519, 0.04333867111405086)], dice top -> [(83, 0.9209), (18, 0.872), (82, 0.8657), (47, 0.7206), (84, 0.6836)]
2025-11-09 09:19:17 [rank 0] scheduler stepped
2025-11-09 09:19:17 [rank 0] epoch 9 lr=4.975059e-05, remaining=94.82 min (avg train=1.94, avg val=0.06)
2025-11-09 09:19:17 [rank 0] metrics logged and best model check complete
2025-11-09 09:19:17 [rank 0] epoch loop completed
2025-11-09 09:19:17 [rank 0] before can_start_epoch decision
2025-11-09 09:19:17 [rank 0] after can_start_epoch decision -> True
2025-11-09 09:19:17 [rank 0] starting train_epoch
2025-11-09 09:19:39 [rank 0] step 0050: total=1.7395, seg=1.4327, domain=0.4869, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.235, label_range=[-1,85], unique_labels=[-1, 1, 3, 9, 11, 13, 15, 17, 18, 19, 20, 21]..., domain_counts=d0=2, grad_norm=5.178e+00, seg_grad=4.849e+00, tex_grad=5.928e-01, stats_grad=1.562e-01, enc_grad=1.425e-02, dom_grad=1.708e+00, pred_conf=0.510±0.269, pred_entropy=1.869, prob_range=[0.000,1.000], fg_match=0.314, top_preds=[(82, 442870), (83, 376545), (35, 210651), (84, 142351), (36, 95618)], dom_logits={'mean': -0.007171630859375, 'std': 0.23480939865112305, 'max': 0.2415771484375, 'min': -0.274658203125, 'margin': 0.2291448712348938}
2025-11-09 09:19:49 [rank 0] step 0100: total=1.5401, seg=1.0640, domain=0.7551, align=0.0006, stats_align=0.0016, dom_acc=0.500, fg_frac=0.654, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=1, d1=1, grad_norm=4.821e+00, seg_grad=4.629e+00, tex_grad=4.895e-01, stats_grad=1.376e-01, enc_grad=2.142e-02, dom_grad=1.246e+00, pred_conf=0.638±0.241, pred_entropy=1.237, prob_range=[0.000,1.000], fg_match=0.687, top_preds=[(83, 393913), (82, 268403), (79, 128792), (81, 114071), (38, 94211)], dom_logits={'mean': -0.00958251953125, 'std': 0.3041178584098816, 'max': 0.30126953125, 'min': -0.3388671875, 'margin': 0.294464111328125}
2025-11-09 09:19:59 [rank 0] step 0150: total=0.9988, seg=0.6980, domain=0.4775, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.498, label_range=[-1,86], unique_labels=[-1, 1, 8, 9, 11, 13, 14, 15, 16, 17, 18, 19]..., domain_counts=d0=2, grad_norm=3.481e+00, seg_grad=3.020e+00, tex_grad=5.567e-01, stats_grad=1.017e-01, enc_grad=9.817e-03, dom_grad=1.636e+00, pred_conf=0.655±0.265, pred_entropy=1.273, prob_range=[0.000,1.000], fg_match=0.758, top_preds=[(82, 304806), (83, 289200), (84, 158720), (80, 112801), (35, 81664)], dom_logits={'mean': 0.09039306640625, 'std': 0.2461700290441513, 'max': 0.360595703125, 'min': -0.1578369140625, 'margin': 0.2406834065914154}
2025-11-09 09:20:09 [rank 0] step 0200: total=1.5510, seg=1.0553, domain=0.7858, align=0.0013, stats_align=0.0026, dom_acc=0.500, fg_frac=0.317, label_range=[-1,84], unique_labels=[-1, 10, 16, 17, 20, 21, 22, 23, 24, 26, 28, 30]..., domain_counts=d0=1, d1=1, grad_norm=4.692e+00, seg_grad=4.412e+00, tex_grad=4.960e-01, stats_grad=6.488e-02, enc_grad=8.023e-03, dom_grad=1.515e+00, pred_conf=0.563±0.261, pred_entropy=1.592, prob_range=[0.000,1.000], fg_match=0.303, top_preds=[(83, 381038), (82, 360309), (84, 181728), (35, 170078), (78, 140754)], dom_logits={'mean': 0.061737060546875, 'std': 0.33003056049346924, 'max': 0.423828125, 'min': -0.386474609375, 'margin': 0.303888201713562}
2025-11-09 09:20:19 [rank 0] step 0250: total=0.9778, seg=0.7068, domain=0.4301, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.137, label_range=[-1,83], unique_labels=[-1, 16, 17, 21, 22, 25, 26, 28, 31, 32, 35, 36]..., domain_counts=d0=2, grad_norm=2.267e+00, seg_grad=1.457e+00, tex_grad=6.176e-01, stats_grad=1.353e-01, enc_grad=1.341e-02, dom_grad=1.618e+00, pred_conf=0.460±0.287, pred_entropy=2.113, prob_range=[0.000,1.000], fg_match=0.914, top_preds=[(82, 414820), (83, 345715), (84, 155483), (22, 120252), (79, 97656)], dom_logits={'mean': 0.06341552734375, 'std': 0.31780993938446045, 'max': 0.462646484375, 'min': -0.253173828125, 'margin': 0.3015206456184387}
2025-11-09 09:20:29 [rank 0] step 0300: total=0.7727, seg=0.4932, domain=0.4436, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.915, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 8, 9, 10, 12]..., domain_counts=d0=2, grad_norm=2.124e+00, seg_grad=9.963e-01, tex_grad=6.584e-01, stats_grad=1.515e-01, enc_grad=1.531e-02, dom_grad=1.750e+00, pred_conf=0.853±0.161, pred_entropy=0.542, prob_range=[0.000,1.000], fg_match=0.913, top_preds=[(82, 244254), (79, 190122), (83, 152344), (78, 128266), (36, 120932)], dom_logits={'mean': 0.018035888671875, 'std': 0.30519065260887146, 'max': 0.415771484375, 'min': -0.319091796875, 'margin': 0.2852504849433899}
2025-11-09 09:20:39 [rank 0] step 0350: total=1.3124, seg=0.8116, domain=0.7944, align=0.0004, stats_align=0.0013, dom_acc=0.500, fg_frac=0.358, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=1, d1=1, grad_norm=5.357e+00, seg_grad=5.127e+00, tex_grad=6.183e-01, stats_grad=5.827e-02, enc_grad=1.027e-02, dom_grad=1.426e+00, pred_conf=0.606±0.264, pred_entropy=1.507, prob_range=[0.000,1.000], fg_match=0.766, top_preds=[(83, 476775), (82, 354053), (35, 138203), (84, 106172), (79, 87378)], dom_logits={'mean': 0.01275634765625, 'std': 0.3439094126224518, 'max': 0.38037109375, 'min': -0.387939453125, 'margin': 0.327604204416275}
2025-11-09 09:20:48 [rank 0] step 0400: total=1.2677, seg=0.7483, domain=0.8229, align=0.0024, stats_align=0.0029, dom_acc=0.500, fg_frac=0.361, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=1, d1=1, grad_norm=4.529e+00, seg_grad=4.128e+00, tex_grad=7.914e-01, stats_grad=1.071e-01, enc_grad=1.521e-02, dom_grad=1.684e+00, pred_conf=0.581±0.260, pred_entropy=1.593, prob_range=[0.000,1.000], fg_match=0.798, top_preds=[(83, 551918), (82, 373229), (84, 124405), (79, 115119), (78, 78568)], dom_logits={'mean': 0.00653076171875, 'std': 0.31594011187553406, 'max': 0.3525390625, 'min': -0.416259765625, 'margin': 0.2920876741409302}
2025-11-09 09:20:53 [rank 0] finished train_epoch
2025-11-09 09:20:53 [rank 0] epoch 10 train summary -> total=1.2849, seg=0.8854, domain=0.6336, align=0.0004, stats=0.0010, dom_acc=0.728, batches=426
2025-11-09 09:20:53 [rank 0] epoch 10 train label dist top -> [(82, 53766816, 0.1474054549794998), (83, 32359788, 0.08871660306573032), (78, 23442068, 0.06426805521086414), (79, 23106670, 0.06334853833284751), (35, 16899314, 0.04633064135714175)], pred dist top -> [(82, 56576900, 0.1551094692147433), (83, 35588328, 0.09756785306936554), (78, 24273778, 0.06654823472859972), (79, 23592554, 0.06468061219968166), (35, 17803836, 0.04881044298903508)], fg_fraction=0.484
2025-11-09 09:20:53 [rank 0] epoch 10 parameter stats -> seg_rms=2.2496e-02 (Δ2.88e-05), domain_rms=9.8618e-02 (Δ-4.80e-05), texproj_rms=6.4999e-02 (Δ2.50e-04), statsproj_rms=1.3234e-01 (Δ5.39e-04), encoder_rms=3.3553e-02 (Δ8.46e-05)
2025-11-09 09:20:53 [rank 0] checking should_stop
2025-11-09 09:20:53 [rank 0] should_stop -> False
2025-11-09 09:20:53 [rank 0] before can_run_validation decision
2025-11-09 09:20:53 [rank 0] after can_run_validation -> True
2025-11-09 09:20:53 [rank 0] starting validation on main rank
2025-11-09 09:20:55 [rank 0] val-step 001: loss=0.6718, fg_frac=0.780, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.656±0.215, pred_entropy=1.122, prob_range=[0.000,1.000], fg_match=0.714, top_preds=[(83, 147836), (82, 125022), (80, 54071), (78, 51930), (37, 49937)], batch_label_top=[(82, 81983.0), (78, 50461.0), (79, 48532.0), (83, 45983.0), (36, 37134.0)], batch_pred_top=[(82, 94370.0), (80, 54001.0), (78, 51748.0), (37, 49937.0), (83, 49449.0)]
2025-11-09 09:20:55 [rank 0] val-step 002: loss=0.7317, fg_frac=0.752, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.662±0.217, pred_entropy=1.086, prob_range=[0.000,1.000], fg_match=0.632, top_preds=[(83, 174570), (82, 119606), (78, 74934), (35, 59260), (80, 53030)], batch_label_top=[(82, 81668.0), (83, 55922.0), (79, 48795.0), (78, 46165.0), (36, 40828.0)], batch_pred_top=[(82, 91903.0), (78, 74683.0), (83, 58826.0), (35, 58217.0), (80, 52783.0)]
2025-11-09 09:20:56 [rank 0] finished validation on main rank
2025-11-09 09:20:56 [rank 0] epoch 10 val summary -> loss=0.7806, dice=0.0271, duration=2.75s
2025-11-09 09:20:56 [rank 0] epoch 10 val label dist top -> [(82, 1584556, 0.14381113912911525), (83, 1574683, 0.14291508535971753), (78, 733782, 0.06659658938683166), (79, 730461, 0.06629518205692488), (36, 469411, 0.04260280522098122)], pred dist top -> [(82, 1737995, 0.15773695644124072), (83, 1467061, 0.13314752749785994), (78, 843261, 0.07653268486134718), (80, 707258, 0.06418932409973506), (79, 591432, 0.05367718757646362)], dice top -> [(83, 0.9113), (18, 0.8657), (82, 0.861), (47, 0.7228), (49, 0.693)]
2025-11-09 09:20:56 [rank 0] scheduler stepped
2025-11-09 09:20:56 [rank 0] epoch 10 lr=4.969221e-05, remaining=93.16 min (avg train=1.94, avg val=0.06)
2025-11-09 09:20:56 [rank 0] metrics logged and best model check complete
2025-11-09 09:20:58 [rank 0] epoch loop completed
2025-11-09 09:20:58 [rank 0] before can_start_epoch decision
2025-11-09 09:20:58 [rank 0] after can_start_epoch decision -> True
2025-11-09 09:20:58 [rank 0] starting train_epoch
2025-11-09 09:21:20 [rank 0] step 0050: total=1.2310, seg=0.6602, domain=0.8149, align=0.0011, stats_align=0.0009, dom_acc=0.500, fg_frac=0.509, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=1, d1=1, grad_norm=2.910e+00, seg_grad=2.112e+00, tex_grad=8.547e-01, stats_grad=1.173e-01, enc_grad=1.689e-02, dom_grad=1.806e+00, pred_conf=0.656±0.258, pred_entropy=1.245, prob_range=[0.000,1.000], fg_match=0.805, top_preds=[(83, 443458), (82, 337313), (78, 132772), (84, 80015), (35, 73149)], dom_logits={'mean': 0.12969970703125, 'std': 0.3817402720451355, 'max': 0.52294921875, 'min': -0.333251953125, 'margin': 0.35896486043930054}
2025-11-09 09:21:30 [rank 0] step 0100: total=1.0447, seg=0.6648, domain=0.5427, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.337, label_range=[-1,83], unique_labels=[-1, 1, 9, 13, 15, 16, 17, 18, 21, 25, 27, 31]..., domain_counts=d0=2, grad_norm=3.017e+00, seg_grad=1.902e+00, tex_grad=1.052e+00, stats_grad=2.052e-01, enc_grad=2.893e-02, dom_grad=2.082e+00, pred_conf=0.638±0.276, pred_entropy=1.363, prob_range=[0.000,1.000], fg_match=0.914, top_preds=[(83, 457263), (82, 348697), (79, 142734), (84, 130110), (17, 118260)], dom_logits={'mean': 0.33597564697265625, 'std': 0.18605820834636688, 'max': 0.52490234375, 'min': 0.054351806640625, 'margin': 0.16430844366550446}
2025-11-09 09:21:40 [rank 0] step 0150: total=1.2172, seg=0.6832, domain=0.7625, align=0.0005, stats_align=0.0007, dom_acc=0.500, fg_frac=0.557, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=1, d1=1, grad_norm=4.081e+00, seg_grad=3.842e+00, tex_grad=7.660e-01, stats_grad=2.844e-01, enc_grad=1.940e-02, dom_grad=1.107e+00, pred_conf=0.640±0.250, pred_entropy=1.272, prob_range=[0.000,1.000], fg_match=0.800, top_preds=[(82, 357376), (83, 325797), (81, 143528), (38, 138515), (84, 99474)], dom_logits={'mean': 0.24495887756347656, 'std': 0.1677107810974121, 'max': 0.435302734375, 'min': 0.01059722900390625, 'margin': 0.154913991689682}
2025-11-09 09:21:50 [rank 0] step 0200: total=1.0726, seg=0.6931, domain=0.5422, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.480, label_range=[-1,84], unique_labels=[-1, 7, 19, 31, 32, 33, 34, 35, 36, 37, 38, 39]..., domain_counts=d0=2, grad_norm=2.866e+00, seg_grad=1.717e+00, tex_grad=8.868e-01, stats_grad=1.648e-01, enc_grad=2.457e-02, dom_grad=2.111e+00, pred_conf=0.638±0.270, pred_entropy=1.327, prob_range=[0.000,1.000], fg_match=0.899, top_preds=[(82, 379356), (83, 378667), (79, 161939), (36, 143489), (84, 137343)], dom_logits={'mean': 0.0372467041015625, 'std': 0.16868215799331665, 'max': 0.252197265625, 'min': -0.134765625, 'margin': 0.16323332488536835}
2025-11-09 09:22:00 [rank 0] step 0250: total=1.0480, seg=0.6572, domain=0.5583, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.196, label_range=[-1,83], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 7, 8, 9, 11, 13]..., domain_counts=d0=2, grad_norm=2.606e+00, seg_grad=1.463e+00, tex_grad=8.207e-01, stats_grad=1.389e-01, enc_grad=1.935e-02, dom_grad=1.989e+00, pred_conf=0.560±0.266, pred_entropy=1.705, prob_range=[0.000,1.000], fg_match=0.906, top_preds=[(83, 498513), (82, 290751), (35, 171655), (84, 148700), (78, 126635)], dom_logits={'mean': -0.10244369506835938, 'std': 0.14758524298667908, 'max': 0.0694580078125, 'min': -0.26904296875, 'margin': 0.14456388354301453}
2025-11-09 09:22:10 [rank 0] step 0300: total=0.9112, seg=0.5610, domain=0.5002, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.460, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=2, grad_norm=2.635e+00, seg_grad=1.523e+00, tex_grad=7.655e-01, stats_grad=1.466e-01, enc_grad=2.070e-02, dom_grad=2.004e+00, pred_conf=0.683±0.276, pred_entropy=1.204, prob_range=[0.000,1.000], fg_match=0.899, top_preds=[(83, 359965), (82, 310277), (84, 120576), (16, 87306), (22, 85071)], dom_logits={'mean': -0.23150634765625, 'std': 0.2217099666595459, 'max': 0.0504150390625, 'min': -0.453125, 'margin': 0.2132730334997177}
2025-11-09 09:22:20 [rank 0] step 0350: total=0.8620, seg=0.5468, domain=0.4503, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.622, label_range=[-1,86], unique_labels=[-1, 0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20]..., domain_counts=d0=2, grad_norm=2.331e+00, seg_grad=1.147e+00, tex_grad=6.694e-01, stats_grad=1.283e-01, enc_grad=1.657e-02, dom_grad=1.911e+00, pred_conf=0.799±0.239, pred_entropy=0.738, prob_range=[0.000,1.000], fg_match=0.922, top_preds=[(82, 279677), (83, 275607), (79, 165653), (36, 139079), (84, 128846)], dom_logits={'mean': -0.16668701171875, 'std': 0.28435662388801575, 'max': 0.15380859375, 'min': -0.4716796875, 'margin': 0.27512919902801514}
2025-11-09 09:22:30 [rank 0] step 0400: total=1.4834, seg=1.2145, domain=0.3840, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.324, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=2, grad_norm=4.348e+00, seg_grad=3.924e+00, tex_grad=6.193e-01, stats_grad=1.111e-01, enc_grad=1.482e-02, dom_grad=1.764e+00, pred_conf=0.637±0.281, pred_entropy=1.405, prob_range=[0.000,1.000], fg_match=0.742, top_preds=[(83, 432824), (82, 352264), (79, 116992), (84, 111503), (16, 85425)], dom_logits={'mean': -0.1182861328125, 'std': 0.3802274763584137, 'max': 0.268798828125, 'min': -0.52978515625, 'margin': 0.36224067211151123}
2025-11-09 09:22:35 [rank 0] finished train_epoch
2025-11-09 09:22:35 [rank 0] epoch 11 train summary -> total=1.2990, seg=0.8508, domain=0.6398, align=0.0006, stats=0.0011, dom_acc=0.728, batches=426
2025-11-09 09:22:35 [rank 0] epoch 11 train label dist top -> [(82, 54952568, 0.15124465812042265), (83, 33178484, 0.09131635976564212), (78, 24301836, 0.06688537062578366), (79, 23743200, 0.06534784992549973), (35, 17339940, 0.047724308300362624)], pred dist top -> [(82, 57826932, 0.15915571075496412), (83, 36138140, 0.0994621564405734), (78, 24911772, 0.06856408669278208), (79, 24232586, 0.06669477897013097), (36, 18170920, 0.050011397590167726)], fg_fraction=0.483
2025-11-09 09:22:35 [rank 0] epoch 11 parameter stats -> seg_rms=2.2516e-02 (Δ1.94e-05), domain_rms=9.8556e-02 (Δ-6.21e-05), texproj_rms=6.5294e-02 (Δ2.95e-04), statsproj_rms=1.3271e-01 (Δ3.73e-04), encoder_rms=3.3806e-02 (Δ2.53e-04)
2025-11-09 09:22:35 [rank 0] checking should_stop
2025-11-09 09:22:35 [rank 0] should_stop -> False
2025-11-09 09:22:35 [rank 0] before can_run_validation decision
2025-11-09 09:22:35 [rank 0] after can_run_validation -> True
2025-11-09 09:22:35 [rank 0] starting validation on main rank
2025-11-09 09:22:37 [rank 0] val-step 001: loss=0.7053, fg_frac=0.780, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.640±0.216, pred_entropy=1.209, prob_range=[0.000,1.000], fg_match=0.725, top_preds=[(83, 136224), (82, 136116), (78, 48089), (79, 48065), (37, 47873)], batch_label_top=[(82, 81983.0), (78, 50461.0), (79, 48532.0), (83, 45983.0), (36, 37134.0)], batch_pred_top=[(82, 95463.0), (83, 47881.0), (37, 47873.0), (78, 47545.0), (79, 46404.0)]
2025-11-09 09:22:37 [rank 0] val-step 002: loss=0.7161, fg_frac=0.752, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.646±0.217, pred_entropy=1.186, prob_range=[0.000,1.000], fg_match=0.697, top_preds=[(83, 163024), (82, 137055), (35, 54857), (78, 54220), (79, 50217)], batch_label_top=[(82, 81668.0), (83, 55922.0), (79, 48795.0), (78, 46165.0), (36, 40828.0)], batch_pred_top=[(82, 93628.0), (83, 56709.0), (35, 54631.0), (78, 53514.0), (80, 49042.0)]
2025-11-09 09:22:38 [rank 0] finished validation on main rank
2025-11-09 09:22:38 [rank 0] epoch 11 val summary -> loss=0.8146, dice=0.0254, duration=2.88s
2025-11-09 09:22:38 [rank 0] epoch 11 val label dist top -> [(82, 1584556, 0.14381113912911525), (83, 1574683, 0.14291508535971753), (78, 733782, 0.06659658938683166), (79, 730461, 0.06629518205692488), (36, 469411, 0.04260280522098122)], pred dist top -> [(82, 1762646, 0.15997423198762206), (83, 1459924, 0.1324997876262716), (78, 904168, 0.0820604825857173), (35, 657685, 0.05969017758800078), (79, 597651, 0.054241611600760624)], dice top -> [(83, 0.9103), (18, 0.8731), (82, 0.8601), (47, 0.7346), (84, 0.6999)]
2025-11-09 09:22:38 [rank 0] scheduler stepped
2025-11-09 09:22:38 [rank 0] epoch 11 lr=4.962773e-05, remaining=91.47 min (avg train=1.94, avg val=0.06)
2025-11-09 09:22:38 [rank 0] metrics logged and best model check complete
2025-11-09 09:22:38 [rank 0] epoch loop completed
2025-11-09 09:22:38 [rank 0] before can_start_epoch decision
2025-11-09 09:22:38 [rank 0] after can_start_epoch decision -> True
2025-11-09 09:22:38 [rank 0] starting train_epoch
2025-11-09 09:23:00 [rank 0] step 0050: total=1.8506, seg=0.9735, domain=1.2529, align=0.0000, stats_align=0.0000, dom_acc=0.000, fg_frac=0.246, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 6, 8, 9, 10, 11, 12, 13]..., domain_counts=d0=0, d1=2, grad_norm=1.173e+01, seg_grad=1.082e+01, tex_grad=1.330e+00, stats_grad=1.637e-01, enc_grad=2.595e-02, dom_grad=4.315e+00, pred_conf=0.564±0.260, pred_entropy=1.620, prob_range=[0.000,1.000], fg_match=0.564, top_preds=[(83, 477728), (82, 345018), (79, 165166), (84, 140040), (78, 92714)], dom_logits={'mean': 0.05230712890625, 'std': 0.47021663188934326, 'max': 0.66064453125, 'min': -0.440673828125, 'margin': 0.4266502261161804}
2025-11-09 09:23:10 [rank 0] step 0100: total=0.9991, seg=0.7334, domain=0.3795, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.303, label_range=[-1,83], unique_labels=[-1, 4, 5, 7, 8, 9, 13, 15, 16, 17, 18, 25]..., domain_counts=d0=2, grad_norm=3.241e+00, seg_grad=2.770e+00, tex_grad=6.721e-01, stats_grad=1.081e-01, enc_grad=1.663e-02, dom_grad=1.539e+00, pred_conf=0.611±0.277, pred_entropy=1.538, prob_range=[0.000,1.000], fg_match=0.887, top_preds=[(83, 412701), (82, 343788), (79, 175464), (84, 152330), (17, 96579)], dom_logits={'mean': -0.13494873046875, 'std': 0.39494457840919495, 'max': 0.307373046875, 'min': -0.6005859375, 'margin': 0.3695707619190216}
2025-11-09 09:23:20 [rank 0] step 0150: total=0.7370, seg=0.4888, domain=0.3546, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.960, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 5, 7, 8, 9, 10, 11, 12]..., domain_counts=d0=2, grad_norm=2.188e+00, seg_grad=1.308e+00, tex_grad=6.435e-01, stats_grad=1.093e-01, enc_grad=1.462e-02, dom_grad=1.628e+00, pred_conf=0.855±0.170, pred_entropy=0.517, prob_range=[0.000,1.000], fg_match=0.868, top_preds=[(82, 172368), (78, 138833), (80, 130135), (37, 105207), (35, 94726)], dom_logits={'mean': -0.017333984375, 'std': 0.43265560269355774, 'max': 0.485107421875, 'min': -0.5078125, 'margin': 0.40280067920684814}
2025-11-09 09:23:30 [rank 0] step 0200: total=1.9540, seg=1.1197, domain=1.1919, align=0.0000, stats_align=0.0000, dom_acc=0.000, fg_frac=0.276, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=0, d1=2, grad_norm=5.964e+00, seg_grad=4.287e+00, tex_grad=1.417e+00, stats_grad=1.611e-01, enc_grad=3.333e-02, dom_grad=3.894e+00, pred_conf=0.497±0.263, pred_entropy=1.957, prob_range=[0.000,1.000], fg_match=0.633, top_preds=[(83, 432381), (82, 372385), (79, 214001), (84, 168960), (36, 79689)], dom_logits={'mean': 0.04986572265625, 'std': 0.421542227268219, 'max': 0.54541015625, 'min': -0.43212890625, 'margin': 0.3926759958267212}
2025-11-09 09:23:40 [rank 0] step 0250: total=1.0218, seg=0.7550, domain=0.3812, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.558, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 5, 7, 8, 9, 11, 13, 14]..., domain_counts=d0=2, grad_norm=3.226e+00, seg_grad=2.620e+00, tex_grad=8.076e-01, stats_grad=1.763e-01, enc_grad=1.905e-02, dom_grad=1.692e+00, pred_conf=0.649±0.310, pred_entropy=1.343, prob_range=[0.000,1.000], fg_match=0.786, top_preds=[(82, 283859), (83, 229910), (84, 110496), (22, 99445), (17, 97004)], dom_logits={'mean': -0.096099853515625, 'std': 0.39492785930633545, 'max': 0.4013671875, 'min': -0.541015625, 'margin': 0.3662766218185425}
2025-11-09 09:23:50 [rank 0] step 0300: total=1.3284, seg=0.7969, domain=0.7592, align=0.0000, stats_align=0.0006, dom_acc=0.500, fg_frac=0.383, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11]..., domain_counts=d0=1, d1=1, grad_norm=4.891e+00, seg_grad=4.640e+00, tex_grad=7.004e-01, stats_grad=9.867e-02, enc_grad=1.459e-02, dom_grad=1.374e+00, pred_conf=0.594±0.261, pred_entropy=1.490, prob_range=[0.000,1.000], fg_match=0.727, top_preds=[(83, 479260), (82, 339963), (84, 90448), (79, 81684), (36, 61775)], dom_logits={'mean': 0.11126708984375, 'std': 0.4139194190502167, 'max': 0.625, 'min': -0.421142578125, 'margin': 0.37371015548706055}
2025-11-09 09:24:00 [rank 0] step 0350: total=1.1099, seg=0.5118, domain=0.8538, align=0.0008, stats_align=0.0015, dom_acc=0.500, fg_frac=0.841, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 8, 9, 10, 11, 12, 13, 14]..., domain_counts=d0=1, d1=1, grad_norm=2.440e+00, seg_grad=1.451e+00, tex_grad=7.634e-01, stats_grad=1.182e-01, enc_grad=1.510e-02, dom_grad=1.803e+00, pred_conf=0.768±0.228, pred_entropy=0.842, prob_range=[0.000,1.000], fg_match=0.881, top_preds=[(82, 250783), (83, 243241), (16, 81687), (84, 74264), (81, 71561)], dom_logits={'mean': 0.1474609375, 'std': 0.41926658153533936, 'max': 0.724609375, 'min': -0.27001953125, 'margin': 0.3778005838394165}
2025-11-09 09:24:09 [rank 0] step 0400: total=1.4729, seg=1.1791, domain=0.4197, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.333, label_range=[-1,83], unique_labels=[-1, 9, 13, 15, 17, 18, 19, 20, 21, 25, 27, 30]..., domain_counts=d0=2, grad_norm=3.986e+00, seg_grad=3.375e+00, tex_grad=7.951e-01, stats_grad=1.622e-01, enc_grad=1.764e-02, dom_grad=1.961e+00, pred_conf=0.566±0.271, pred_entropy=1.598, prob_range=[0.000,1.000], fg_match=0.720, top_preds=[(82, 368775), (83, 337663), (84, 152363), (79, 152017), (78, 108228)], dom_logits={'mean': 0.1737060546875, 'std': 0.33644959330558777, 'max': 0.611328125, 'min': -0.17626953125, 'margin': 0.31508129835128784}
2025-11-09 09:24:14 [rank 0] finished train_epoch
2025-11-09 09:24:14 [rank 0] epoch 12 train summary -> total=1.2915, seg=0.8648, domain=0.6092, align=0.0003, stats=0.0010, dom_acc=0.728, batches=426
2025-11-09 09:24:14 [rank 0] epoch 12 train label dist top -> [(82, 53141244, 0.15196796597131979), (83, 32045644, 0.09164089829965268), (79, 22650300, 0.06477304181362756), (78, 22325570, 0.0638444117350794), (36, 16434911, 0.04699889967930877)], pred dist top -> [(82, 56334400, 0.16109943167112667), (83, 35211132, 0.10069324167288587), (79, 24172580, 0.06912630470946425), (78, 22471224, 0.06426093852698496), (36, 17764554, 0.050801278673262514)], fg_fraction=0.464
2025-11-09 09:24:14 [rank 0] epoch 12 parameter stats -> seg_rms=2.2538e-02 (Δ2.22e-05), domain_rms=9.8568e-02 (Δ1.18e-05), texproj_rms=6.5414e-02 (Δ1.20e-04), statsproj_rms=1.3314e-01 (Δ4.28e-04), encoder_rms=3.3725e-02 (Δ-8.13e-05)
2025-11-09 09:24:14 [rank 0] checking should_stop
2025-11-09 09:24:14 [rank 0] should_stop -> False
2025-11-09 09:24:14 [rank 0] before can_run_validation decision
2025-11-09 09:24:14 [rank 0] after can_run_validation -> True
2025-11-09 09:24:14 [rank 0] starting validation on main rank
2025-11-09 09:24:16 [rank 0] val-step 001: loss=0.7880, fg_frac=0.780, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.620±0.217, pred_entropy=1.226, prob_range=[0.000,1.000], fg_match=0.580, top_preds=[(83, 150774), (82, 134352), (80, 53740), (78, 53638), (35, 42426)], batch_label_top=[(82, 81983.0), (78, 50461.0), (79, 48532.0), (83, 45983.0), (36, 37134.0)], batch_pred_top=[(82, 90832.0), (80, 53592.0), (78, 53141.0), (83, 50051.0), (35, 42424.0)]
2025-11-09 09:24:16 [rank 0] val-step 002: loss=0.8941, fg_frac=0.752, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.657±0.215, pred_entropy=1.107, prob_range=[0.000,1.000], fg_match=0.464, top_preds=[(83, 187559), (82, 123934), (78, 68424), (35, 56331), (80, 45657)], batch_label_top=[(82, 81668.0), (83, 55922.0), (79, 48795.0), (78, 46165.0), (36, 40828.0)], batch_pred_top=[(82, 93079.0), (78, 68301.0), (83, 56462.0), (35, 56203.0), (80, 44441.0)]
2025-11-09 09:24:17 [rank 0] finished validation on main rank
2025-11-09 09:24:17 [rank 0] epoch 12 val summary -> loss=0.8998, dice=0.0191, duration=2.74s
2025-11-09 09:24:17 [rank 0] epoch 12 val label dist top -> [(82, 1584556, 0.14381113912911525), (83, 1574683, 0.14291508535971753), (78, 733782, 0.06659658938683166), (79, 730461, 0.06629518205692488), (36, 469411, 0.04260280522098122)], pred dist top -> [(82, 1674063, 0.15193461575602507), (83, 1500378, 0.1361713119033115), (78, 750913, 0.06815136474625151), (79, 723014, 0.06561930720422511), (80, 550569, 0.04996854327595733)], dice top -> [(83, 0.9215), (18, 0.8714), (82, 0.8703), (47, 0.7519), (84, 0.7062)]
2025-11-09 09:24:17 [rank 0] scheduler stepped
2025-11-09 09:24:17 [rank 0] epoch 12 lr=4.955718e-05, remaining=89.81 min (avg train=1.94, avg val=0.06)
2025-11-09 09:24:17 [rank 0] metrics logged and best model check complete
2025-11-09 09:24:17 [rank 0] epoch loop completed
2025-11-09 09:24:17 [rank 0] before can_start_epoch decision
2025-11-09 09:24:17 [rank 0] after can_start_epoch decision -> True
2025-11-09 09:24:17 [rank 0] starting train_epoch
2025-11-09 09:24:39 [rank 0] step 0050: total=1.2339, seg=0.6558, domain=0.8243, align=0.0022, stats_align=0.0031, dom_acc=0.500, fg_frac=0.356, label_range=[-1,86], unique_labels=[-1, 0, 2, 8, 10, 12, 14, 16, 17, 18, 20, 21]..., domain_counts=d0=1, d1=1, grad_norm=4.791e+00, seg_grad=4.328e+00, tex_grad=8.129e-01, stats_grad=1.065e-01, enc_grad=1.883e-02, dom_grad=1.882e+00, pred_conf=0.663±0.274, pred_entropy=1.258, prob_range=[0.000,1.000], fg_match=0.856, top_preds=[(83, 429225), (82, 366821), (84, 146915), (16, 124612), (79, 121029)], dom_logits={'mean': 0.10394287109375, 'std': 0.42048710584640503, 'max': 0.6044921875, 'min': -0.320068359375, 'margin': 0.3930175006389618}
2025-11-09 09:24:50 [rank 0] step 0100: total=1.9823, seg=1.3868, domain=0.8494, align=0.0022, stats_align=0.0021, dom_acc=0.500, fg_frac=0.508, label_range=[-1,84], unique_labels=[-1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]..., domain_counts=d0=1, d1=1, grad_norm=4.969e+00, seg_grad=4.501e+00, tex_grad=8.115e-01, stats_grad=1.213e-01, enc_grad=1.103e-02, dom_grad=1.939e+00, pred_conf=0.677±0.293, pred_entropy=1.267, prob_range=[0.000,1.000], fg_match=0.651, top_preds=[(83, 369188), (82, 346793), (79, 196540), (36, 136986), (84, 121022)], dom_logits={'mean': 0.06494140625, 'std': 0.477367639541626, 'max': 0.63330078125, 'min': -0.407958984375, 'margin': 0.43943697214126587}
2025-11-09 09:24:59 [rank 0] step 0150: total=1.2163, seg=0.6718, domain=0.7775, align=0.0005, stats_align=0.0008, dom_acc=0.500, fg_frac=0.450, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 8, 9, 10, 11, 12, 13, 14]..., domain_counts=d0=1, d1=1, grad_norm=4.095e+00, seg_grad=3.714e+00, tex_grad=8.505e-01, stats_grad=1.658e-01, enc_grad=1.928e-02, dom_grad=1.492e+00, pred_conf=0.612±0.271, pred_entropy=1.429, prob_range=[0.000,1.000], fg_match=0.838, top_preds=[(82, 395110), (83, 363598), (84, 186338), (78, 127419), (35, 105037)], dom_logits={'mean': 0.10736083984375, 'std': 0.44064861536026, 'max': 0.6328125, 'min': -0.427734375, 'margin': 0.40428662300109863}
2025-11-09 09:25:09 [rank 0] step 0200: total=1.2588, seg=0.7421, domain=0.7371, align=0.0023, stats_align=0.0018, dom_acc=0.500, fg_frac=0.331, label_range=[-1,84], unique_labels=[-1, 4, 5, 7, 19, 20, 31, 32, 33, 35, 36, 37]..., domain_counts=d0=1, d1=1, grad_norm=4.941e+00, seg_grad=4.542e+00, tex_grad=9.215e-01, stats_grad=1.338e-01, enc_grad=1.562e-02, dom_grad=1.707e+00, pred_conf=0.582±0.284, pred_entropy=1.586, prob_range=[0.000,1.000], fg_match=0.837, top_preds=[(83, 452986), (82, 387618), (84, 134134), (78, 126481), (35, 114613)], dom_logits={'mean': 0.068756103515625, 'std': 0.40515705943107605, 'max': 0.52734375, 'min': -0.4521484375, 'margin': 0.3727174997329712}
2025-11-09 09:25:19 [rank 0] step 0250: total=2.0518, seg=1.4910, domain=0.7999, align=0.0024, stats_align=0.0020, dom_acc=0.500, fg_frac=0.267, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=1, d1=1, grad_norm=4.744e+00, seg_grad=4.329e+00, tex_grad=8.755e-01, stats_grad=1.516e-01, enc_grad=6.284e-02, dom_grad=1.723e+00, pred_conf=0.506±0.277, pred_entropy=1.932, prob_range=[0.000,1.000], fg_match=0.580, top_preds=[(83, 387826), (82, 366720), (79, 197510), (84, 124479), (18, 77681)], dom_logits={'mean': 0.12054443359375, 'std': 0.38014188408851624, 'max': 0.529296875, 'min': -0.300048828125, 'margin': 0.36086568236351013}
2025-11-09 09:25:29 [rank 0] step 0300: total=1.8373, seg=1.3215, domain=0.7351, align=0.0028, stats_align=0.0030, dom_acc=0.500, fg_frac=0.259, label_range=[-1,85], unique_labels=[-1, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]..., domain_counts=d0=1, d1=1, grad_norm=4.266e+00, seg_grad=3.779e+00, tex_grad=9.640e-01, stats_grad=1.552e-01, enc_grad=1.841e-02, dom_grad=1.721e+00, pred_conf=0.565±0.281, pred_entropy=1.695, prob_range=[0.000,1.000], fg_match=0.641, top_preds=[(83, 373888), (82, 306604), (84, 122590), (79, 104566), (18, 96652)], dom_logits={'mean': 0.190155029296875, 'std': 0.2674526572227478, 'max': 0.57666015625, 'min': -0.1622314453125, 'margin': 0.21971368789672852}
2025-11-09 09:25:39 [rank 0] step 0350: total=1.2432, seg=0.6971, domain=0.7781, align=0.0009, stats_align=0.0061, dom_acc=0.500, fg_frac=0.507, label_range=[-1,86], unique_labels=[-1, 6, 9, 10, 17, 19, 20, 21, 27, 28, 30, 31]..., domain_counts=d0=1, d1=1, grad_norm=2.281e+00, seg_grad=1.279e+00, tex_grad=7.445e-01, stats_grad=1.960e-01, enc_grad=1.716e-02, dom_grad=1.725e+00, pred_conf=0.644±0.289, pred_entropy=1.417, prob_range=[0.000,1.000], fg_match=0.870, top_preds=[(82, 261372), (79, 260235), (83, 258620), (78, 133706), (36, 128215)], dom_logits={'mean': 0.26561546325683594, 'std': 0.3274483382701874, 'max': 0.69677734375, 'min': -0.0950927734375, 'margin': 0.3050338923931122}
2025-11-09 09:25:49 [rank 0] step 0400: total=1.8778, seg=1.3449, domain=0.7603, align=0.0011, stats_align=0.0027, dom_acc=0.500, fg_frac=0.391, label_range=[-1,86], unique_labels=[-1, 2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 14]..., domain_counts=d0=1, d1=1, grad_norm=6.132e+00, seg_grad=5.923e+00, tex_grad=7.104e-01, stats_grad=9.959e-02, enc_grad=1.363e-02, dom_grad=1.415e+00, pred_conf=0.591±0.261, pred_entropy=1.512, prob_range=[0.000,1.000], fg_match=0.516, top_preds=[(83, 421372), (82, 382113), (79, 158234), (84, 123396), (18, 78657)], dom_logits={'mean': 0.249420166015625, 'std': 0.249634250998497, 'max': 0.54052734375, 'min': -0.1285400390625, 'margin': 0.2109553962945938}
2025-11-09 09:25:54 [rank 0] finished train_epoch
2025-11-09 09:25:54 [rank 0] epoch 13 train summary -> total=1.2977, seg=0.8675, domain=0.6142, align=0.0007, stats=0.0010, dom_acc=0.727, batches=426
2025-11-09 09:25:54 [rank 0] epoch 13 train label dist top -> [(82, 50855056, 0.14973572887505238), (83, 30775472, 0.0906141511552709), (78, 21772048, 0.0641048055552751), (79, 20643080, 0.06078071431139544), (35, 15735085, 0.04632979700948326)], pred dist top -> [(82, 53553852, 0.15768194591494897), (83, 33651104, 0.09908104389776337), (78, 22106256, 0.06508882802630175), (79, 21405282, 0.0630249065672854), (35, 16171867, 0.0476158364413777)], fg_fraction=0.451
2025-11-09 09:25:54 [rank 0] epoch 13 parameter stats -> seg_rms=2.2562e-02 (Δ2.45e-05), domain_rms=9.8612e-02 (Δ4.45e-05), texproj_rms=6.5477e-02 (Δ6.28e-05), statsproj_rms=1.3307e-01 (Δ-7.54e-05), encoder_rms=3.3725e-02 (Δ4.54e-07)
2025-11-09 09:25:54 [rank 0] checking should_stop
2025-11-09 09:25:54 [rank 0] should_stop -> False
2025-11-09 09:25:54 [rank 0] before can_run_validation decision
2025-11-09 09:25:54 [rank 0] after can_run_validation -> True
2025-11-09 09:25:54 [rank 0] starting validation on main rank
2025-11-09 09:25:56 [rank 0] val-step 001: loss=0.7014, fg_frac=0.780, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.630±0.221, pred_entropy=1.209, prob_range=[0.000,1.000], fg_match=0.685, top_preds=[(83, 160673), (82, 122642), (78, 61293), (80, 52069), (35, 51948)], batch_label_top=[(82, 81983.0), (78, 50461.0), (79, 48532.0), (83, 45983.0), (36, 37134.0)], batch_pred_top=[(82, 93336.0), (78, 61242.0), (83, 52943.0), (80, 52005.0), (35, 51945.0)]
2025-11-09 09:25:56 [rank 0] val-step 002: loss=0.7777, fg_frac=0.752, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.643±0.219, pred_entropy=1.154, prob_range=[0.000,1.000], fg_match=0.626, top_preds=[(83, 191979), (82, 121745), (78, 62695), (35, 55180), (79, 46155)], batch_label_top=[(82, 81668.0), (83, 55922.0), (79, 48795.0), (78, 46165.0), (36, 40828.0)], batch_pred_top=[(82, 94406.0), (78, 62688.0), (83, 60448.0), (35, 55159.0), (79, 45482.0)]
2025-11-09 09:25:57 [rank 0] finished validation on main rank
2025-11-09 09:25:57 [rank 0] epoch 13 val summary -> loss=0.8245, dice=0.0248, duration=2.73s
2025-11-09 09:25:57 [rank 0] epoch 13 val label dist top -> [(82, 1584556, 0.14381113912911525), (83, 1574683, 0.14291508535971753), (78, 733782, 0.06659658938683166), (79, 730461, 0.06629518205692488), (36, 469411, 0.04260280522098122)], pred dist top -> [(82, 1697898, 0.15409783277148079), (83, 1541686, 0.13992034351541324), (78, 852029, 0.07732845103678312), (79, 706211, 0.06409430046998124), (35, 557533, 0.050600582012925395)], dice top -> [(83, 0.9223), (82, 0.8605), (18, 0.8521), (47, 0.7284), (84, 0.7064)]
2025-11-09 09:25:57 [rank 0] scheduler stepped
2025-11-09 09:25:57 [rank 0] epoch 13 lr=4.948057e-05, remaining=88.15 min (avg train=1.94, avg val=0.06)
2025-11-09 09:25:57 [rank 0] metrics logged and best model check complete
2025-11-09 09:25:57 [rank 0] epoch loop completed
2025-11-09 09:25:57 [rank 0] before can_start_epoch decision
2025-11-09 09:25:57 [rank 0] after can_start_epoch decision -> True
2025-11-09 09:25:57 [rank 0] starting train_epoch
2025-11-09 09:26:18 [rank 0] step 0050: total=1.2747, seg=0.8551, domain=0.5994, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.297, label_range=[-1,85], unique_labels=[-1, 1, 3, 4, 5, 6, 7, 9, 11, 13, 15, 17]..., domain_counts=d0=2, grad_norm=8.776e+00, seg_grad=8.455e+00, tex_grad=8.473e-01, stats_grad=1.725e-01, enc_grad=3.860e-02, dom_grad=2.187e+00, pred_conf=0.593±0.256, pred_entropy=1.474, prob_range=[0.000,1.000], fg_match=0.575, top_preds=[(83, 477253), (82, 317473), (79, 194862), (84, 133940), (78, 90752)], dom_logits={'mean': 0.2431182861328125, 'std': 0.1160414069890976, 'max': 0.395751953125, 'min': 0.07928466796875, 'margin': 0.09984283149242401}
2025-11-09 09:26:28 [rank 0] step 0100: total=1.1770, seg=0.6517, domain=0.7502, align=0.0004, stats_align=0.0007, dom_acc=0.500, fg_frac=0.205, label_range=[-1,84], unique_labels=[-1, 3, 4, 5, 7, 9, 11, 13, 15, 19, 20, 31]..., domain_counts=d0=1, d1=1, grad_norm=2.910e+00, seg_grad=2.533e+00, tex_grad=6.830e-01, stats_grad=1.095e-01, enc_grad=1.874e-02, dom_grad=1.254e+00, pred_conf=0.513±0.288, pred_entropy=1.890, prob_range=[0.000,1.000], fg_match=0.934, top_preds=[(83, 449553), (82, 395151), (79, 128940), (84, 118478), (78, 113417)], dom_logits={'mean': 0.33405303955078125, 'std': 0.2948177754878998, 'max': 0.671875, 'min': -0.037322998046875, 'margin': 0.2786610722541809}
2025-11-09 09:26:38 [rank 0] step 0150: total=0.8681, seg=0.6141, domain=0.3628, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.608, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 8, 9, 10, 11]..., domain_counts=d0=2, grad_norm=2.625e+00, seg_grad=1.646e+00, tex_grad=6.393e-01, stats_grad=1.420e-01, enc_grad=1.982e-02, dom_grad=1.937e+00, pred_conf=0.690±0.249, pred_entropy=1.232, prob_range=[0.000,1.000], fg_match=0.869, top_preds=[(83, 393330), (82, 307625), (17, 122564), (18, 87846), (21, 72709)], dom_logits={'mean': 0.34140777587890625, 'std': 0.41400381922721863, 'max': 0.76318359375, 'min': -0.09246826171875, 'margin': 0.3916139006614685}
2025-11-09 09:26:48 [rank 0] step 0200: total=1.6239, seg=1.4208, domain=0.2900, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.181, label_range=[-1,83], unique_labels=[-1, 9, 19, 20, 26, 30, 31, 32, 33, 34, 35, 36]..., domain_counts=d0=2, grad_norm=4.668e+00, seg_grad=4.357e+00, tex_grad=5.109e-01, stats_grad=8.881e-02, enc_grad=1.583e-02, dom_grad=1.595e+00, pred_conf=0.446±0.264, pred_entropy=2.127, prob_range=[0.000,1.000], fg_match=0.243, top_preds=[(83, 410023), (82, 342090), (79, 127749), (84, 111159), (22, 106546)], dom_logits={'mean': 0.249053955078125, 'std': 0.5491243004798889, 'max': 0.833984375, 'min': -0.380615234375, 'margin': 0.49667829275131226}
2025-11-09 09:26:58 [rank 0] step 0250: total=1.0881, seg=0.8561, domain=0.3314, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.940, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=2, grad_norm=2.460e+00, seg_grad=1.589e+00, tex_grad=6.723e-01, stats_grad=2.264e-01, enc_grad=2.648e-02, dom_grad=1.738e+00, pred_conf=0.880±0.162, pred_entropy=0.453, prob_range=[0.000,1.000], fg_match=0.813, top_preds=[(82, 196718), (79, 166398), (78, 134117), (83, 92873), (36, 88721)], dom_logits={'mean': 0.184967041015625, 'std': 0.4690963327884674, 'max': 0.68701171875, 'min': -0.316650390625, 'margin': 0.4360652565956116}
2025-11-09 09:27:08 [rank 0] step 0300: total=1.7285, seg=1.1322, domain=0.8516, align=0.0002, stats_align=0.0006, dom_acc=0.500, fg_frac=0.101, label_range=[-1,85], unique_labels=[-1, 1, 3, 5, 7, 9, 11, 13, 15, 18, 19, 20]..., domain_counts=d0=1, d1=1, grad_norm=6.952e+00, seg_grad=6.640e+00, tex_grad=7.303e-01, stats_grad=8.293e-02, enc_grad=1.186e-02, dom_grad=1.925e+00, pred_conf=0.537±0.281, pred_entropy=1.808, prob_range=[0.000,1.000], fg_match=0.632, top_preds=[(83, 552148), (82, 364259), (79, 207183), (84, 101983), (18, 74682)], dom_logits={'mean': 0.2408447265625, 'std': 0.4694429337978363, 'max': 0.8115234375, 'min': -0.22265625, 'margin': 0.43172627687454224}
2025-11-09 09:27:18 [rank 0] step 0350: total=1.4093, seg=0.7659, domain=0.9181, align=0.0009, stats_align=0.0027, dom_acc=0.500, fg_frac=0.270, label_range=[-1,84], unique_labels=[-1, 4, 6, 20, 31, 32, 33, 34, 35, 36, 37, 38]..., domain_counts=d0=1, d1=1, grad_norm=3.767e+00, seg_grad=3.187e+00, tex_grad=7.716e-01, stats_grad=1.054e-01, enc_grad=1.590e-02, dom_grad=1.852e+00, pred_conf=0.562±0.267, pred_entropy=1.637, prob_range=[0.000,1.000], fg_match=0.831, top_preds=[(83, 438253), (82, 360900), (79, 169275), (84, 104317), (38, 79999)], dom_logits={'mean': 0.17645263671875, 'std': 0.4271376430988312, 'max': 0.71826171875, 'min': -0.365234375, 'margin': 0.3776693046092987}
2025-11-09 09:27:28 [rank 0] step 0400: total=0.7572, seg=0.4979, domain=0.3704, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.678, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 7, 8, 9, 11, 13]..., domain_counts=d0=2, grad_norm=2.382e+00, seg_grad=1.100e+00, tex_grad=6.437e-01, stats_grad=1.340e-01, enc_grad=1.784e-02, dom_grad=2.008e+00, pred_conf=0.777±0.220, pred_entropy=0.810, prob_range=[0.000,1.000], fg_match=0.895, top_preds=[(83, 362850), (82, 261276), (78, 194777), (35, 130168), (84, 62356)], dom_logits={'mean': 0.3312225341796875, 'std': 0.40361449122428894, 'max': 0.78466796875, 'min': -0.10400390625, 'margin': 0.38094764947891235}
2025-11-09 09:27:33 [rank 0] finished train_epoch
2025-11-09 09:27:33 [rank 0] epoch 14 train summary -> total=1.2848, seg=0.8492, domain=0.6218, align=0.0005, stats=0.0012, dom_acc=0.727, batches=426
2025-11-09 09:27:33 [rank 0] epoch 14 train label dist top -> [(82, 52386832, 0.1503896934796625), (83, 32152062, 0.0923006519829087), (78, 21514896, 0.06176396798887966), (79, 19107892, 0.05485405227257291), (35, 15229612, 0.04372046548823929)], pred dist top -> [(82, 55073072, 0.1581012247157723), (83, 35126940, 0.10084079265666258), (78, 21832714, 0.06267634429888326), (79, 20034760, 0.057514861217230914), (35, 15947047, 0.04578004403495019)], fg_fraction=0.463
2025-11-09 09:27:33 [rank 0] epoch 14 parameter stats -> seg_rms=2.2580e-02 (Δ1.77e-05), domain_rms=9.8533e-02 (Δ-7.93e-05), texproj_rms=6.5636e-02 (Δ1.59e-04), statsproj_rms=1.3332e-01 (Δ2.55e-04), encoder_rms=3.3839e-02 (Δ1.14e-04)
2025-11-09 09:27:33 [rank 0] checking should_stop
2025-11-09 09:27:33 [rank 0] should_stop -> False
2025-11-09 09:27:33 [rank 0] before can_run_validation decision
2025-11-09 09:27:33 [rank 0] after can_run_validation -> True
2025-11-09 09:27:33 [rank 0] starting validation on main rank
2025-11-09 09:27:35 [rank 0] val-step 001: loss=0.6184, fg_frac=0.780, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.692±0.225, pred_entropy=0.984, prob_range=[0.000,1.000], fg_match=0.735, top_preds=[(83, 155373), (82, 128274), (79, 55849), (81, 45848), (36, 45506)], batch_label_top=[(82, 81983.0), (78, 50461.0), (79, 48532.0), (83, 45983.0), (36, 37134.0)], batch_pred_top=[(82, 97365.0), (79, 55230.0), (83, 48785.0), (36, 45491.0), (81, 44138.0)]
2025-11-09 09:27:35 [rank 0] val-step 002: loss=0.5881, fg_frac=0.752, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.693±0.219, pred_entropy=0.972, prob_range=[0.000,1.000], fg_match=0.771, top_preds=[(83, 185529), (82, 131799), (79, 65766), (36, 40682), (78, 33855)], batch_label_top=[(82, 81668.0), (83, 55922.0), (79, 48795.0), (78, 46165.0), (36, 40828.0)], batch_pred_top=[(82, 94682.0), (79, 64777.0), (83, 56885.0), (36, 40123.0), (78, 33170.0)]
2025-11-09 09:27:35 [rank 0] finished validation on main rank
2025-11-09 09:27:35 [rank 0] epoch 14 val summary -> loss=0.7426, dice=0.0268, duration=2.76s
2025-11-09 09:27:35 [rank 0] epoch 14 val label dist top -> [(82, 1584556, 0.14381113912911525), (83, 1574683, 0.14291508535971753), (78, 733782, 0.06659658938683166), (79, 730461, 0.06629518205692488), (36, 469411, 0.04260280522098122)], pred dist top -> [(82, 1723836, 0.1564519138684764), (83, 1537087, 0.13950294745692443), (79, 985379, 0.08943103081488345), (36, 561172, 0.050930850387972314), (81, 486799, 0.044180905387322486)], dice top -> [(83, 0.9283), (18, 0.8833), (82, 0.8659), (16, 0.7803), (17, 0.7397)]
2025-11-09 09:27:35 [rank 0] scheduler stepped
2025-11-09 09:27:35 [rank 0] epoch 14 lr=4.939792e-05, remaining=86.50 min (avg train=1.93, avg val=0.06)
2025-11-09 09:27:35 [rank 0] metrics logged and best model check complete
2025-11-09 09:27:35 [rank 0] epoch loop completed
2025-11-09 09:27:35 [rank 0] before can_start_epoch decision
2025-11-09 09:27:35 [rank 0] after can_start_epoch decision -> True
2025-11-09 09:27:35 [rank 0] starting train_epoch
2025-11-09 09:27:58 [rank 0] step 0050: total=1.4478, seg=0.6067, domain=1.2017, align=0.0000, stats_align=0.0000, dom_acc=0.000, fg_frac=0.315, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=0, d1=2, grad_norm=4.940e+00, seg_grad=1.761e+00, tex_grad=1.231e+00, stats_grad=1.951e-01, enc_grad=2.695e-02, dom_grad=4.444e+00, pred_conf=0.587±0.264, pred_entropy=1.519, prob_range=[0.000,1.000], fg_match=0.869, top_preds=[(83, 468450), (82, 403253), (84, 168270), (79, 138920), (35, 97561)], dom_logits={'mean': 0.281951904296875, 'std': 0.42253851890563965, 'max': 0.7255859375, 'min': -0.1541748046875, 'margin': 0.3987351357936859}
2025-11-09 09:28:08 [rank 0] step 0100: total=0.9561, seg=0.6415, domain=0.4493, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.695, label_range=[-1,86], unique_labels=[-1, 10, 20, 21, 22, 28, 30, 31, 32, 33, 34, 35]..., domain_counts=d0=2, grad_norm=3.249e+00, seg_grad=2.419e+00, tex_grad=6.023e-01, stats_grad=1.249e-01, enc_grad=1.897e-02, dom_grad=2.080e+00, pred_conf=0.747±0.234, pred_entropy=0.830, prob_range=[0.000,1.000], fg_match=0.786, top_preds=[(82, 266358), (83, 265536), (81, 156136), (38, 146680), (79, 128790)], dom_logits={'mean': 0.257659912109375, 'std': 0.30695778131484985, 'max': 0.6611328125, 'min': -0.11895751953125, 'margin': 0.27938246726989746}
2025-11-09 09:28:18 [rank 0] step 0150: total=2.2963, seg=1.4603, domain=1.1943, align=0.0000, stats_align=0.0000, dom_acc=0.000, fg_frac=0.330, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=0, d1=2, grad_norm=6.156e+00, seg_grad=3.637e+00, tex_grad=1.351e+00, stats_grad=1.584e-01, enc_grad=2.778e-02, dom_grad=4.777e+00, pred_conf=0.572±0.266, pred_entropy=1.635, prob_range=[0.000,1.000], fg_match=0.351, top_preds=[(83, 541134), (82, 391822), (79, 187413), (36, 88917), (84, 84553)], dom_logits={'mean': 0.3907461166381836, 'std': 0.4172910153865814, 'max': 0.82470703125, 'min': -0.054290771484375, 'margin': 0.39407479763031006}
2025-11-09 09:28:28 [rank 0] step 0200: total=1.1428, seg=0.8523, domain=0.4149, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.520, label_range=[-1,85], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=2, grad_norm=2.889e+00, seg_grad=2.282e+00, tex_grad=6.453e-01, stats_grad=8.906e-02, enc_grad=1.287e-02, dom_grad=1.647e+00, pred_conf=0.717±0.247, pred_entropy=1.094, prob_range=[0.000,1.000], fg_match=0.803, top_preds=[(83, 424957), (82, 284779), (78, 200692), (35, 98421), (79, 83202)], dom_logits={'mean': 0.280059814453125, 'std': 0.3377685844898224, 'max': 0.65087890625, 'min': -0.12548828125, 'margin': 0.32088765501976013}
2025-11-09 09:28:38 [rank 0] step 0250: total=1.5229, seg=1.2385, domain=0.4062, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.137, label_range=[-1,83], unique_labels=[-1, 5, 7, 9, 13, 15, 16, 17, 18, 19, 20, 25]..., domain_counts=d0=2, grad_norm=4.496e+00, seg_grad=4.091e+00, tex_grad=6.001e-01, stats_grad=1.192e-01, enc_grad=1.347e-02, dom_grad=1.762e+00, pred_conf=0.496±0.294, pred_entropy=2.012, prob_range=[0.000,1.000], fg_match=0.443, top_preds=[(82, 353543), (83, 331177), (84, 183802), (79, 168504), (65, 93545)], dom_logits={'mean': 0.217041015625, 'std': 0.3681723475456238, 'max': 0.7021484375, 'min': -0.206787109375, 'margin': 0.33541375398635864}
2025-11-09 09:28:48 [rank 0] step 0300: total=0.8725, seg=0.6313, domain=0.3445, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.389, label_range=[-1,83], unique_labels=[-1, 0, 2, 4, 5, 6, 8, 9, 12, 14, 16, 17]..., domain_counts=d0=2, grad_norm=2.184e+00, seg_grad=1.271e+00, tex_grad=5.635e-01, stats_grad=1.220e-01, enc_grad=1.672e-02, dom_grad=1.679e+00, pred_conf=0.634±0.272, pred_entropy=1.404, prob_range=[0.000,1.000], fg_match=0.932, top_preds=[(83, 408980), (82, 316817), (79, 199542), (84, 164391), (36, 117237)], dom_logits={'mean': 0.188140869140625, 'std': 0.44484227895736694, 'max': 0.6328125, 'min': -0.283447265625, 'margin': 0.41724294424057007}
2025-11-09 09:28:58 [rank 0] step 0350: total=1.2476, seg=0.6710, domain=0.8218, align=0.0016, stats_align=0.0048, dom_acc=0.500, fg_frac=0.502, label_range=[-1,86], unique_labels=[-1, 0, 1, 3, 5, 7, 8, 9, 11, 13, 15, 16]..., domain_counts=d0=1, d1=1, grad_norm=2.767e+00, seg_grad=1.891e+00, tex_grad=8.799e-01, stats_grad=1.002e-01, enc_grad=1.453e-02, dom_grad=1.815e+00, pred_conf=0.631±0.286, pred_entropy=1.429, prob_range=[0.000,1.000], fg_match=0.848, top_preds=[(83, 379456), (82, 317508), (78, 176525), (35, 136916), (84, 118200)], dom_logits={'mean': 0.22119140625, 'std': 0.47065818309783936, 'max': 0.73291015625, 'min': -0.3388671875, 'margin': 0.4336199164390564}
2025-11-09 09:29:08 [rank 0] step 0400: total=1.3453, seg=1.0764, domain=0.3840, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.292, label_range=[-1,83], unique_labels=[-1, 9, 19, 20, 22, 24, 25, 26, 27, 28, 29, 30]..., domain_counts=d0=2, grad_norm=5.120e+00, seg_grad=4.652e+00, tex_grad=7.683e-01, stats_grad=2.194e-01, enc_grad=2.308e-02, dom_grad=1.984e+00, pred_conf=0.528±0.255, pred_entropy=1.784, prob_range=[0.000,1.000], fg_match=0.707, top_preds=[(82, 360777), (83, 344317), (79, 225337), (84, 124308), (36, 91712)], dom_logits={'mean': 0.2978668212890625, 'std': 0.3855730891227722, 'max': 0.751953125, 'min': -0.1439208984375, 'margin': 0.36215633153915405}
2025-11-09 09:29:13 [rank 0] finished train_epoch
2025-11-09 09:29:13 [rank 0] epoch 15 train summary -> total=1.2762, seg=0.8495, domain=0.6091, align=0.0004, stats=0.0011, dom_acc=0.728, batches=426
2025-11-09 09:29:13 [rank 0] epoch 15 train label dist top -> [(82, 52433924, 0.14817080399068744), (83, 31575896, 0.08922898650587989), (78, 22416696, 0.06334639133883681), (79, 22207592, 0.0627554932058329), (36, 15527653, 0.043878936642209154)], pred dist top -> [(82, 55380480, 0.15649735306011434), (83, 34849272, 0.09847908187274572), (79, 23459828, 0.06629413441785907), (78, 22494434, 0.06356606839784415), (36, 16705957, 0.04720865638643956)], fg_fraction=0.470
2025-11-09 09:29:13 [rank 0] epoch 15 parameter stats -> seg_rms=2.2600e-02 (Δ1.95e-05), domain_rms=9.8519e-02 (Δ-1.34e-05), texproj_rms=6.5695e-02 (Δ5.85e-05), statsproj_rms=1.3343e-01 (Δ1.14e-04), encoder_rms=3.3842e-02 (Δ2.96e-06)
2025-11-09 09:29:13 [rank 0] checking should_stop
2025-11-09 09:29:13 [rank 0] should_stop -> False
2025-11-09 09:29:13 [rank 0] before can_run_validation decision
2025-11-09 09:29:13 [rank 0] after can_run_validation -> True
2025-11-09 09:29:13 [rank 0] starting validation on main rank
2025-11-09 09:29:14 [rank 0] val-step 001: loss=0.6975, fg_frac=0.780, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.652±0.216, pred_entropy=1.118, prob_range=[0.000,1.000], fg_match=0.670, top_preds=[(83, 149544), (82, 119711), (79, 68172), (36, 51755), (81, 38903)], batch_label_top=[(82, 81983.0), (78, 50461.0), (79, 48532.0), (83, 45983.0), (36, 37134.0)], batch_pred_top=[(82, 89333.0), (79, 66400.0), (83, 52199.0), (36, 51739.0), (38, 33599.0)]
2025-11-09 09:29:15 [rank 0] val-step 002: loss=0.4948, fg_frac=0.752, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.706±0.207, pred_entropy=1.024, prob_range=[0.000,1.000], fg_match=0.844, top_preds=[(83, 178510), (82, 119598), (79, 55147), (78, 48355), (84, 38411)], batch_label_top=[(82, 81668.0), (83, 55922.0), (79, 48795.0), (78, 46165.0), (36, 40828.0)], batch_pred_top=[(82, 84101.0), (83, 61218.0), (79, 53515.0), (78, 47761.0), (36, 34209.0)]
2025-11-09 09:29:15 [rank 0] finished validation on main rank
2025-11-09 09:29:15 [rank 0] epoch 15 val summary -> loss=0.7423, dice=0.0269, duration=2.76s
2025-11-09 09:29:15 [rank 0] epoch 15 val label dist top -> [(82, 1584556, 0.14381113912911525), (83, 1574683, 0.14291508535971753), (78, 733782, 0.06659658938683166), (79, 730461, 0.06629518205692488), (36, 469411, 0.04260280522098122)], pred dist top -> [(82, 1629682, 0.14790668479890567), (83, 1556815, 0.14129342135165532), (79, 911349, 0.08271221580946338), (78, 591018, 0.0536396137629793), (36, 527520, 0.04787666205131966)], dice top -> [(83, 0.9188), (18, 0.8767), (82, 0.8696), (47, 0.7496), (16, 0.7245)]
2025-11-09 09:29:15 [rank 0] scheduler stepped
2025-11-09 09:29:15 [rank 0] epoch 15 lr=4.930925e-05, remaining=84.84 min (avg train=1.94, avg val=0.05)
2025-11-09 09:29:15 [rank 0] metrics logged and best model check complete
2025-11-09 09:29:15 [rank 0] epoch loop completed
2025-11-09 09:29:15 [rank 0] before can_start_epoch decision
2025-11-09 09:29:15 [rank 0] after can_start_epoch decision -> True
2025-11-09 09:29:15 [rank 0] starting train_epoch
2025-11-09 09:29:38 [rank 0] step 0050: total=0.9483, seg=0.6592, domain=0.4131, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.435, label_range=[-1,86], unique_labels=[-1, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]..., domain_counts=d0=2, grad_norm=2.644e+00, seg_grad=1.459e+00, tex_grad=7.671e-01, stats_grad=3.433e-01, enc_grad=4.031e-02, dom_grad=2.039e+00, pred_conf=0.627±0.281, pred_entropy=1.449, prob_range=[0.000,1.000], fg_match=0.875, top_preds=[(83, 345532), (82, 308159), (35, 110590), (78, 107464), (84, 95297)], dom_logits={'mean': 0.1768646240234375, 'std': 0.3520977795124054, 'max': 0.63525390625, 'min': -0.2467041015625, 'margin': 0.3233345150947571}
2025-11-09 09:29:48 [rank 0] step 0100: total=0.8082, seg=0.5260, domain=0.4031, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.654, label_range=[-1,86], unique_labels=[-1, 0, 2, 5, 7, 8, 9, 10, 12, 14, 16, 17]..., domain_counts=d0=2, grad_norm=2.205e+00, seg_grad=8.377e-01, tex_grad=6.322e-01, stats_grad=1.266e-01, enc_grad=1.576e-02, dom_grad=1.935e+00, pred_conf=0.782±0.235, pred_entropy=0.809, prob_range=[0.000,1.000], fg_match=0.932, top_preds=[(83, 283491), (82, 274102), (78, 169650), (35, 145896), (84, 93382)], dom_logits={'mean': 0.118865966796875, 'std': 0.3547184467315674, 'max': 0.4873046875, 'min': -0.3046875, 'margin': 0.3368035554885864}
2025-11-09 09:29:58 [rank 0] step 0150: total=1.4741, seg=0.9233, domain=0.7844, align=0.0038, stats_align=0.0045, dom_acc=0.500, fg_frac=0.872, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=1, d1=1, grad_norm=3.354e+00, seg_grad=2.539e+00, tex_grad=9.171e-01, stats_grad=1.060e-01, enc_grad=1.652e-02, dom_grad=1.987e+00, pred_conf=0.848±0.185, pred_entropy=0.587, prob_range=[0.000,1.000], fg_match=0.772, top_preds=[(82, 254337), (83, 246487), (16, 118893), (17, 92309), (81, 72876)], dom_logits={'mean': 0.09234619140625, 'std': 0.48212024569511414, 'max': 0.587890625, 'min': -0.416748046875, 'margin': 0.44739359617233276}
2025-11-09 09:30:08 [rank 0] step 0200: total=0.9827, seg=0.7482, domain=0.3350, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.506, label_range=[-1,84], unique_labels=[-1, 4, 6, 10, 20, 21, 22, 29, 30, 31, 32, 33]..., domain_counts=d0=2, grad_norm=6.477e+00, seg_grad=6.196e+00, tex_grad=5.495e-01, stats_grad=9.590e-02, enc_grad=1.661e-02, dom_grad=1.800e+00, pred_conf=0.631±0.242, pred_entropy=1.337, prob_range=[0.000,1.000], fg_match=0.860, top_preds=[(83, 344749), (82, 288211), (79, 164342), (84, 113460), (36, 88454)], dom_logits={'mean': 0.133880615234375, 'std': 0.47535309195518494, 'max': 0.6572265625, 'min': -0.4736328125, 'margin': 0.43114548921585083}
2025-11-09 09:30:18 [rank 0] step 0250: total=1.4863, seg=0.9281, domain=0.7970, align=0.0004, stats_align=0.0011, dom_acc=0.500, fg_frac=0.085, label_range=[-1,83], unique_labels=[-1, 19, 20, 31, 32, 35, 36, 39, 40, 45, 47, 48]..., domain_counts=d0=1, d1=1, grad_norm=9.036e+00, seg_grad=8.905e+00, tex_grad=6.092e-01, stats_grad=8.594e-02, enc_grad=2.914e-02, dom_grad=1.404e+00, pred_conf=0.399±0.258, pred_entropy=2.383, prob_range=[0.000,1.000], fg_match=0.666, top_preds=[(83, 506764), (82, 363166), (79, 169060), (84, 139043), (36, 111304)], dom_logits={'mean': 0.1897430419921875, 'std': 0.3481336534023285, 'max': 0.541015625, 'min': -0.25390625, 'margin': 0.32710957527160645}
2025-11-09 09:30:28 [rank 0] step 0300: total=1.2668, seg=0.7578, domain=0.7249, align=0.0032, stats_align=0.0049, dom_acc=0.500, fg_frac=0.278, label_range=[-1,84], unique_labels=[-1, 1, 3, 5, 7, 9, 11, 13, 15, 16, 17, 18]..., domain_counts=d0=1, d1=1, grad_norm=4.599e+00, seg_grad=4.210e+00, tex_grad=8.283e-01, stats_grad=1.156e-01, enc_grad=1.802e-02, dom_grad=1.651e+00, pred_conf=0.590±0.281, pred_entropy=1.571, prob_range=[0.000,1.000], fg_match=0.719, top_preds=[(83, 467136), (82, 319305), (79, 170343), (84, 123045), (17, 99331)], dom_logits={'mean': 0.1327667236328125, 'std': 0.2964034080505371, 'max': 0.48193359375, 'min': -0.1949462890625, 'margin': 0.28454041481018066}
2025-11-09 09:30:38 [rank 0] step 0350: total=0.9727, seg=0.6737, domain=0.4271, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.451, label_range=[-1,85], unique_labels=[-1, 1, 7, 9, 11, 13, 15, 16, 17, 18, 19, 21]..., domain_counts=d0=2, grad_norm=3.128e+00, seg_grad=2.334e+00, tex_grad=7.105e-01, stats_grad=1.422e-01, enc_grad=2.015e-02, dom_grad=1.952e+00, pred_conf=0.640±0.263, pred_entropy=1.319, prob_range=[0.000,1.000], fg_match=0.901, top_preds=[(83, 306052), (82, 281793), (84, 188553), (17, 130772), (78, 124877)], dom_logits={'mean': 0.1804351806640625, 'std': 0.3167656362056732, 'max': 0.5263671875, 'min': -0.1749267578125, 'margin': 0.3046843707561493}
2025-11-09 09:30:47 [rank 0] step 0400: total=1.0779, seg=0.8021, domain=0.3940, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.225, label_range=[-1,83], unique_labels=[-1, 5, 13, 15, 16, 17, 18, 21, 22, 30, 34, 38]..., domain_counts=d0=2, grad_norm=5.647e+00, seg_grad=5.316e+00, tex_grad=5.802e-01, stats_grad=1.084e-01, enc_grad=1.991e-02, dom_grad=1.812e+00, pred_conf=0.531±0.274, pred_entropy=1.808, prob_range=[0.000,1.000], fg_match=0.736, top_preds=[(82, 381581), (83, 321883), (84, 171233), (79, 119643), (17, 106072)], dom_logits={'mean': 0.129547119140625, 'std': 0.36570775508880615, 'max': 0.5068359375, 'min': -0.279296875, 'margin': 0.34885579347610474}
2025-11-09 09:30:52 [rank 0] finished train_epoch
2025-11-09 09:30:52 [rank 0] epoch 16 train summary -> total=1.2852, seg=0.8395, domain=0.6361, align=0.0008, stats=0.0011, dom_acc=0.727, batches=426
2025-11-09 09:30:52 [rank 0] epoch 16 train label dist top -> [(82, 51525880, 0.14829266156487994), (83, 30797236, 0.08863514985637774), (78, 21307598, 0.06132375456711292), (79, 21275128, 0.06123030516419129), (35, 15508056, 0.04463253999615738)], pred dist top -> [(82, 54056140, 0.15557481355857697), (83, 33833392, 0.09737327993553091), (79, 22376448, 0.06439993173214352), (78, 21422416, 0.061654205704925955), (36, 16534231, 0.04758589690568812)], fg_fraction=0.461
2025-11-09 09:30:52 [rank 0] epoch 16 parameter stats -> seg_rms=2.2621e-02 (Δ2.18e-05), domain_rms=9.8484e-02 (Δ-3.57e-05), texproj_rms=6.5804e-02 (Δ1.09e-04), statsproj_rms=1.3374e-01 (Δ3.06e-04), encoder_rms=3.3805e-02 (Δ-3.64e-05)
2025-11-09 09:30:52 [rank 0] checking should_stop
2025-11-09 09:30:52 [rank 0] should_stop -> False
2025-11-09 09:30:52 [rank 0] before can_run_validation decision
2025-11-09 09:30:52 [rank 0] after can_run_validation -> True
2025-11-09 09:30:52 [rank 0] starting validation on main rank
2025-11-09 09:30:54 [rank 0] val-step 001: loss=1.2080, fg_frac=0.780, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.736±0.209, pred_entropy=0.895, prob_range=[0.000,1.000], fg_match=0.253, top_preds=[(83, 155680), (82, 118247), (79, 56127), (78, 45129), (35, 36697)], batch_label_top=[(82, 81983.0), (78, 50461.0), (79, 48532.0), (83, 45983.0), (36, 37134.0)], batch_pred_top=[(82, 92392.0), (83, 49642.0), (79, 48861.0), (78, 44050.0), (35, 36695.0)]
2025-11-09 09:30:54 [rank 0] val-step 002: loss=0.7669, fg_frac=0.752, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.691±0.215, pred_entropy=0.938, prob_range=[0.000,1.000], fg_match=0.545, top_preds=[(83, 187915), (82, 119851), (79, 77317), (36, 39161), (17, 32748)], batch_label_top=[(82, 81668.0), (83, 55922.0), (79, 48795.0), (78, 46165.0), (36, 40828.0)], batch_pred_top=[(82, 94117.0), (79, 68609.0), (83, 57828.0), (36, 38713.0), (17, 31910.0)]
2025-11-09 09:30:55 [rank 0] finished validation on main rank
2025-11-09 09:30:55 [rank 0] epoch 16 val summary -> loss=0.9781, dice=0.0174, duration=2.75s
2025-11-09 09:30:55 [rank 0] epoch 16 val label dist top -> [(82, 1584556, 0.14381113912911525), (83, 1574683, 0.14291508535971753), (78, 733782, 0.06659658938683166), (79, 730461, 0.06629518205692488), (36, 469411, 0.04260280522098122)], pred dist top -> [(82, 1726669, 0.15670903129263358), (83, 1485324, 0.13480504091733833), (79, 752823, 0.06832471253309945), (78, 667019, 0.060537312793466004), (35, 456199, 0.041403710477612175)], dice top -> [(83, 0.9172), (82, 0.8661), (18, 0.862), (47, 0.7459), (84, 0.7042)]
2025-11-09 09:30:55 [rank 0] scheduler stepped
2025-11-09 09:30:55 [rank 0] epoch 16 lr=4.921458e-05, remaining=83.18 min (avg train=1.93, avg val=0.05)
2025-11-09 09:30:55 [rank 0] metrics logged and best model check complete
2025-11-09 09:30:55 [rank 0] epoch loop completed
2025-11-09 09:30:55 [rank 0] before can_start_epoch decision
2025-11-09 09:30:55 [rank 0] after can_start_epoch decision -> True
2025-11-09 09:30:55 [rank 0] starting train_epoch
2025-11-09 09:31:18 [rank 0] step 0050: total=1.3829, seg=0.9136, domain=0.6678, align=0.0042, stats_align=0.0048, dom_acc=0.500, fg_frac=0.525, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=1, d1=1, grad_norm=2.230e+00, seg_grad=1.421e+00, tex_grad=7.689e-01, stats_grad=1.271e-01, enc_grad=1.670e-02, dom_grad=1.532e+00, pred_conf=0.686±0.255, pred_entropy=1.163, prob_range=[0.000,1.000], fg_match=0.759, top_preds=[(83, 448802), (82, 370039), (79, 92479), (78, 85019), (84, 67191)], dom_logits={'mean': 0.2315521240234375, 'std': 0.3065485954284668, 'max': 0.533203125, 'min': -0.1907958984375, 'margin': 0.28305476903915405}
2025-11-09 09:31:28 [rank 0] step 0100: total=1.0150, seg=0.6708, domain=0.4917, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.416, label_range=[-1,86], unique_labels=[-1, 0, 1, 3, 5, 7, 8, 9, 10, 11, 12, 13]..., domain_counts=d0=2, grad_norm=3.279e+00, seg_grad=2.483e+00, tex_grad=6.921e-01, stats_grad=2.259e-01, enc_grad=2.220e-02, dom_grad=2.014e+00, pred_conf=0.650±0.273, pred_entropy=1.277, prob_range=[0.000,1.000], fg_match=0.851, top_preds=[(82, 365889), (83, 328683), (84, 142979), (78, 128231), (35, 104534)], dom_logits={'mean': 0.1372509002685547, 'std': 0.2408994883298874, 'max': 0.411376953125, 'min': -0.1925048828125, 'margin': 0.22336997091770172}
2025-11-09 09:31:37 [rank 0] step 0150: total=1.3371, seg=0.9639, domain=0.5332, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.684, label_range=[-1,86], unique_labels=[-1, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]..., domain_counts=d0=2, grad_norm=3.017e+00, seg_grad=2.001e+00, tex_grad=6.520e-01, stats_grad=1.385e-01, enc_grad=1.868e-02, dom_grad=2.157e+00, pred_conf=0.731±0.229, pred_entropy=0.964, prob_range=[0.000,1.000], fg_match=0.784, top_preds=[(83, 287268), (78, 258105), (82, 222429), (35, 121052), (84, 86197)], dom_logits={'mean': 0.18450927734375, 'std': 0.1915540099143982, 'max': 0.444091796875, 'min': -0.0604248046875, 'margin': 0.17345109581947327}
2025-11-09 09:31:47 [rank 0] step 0200: total=0.9848, seg=0.6845, domain=0.4290, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.553, label_range=[-1,84], unique_labels=[-1, 10, 11, 19, 20, 21, 22, 27, 29, 30, 31, 32]..., domain_counts=d0=2, grad_norm=2.502e+00, seg_grad=1.588e+00, tex_grad=5.974e-01, stats_grad=2.409e-01, enc_grad=2.186e-02, dom_grad=1.823e+00, pred_conf=0.672±0.244, pred_entropy=1.210, prob_range=[0.000,1.000], fg_match=0.857, top_preds=[(83, 310372), (82, 273635), (84, 144338), (80, 124387), (37, 112827)], dom_logits={'mean': 0.0234375, 'std': 0.3202202022075653, 'max': 0.384765625, 'min': -0.375, 'margin': 0.30261504650115967}
2025-11-09 09:31:57 [rank 0] step 0250: total=0.8708, seg=0.5982, domain=0.3894, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.600, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11]..., domain_counts=d0=2, grad_norm=3.431e+00, seg_grad=2.858e+00, tex_grad=5.702e-01, stats_grad=9.991e-02, enc_grad=1.173e-02, dom_grad=1.809e+00, pred_conf=0.703±0.244, pred_entropy=1.132, prob_range=[0.000,1.000], fg_match=0.898, top_preds=[(83, 408128), (82, 311938), (79, 160495), (78, 134995), (36, 100094)], dom_logits={'mean': 0.08935546875, 'std': 0.373121052980423, 'max': 0.499267578125, 'min': -0.307861328125, 'margin': 0.3551662862300873}
2025-11-09 09:32:07 [rank 0] step 0300: total=1.6034, seg=0.7329, domain=1.2437, align=0.0000, stats_align=0.0000, dom_acc=0.000, fg_frac=0.363, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=0, d1=2, grad_norm=6.939e+00, seg_grad=5.330e+00, tex_grad=1.250e+00, stats_grad=1.787e-01, enc_grad=2.390e-02, dom_grad=4.260e+00, pred_conf=0.585±0.263, pred_entropy=1.523, prob_range=[0.000,1.000], fg_match=0.728, top_preds=[(83, 479746), (82, 307533), (35, 171679), (78, 125663), (84, 119006)], dom_logits={'mean': 0.1820068359375, 'std': 0.4522484838962555, 'max': 0.6552734375, 'min': -0.289306640625, 'margin': 0.4233625829219818}
2025-11-09 09:32:17 [rank 0] step 0350: total=1.4690, seg=0.9169, domain=0.7881, align=0.0005, stats_align=0.0018, dom_acc=0.500, fg_frac=0.281, label_range=[-1,84], unique_labels=[-1, 4, 5, 6, 7, 9, 19, 20, 22, 24, 25, 26]..., domain_counts=d0=1, d1=1, grad_norm=2.634e+00, seg_grad=1.912e+00, tex_grad=6.691e-01, stats_grad=7.552e-02, enc_grad=1.030e-02, dom_grad=1.682e+00, pred_conf=0.492±0.256, pred_entropy=1.951, prob_range=[0.000,1.000], fg_match=0.814, top_preds=[(83, 394272), (82, 336644), (79, 169186), (84, 155234), (35, 131272)], dom_logits={'mean': 0.137451171875, 'std': 0.4648992121219635, 'max': 0.68017578125, 'min': -0.416015625, 'margin': 0.42645376920700073}
2025-11-09 09:32:27 [rank 0] step 0400: total=1.7406, seg=1.1925, domain=0.7819, align=0.0011, stats_align=0.0030, dom_acc=0.500, fg_frac=0.097, label_range=[-1,84], unique_labels=[-1, 5, 7, 19, 22, 31, 32, 34, 35, 36, 37, 38]..., domain_counts=d0=1, d1=1, grad_norm=6.284e+00, seg_grad=6.014e+00, tex_grad=6.979e-01, stats_grad=7.388e-02, enc_grad=1.092e-02, dom_grad=1.684e+00, pred_conf=0.436±0.265, pred_entropy=2.191, prob_range=[0.000,1.000], fg_match=0.442, top_preds=[(83, 380145), (82, 343951), (79, 169246), (22, 165279), (84, 145322)], dom_logits={'mean': 0.172210693359375, 'std': 0.4247996509075165, 'max': 0.6064453125, 'min': -0.260009765625, 'margin': 0.4008932113647461}
2025-11-09 09:32:32 [rank 0] finished train_epoch
2025-11-09 09:32:32 [rank 0] epoch 17 train summary -> total=1.2476, seg=0.8132, domain=0.6201, align=0.0006, stats=0.0011, dom_acc=0.728, batches=426
2025-11-09 09:32:32 [rank 0] epoch 17 train label dist top -> [(82, 53306596, 0.14923756933201063), (83, 31779214, 0.08896933979130468), (78, 23170836, 0.06486925640554216), (79, 21888760, 0.061279946258278074), (35, 16536534, 0.046295811860433765)], pred dist top -> [(82, 55647048, 0.15578988636402036), (83, 34381712, 0.09625529471896649), (78, 24057416, 0.06735131942402345), (79, 22383262, 0.06266434552711754), (35, 17185710, 0.04811324057989578)], fg_fraction=0.474
2025-11-09 09:32:32 [rank 0] epoch 17 parameter stats -> seg_rms=2.2647e-02 (Δ2.61e-05), domain_rms=9.8460e-02 (Δ-2.34e-05), texproj_rms=6.5920e-02 (Δ1.15e-04), statsproj_rms=1.3404e-01 (Δ2.97e-04), encoder_rms=3.3623e-02 (Δ-1.82e-04)
2025-11-09 09:32:32 [rank 0] checking should_stop
2025-11-09 09:32:32 [rank 0] should_stop -> False
2025-11-09 09:32:32 [rank 0] before can_run_validation decision
2025-11-09 09:32:32 [rank 0] after can_run_validation -> True
2025-11-09 09:32:32 [rank 0] starting validation on main rank
2025-11-09 09:32:34 [rank 0] val-step 001: loss=0.9367, fg_frac=0.780, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.736±0.212, pred_entropy=0.860, prob_range=[0.000,1.000], fg_match=0.502, top_preds=[(83, 166747), (82, 117358), (79, 89763), (81, 62502), (36, 60259)], batch_label_top=[(82, 81983.0), (78, 50461.0), (79, 48532.0), (83, 45983.0), (36, 37134.0)], batch_pred_top=[(82, 93265.0), (79, 89335.0), (81, 61921.0), (36, 60259.0), (38, 47995.0)]
2025-11-09 09:32:34 [rank 0] val-step 002: loss=1.1129, fg_frac=0.752, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.745±0.206, pred_entropy=0.835, prob_range=[0.000,1.000], fg_match=0.329, top_preds=[(83, 197699), (82, 124514), (79, 52500), (78, 51391), (36, 39947)], batch_label_top=[(82, 81668.0), (83, 55922.0), (79, 48795.0), (78, 46165.0), (36, 40828.0)], batch_pred_top=[(82, 91639.0), (83, 56117.0), (79, 52107.0), (78, 51365.0), (36, 39840.0)]
2025-11-09 09:32:35 [rank 0] finished validation on main rank
2025-11-09 09:32:35 [rank 0] epoch 17 val summary -> loss=0.8529, dice=0.0230, duration=2.72s
2025-11-09 09:32:35 [rank 0] epoch 17 val label dist top -> [(82, 1584556, 0.14381113912911525), (83, 1574683, 0.14291508535971753), (78, 733782, 0.06659658938683166), (79, 730461, 0.06629518205692488), (36, 469411, 0.04260280522098122)], pred dist top -> [(82, 1670386, 0.1516008985768419), (83, 1488459, 0.13508956725857826), (79, 936968, 0.08503734510331529), (78, 615263, 0.055840041559905004), (36, 568369, 0.05158403573977575)], dice top -> [(83, 0.9282), (18, 0.8923), (82, 0.8701), (47, 0.7619), (84, 0.7109)]
2025-11-09 09:32:35 [rank 0] scheduler stepped
2025-11-09 09:32:35 [rank 0] epoch 17 lr=4.911394e-05, remaining=81.52 min (avg train=1.94, avg val=0.05)
2025-11-09 09:32:35 [rank 0] metrics logged and best model check complete
2025-11-09 09:32:35 [rank 0] epoch loop completed
2025-11-09 09:32:35 [rank 0] before can_start_epoch decision
2025-11-09 09:32:35 [rank 0] after can_start_epoch decision -> True
2025-11-09 09:32:35 [rank 0] starting train_epoch
2025-11-09 09:32:57 [rank 0] step 0050: total=0.9297, seg=0.6590, domain=0.3866, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.846, label_range=[-1,86], unique_labels=[-1, 0, 8, 9, 10, 12, 14, 16, 17, 18, 20, 21]..., domain_counts=d0=2, grad_norm=2.375e+00, seg_grad=1.605e+00, tex_grad=5.856e-01, stats_grad=1.298e-01, enc_grad=1.806e-02, dom_grad=1.644e+00, pred_conf=0.727±0.215, pred_entropy=1.070, prob_range=[0.000,1.000], fg_match=0.832, top_preds=[(82, 220026), (83, 177196), (22, 128432), (16, 114494), (81, 112442)], dom_logits={'mean': 0.00799560546875, 'std': 0.4035515785217285, 'max': 0.560546875, 'min': -0.475341796875, 'margin': 0.3590993285179138}
2025-11-09 09:33:07 [rank 0] step 0100: total=1.1424, seg=0.9079, domain=0.3350, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.342, label_range=[-1,84], unique_labels=[-1, 4, 6, 10, 20, 32, 36, 40, 46, 47, 48, 50]..., domain_counts=d0=2, grad_norm=5.212e+00, seg_grad=4.924e+00, tex_grad=5.680e-01, stats_grad=1.633e-01, enc_grad=2.101e-02, dom_grad=1.603e+00, pred_conf=0.578±0.266, pred_entropy=1.620, prob_range=[0.000,1.000], fg_match=0.578, top_preds=[(83, 353346), (82, 345272), (84, 164756), (78, 139796), (79, 135276)], dom_logits={'mean': 0.06146240234375, 'std': 0.4609002470970154, 'max': 0.52880859375, 'min': -0.414306640625, 'margin': 0.43065789341926575}
2025-11-09 09:33:17 [rank 0] step 0150: total=1.3951, seg=0.8315, domain=0.8046, align=0.0004, stats_align=0.0015, dom_acc=0.500, fg_frac=0.617, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=1, d1=1, grad_norm=4.188e+00, seg_grad=3.768e+00, tex_grad=7.881e-01, stats_grad=1.058e-01, enc_grad=1.786e-02, dom_grad=1.647e+00, pred_conf=0.733±0.252, pred_entropy=0.968, prob_range=[0.000,1.000], fg_match=0.812, top_preds=[(83, 337769), (82, 307781), (79, 105391), (84, 102574), (80, 95935)], dom_logits={'mean': 0.08038330078125, 'std': 0.4267531633377075, 'max': 0.60888671875, 'min': -0.3955078125, 'margin': 0.3945236802101135}
2025-11-09 09:33:27 [rank 0] step 0200: total=1.0031, seg=0.7836, domain=0.3136, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.506, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=2, grad_norm=2.258e+00, seg_grad=1.661e+00, tex_grad=5.644e-01, stats_grad=1.271e-01, enc_grad=1.962e-02, dom_grad=1.416e+00, pred_conf=0.701±0.259, pred_entropy=1.150, prob_range=[0.000,1.000], fg_match=0.846, top_preds=[(83, 395535), (82, 278462), (79, 134895), (17, 120525), (84, 113930)], dom_logits={'mean': -0.07269287109375, 'std': 0.5160383582115173, 'max': 0.59228515625, 'min': -0.62353515625, 'margin': 0.4623245596885681}
2025-11-09 09:33:37 [rank 0] step 0250: total=1.4557, seg=0.8757, domain=0.8282, align=0.0001, stats_align=0.0012, dom_acc=0.500, fg_frac=0.183, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=1, d1=1, grad_norm=8.754e+00, seg_grad=8.575e+00, tex_grad=7.011e-01, stats_grad=7.838e-02, enc_grad=1.166e-02, dom_grad=1.616e+00, pred_conf=0.522±0.273, pred_entropy=1.842, prob_range=[0.000,1.000], fg_match=0.684, top_preds=[(83, 410010), (82, 312941), (84, 190220), (79, 175168), (78, 87076)], dom_logits={'mean': 0.0465087890625, 'std': 0.5214394927024841, 'max': 0.626953125, 'min': -0.52099609375, 'margin': 0.47647392749786377}
2025-11-09 09:33:47 [rank 0] step 0300: total=1.0038, seg=0.7731, domain=0.3296, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.152, label_range=[-1,84], unique_labels=[-1, 0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20]..., domain_counts=d0=2, grad_norm=4.551e+00, seg_grad=4.255e+00, tex_grad=5.299e-01, stats_grad=8.719e-02, enc_grad=1.288e-02, dom_grad=1.523e+00, pred_conf=0.477±0.266, pred_entropy=1.997, prob_range=[0.000,1.000], fg_match=0.786, top_preds=[(83, 425639), (82, 341973), (79, 195218), (84, 120723), (78, 110118)], dom_logits={'mean': 0.021728515625, 'std': 0.47757381200790405, 'max': 0.49560546875, 'min': -0.5517578125, 'margin': 0.43900901079177856}
2025-11-09 09:33:57 [rank 0] step 0350: total=1.0258, seg=0.7539, domain=0.3885, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.177, label_range=[-1,83], unique_labels=[-1, 0, 8, 9, 12, 14, 16, 17, 18, 26, 28, 31]..., domain_counts=d0=2, grad_norm=1.337e+01, seg_grad=1.323e+01, tex_grad=7.973e-01, stats_grad=1.582e-01, enc_grad=2.170e-02, dom_grad=1.705e+00, pred_conf=0.491±0.292, pred_entropy=1.978, prob_range=[0.000,1.000], fg_match=0.765, top_preds=[(83, 384282), (82, 297457), (84, 143708), (17, 103295), (79, 99310)], dom_logits={'mean': -0.012451171875, 'std': 0.37287792563438416, 'max': 0.378173828125, 'min': -0.4072265625, 'margin': 0.35601311922073364}
2025-11-09 09:34:07 [rank 0] step 0400: total=0.9359, seg=0.6532, domain=0.4038, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.450, label_range=[-1,85], unique_labels=[-1, 11, 13, 18, 19, 21, 22, 27, 29, 31, 32, 33]..., domain_counts=d0=2, grad_norm=2.609e+00, seg_grad=1.722e+00, tex_grad=6.859e-01, stats_grad=1.831e-01, enc_grad=2.361e-02, dom_grad=1.827e+00, pred_conf=0.655±0.259, pred_entropy=1.303, prob_range=[0.000,1.000], fg_match=0.909, top_preds=[(82, 332911), (83, 305420), (84, 183586), (37, 160776), (80, 125444)], dom_logits={'mean': 0.07598876953125, 'std': 0.358818918466568, 'max': 0.483642578125, 'min': -0.3564453125, 'margin': 0.3368682563304901}
2025-11-09 09:34:12 [rank 0] finished train_epoch
2025-11-09 09:34:12 [rank 0] epoch 18 train summary -> total=1.2506, seg=0.8250, domain=0.6075, align=0.0003, stats=0.0011, dom_acc=0.728, batches=426
2025-11-09 09:34:12 [rank 0] epoch 18 train label dist top -> [(82, 53284980, 0.15031793927543402), (83, 31265500, 0.08820056853575027), (78, 23587688, 0.06654131525303911), (79, 23260298, 0.06561774185319202), (35, 16826590, 0.0474681295523171)], pred dist top -> [(82, 56041188, 0.15809324852466708), (83, 34455400, 0.09719933337631625), (78, 24728190, 0.06975869046950231), (79, 23465896, 0.06619773528323473), (35, 17909938, 0.05052427295608685)], fg_fraction=0.471
2025-11-09 09:34:12 [rank 0] epoch 18 parameter stats -> seg_rms=2.2671e-02 (Δ2.32e-05), domain_rms=9.8385e-02 (Δ-7.54e-05), texproj_rms=6.6047e-02 (Δ1.27e-04), statsproj_rms=1.3407e-01 (Δ3.56e-05), encoder_rms=3.3676e-02 (Δ5.24e-05)
2025-11-09 09:34:12 [rank 0] checking should_stop
2025-11-09 09:34:12 [rank 0] should_stop -> False
2025-11-09 09:34:12 [rank 0] before can_run_validation decision
2025-11-09 09:34:12 [rank 0] after can_run_validation -> True
2025-11-09 09:34:12 [rank 0] starting validation on main rank
2025-11-09 09:34:14 [rank 0] val-step 001: loss=0.4930, fg_frac=0.780, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.722±0.205, pred_entropy=0.993, prob_range=[0.000,1.000], fg_match=0.856, top_preds=[(83, 150038), (82, 129933), (78, 49142), (79, 46724), (36, 35764)], batch_label_top=[(82, 81983.0), (78, 50461.0), (79, 48532.0), (83, 45983.0), (36, 37134.0)], batch_pred_top=[(82, 91980.0), (83, 48191.0), (78, 47556.0), (79, 45523.0), (36, 35758.0)]
2025-11-09 09:34:14 [rank 0] val-step 002: loss=0.4626, fg_frac=0.752, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.743±0.203, pred_entropy=0.893, prob_range=[0.000,1.000], fg_match=0.857, top_preds=[(83, 171753), (82, 136043), (79, 53468), (78, 48870), (36, 33642)], batch_label_top=[(82, 81668.0), (83, 55922.0), (79, 48795.0), (78, 46165.0), (36, 40828.0)], batch_pred_top=[(82, 89897.0), (83, 55387.0), (79, 52175.0), (78, 47970.0), (36, 33246.0)]
2025-11-09 09:34:14 [rank 0] finished validation on main rank
2025-11-09 09:34:14 [rank 0] epoch 18 val summary -> loss=0.6333, dice=0.0348, duration=2.69s
2025-11-09 09:34:14 [rank 0] epoch 18 val label dist top -> [(82, 1584556, 0.14381113912911525), (83, 1574683, 0.14291508535971753), (78, 733782, 0.06659658938683166), (79, 730461, 0.06629518205692488), (36, 469411, 0.04260280522098122)], pred dist top -> [(82, 1681658, 0.15262392279325546), (83, 1478149, 0.13415385224161377), (78, 767124, 0.06962264274237288), (79, 665755, 0.06042259467693418), (35, 434120, 0.03939986451645225)], dice top -> [(83, 0.9215), (18, 0.8791), (82, 0.8695), (16, 0.8216), (17, 0.8165)]
2025-11-09 09:34:14 [rank 0] scheduler stepped
2025-11-09 09:34:14 [rank 0] epoch 18 lr=4.900734e-05, remaining=79.85 min (avg train=1.94, avg val=0.05)
2025-11-09 09:34:16 [rank 0] metrics logged and best model check complete
2025-11-09 09:34:16 [rank 0] epoch loop completed
2025-11-09 09:34:16 [rank 0] before can_start_epoch decision
2025-11-09 09:34:16 [rank 0] after can_start_epoch decision -> True
2025-11-09 09:34:16 [rank 0] starting train_epoch
2025-11-09 09:34:38 [rank 0] step 0050: total=1.1108, seg=0.5212, domain=0.8405, align=0.0025, stats_align=0.0041, dom_acc=0.500, fg_frac=0.519, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=1, d1=1, grad_norm=2.613e+00, seg_grad=1.803e+00, tex_grad=9.379e-01, stats_grad=1.227e-01, enc_grad=1.701e-02, dom_grad=1.638e+00, pred_conf=0.690±0.259, pred_entropy=1.146, prob_range=[0.000,1.000], fg_match=0.888, top_preds=[(83, 499609), (82, 342183), (79, 119151), (78, 78493), (84, 65080)], dom_logits={'mean': -0.04400634765625, 'std': 0.39988043904304504, 'max': 0.3515625, 'min': -0.5859375, 'margin': 0.3643535375595093}
2025-11-09 09:34:48 [rank 0] step 0100: total=1.2212, seg=0.6555, domain=0.8069, align=0.0018, stats_align=0.0025, dom_acc=0.500, fg_frac=0.586, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 8, 9, 10, 11]..., domain_counts=d0=1, d1=1, grad_norm=3.202e+00, seg_grad=2.690e+00, tex_grad=7.957e-01, stats_grad=1.183e-01, enc_grad=1.835e-02, dom_grad=1.538e+00, pred_conf=0.681±0.289, pred_entropy=1.261, prob_range=[0.000,1.000], fg_match=0.805, top_preds=[(83, 299131), (82, 250227), (17, 108496), (16, 97192), (65, 83771)], dom_logits={'mean': -0.044342041015625, 'std': 0.3244032859802246, 'max': 0.301025390625, 'min': -0.457275390625, 'margin': 0.3052496314048767}
2025-11-09 09:34:58 [rank 0] step 0150: total=0.7352, seg=0.4355, domain=0.4281, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.779, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11]..., domain_counts=d0=2, grad_norm=2.259e+00, seg_grad=1.387e+00, tex_grad=7.672e-01, stats_grad=2.044e-01, enc_grad=2.845e-02, dom_grad=1.596e+00, pred_conf=0.852±0.201, pred_entropy=0.534, prob_range=[0.000,1.000], fg_match=0.908, top_preds=[(82, 252694), (83, 217687), (79, 197672), (78, 131775), (17, 82172)], dom_logits={'mean': -0.14459228515625, 'std': 0.31461596488952637, 'max': 0.2069091796875, 'min': -0.465576171875, 'margin': 0.3034769594669342}
2025-11-09 09:35:08 [rank 0] step 0200: total=0.8658, seg=0.5631, domain=0.4324, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.456, label_range=[-1,85], unique_labels=[-1, 1, 4, 6, 8, 9, 11, 12, 13, 14, 15, 16]..., domain_counts=d0=2, grad_norm=2.435e+00, seg_grad=1.744e+00, tex_grad=7.532e-01, stats_grad=1.694e-01, enc_grad=2.467e-02, dom_grad=1.514e+00, pred_conf=0.708±0.263, pred_entropy=1.079, prob_range=[0.000,1.000], fg_match=0.918, top_preds=[(83, 419004), (82, 283773), (79, 150814), (84, 118809), (17, 79289)], dom_logits={'mean': -0.138824462890625, 'std': 0.30819597840309143, 'max': 0.1827392578125, 'min': -0.469970703125, 'margin': 0.2981443405151367}
2025-11-09 09:35:18 [rank 0] step 0250: total=1.7319, seg=1.1832, domain=0.7823, align=0.0020, stats_align=0.0032, dom_acc=0.500, fg_frac=0.300, label_range=[-1,84], unique_labels=[-1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]..., domain_counts=d0=1, d1=1, grad_norm=4.062e+00, seg_grad=3.684e+00, tex_grad=8.205e-01, stats_grad=1.184e-01, enc_grad=2.043e-02, dom_grad=1.496e+00, pred_conf=0.598±0.266, pred_entropy=1.534, prob_range=[0.000,1.000], fg_match=0.576, top_preds=[(83, 565125), (82, 316127), (79, 192178), (84, 117371), (78, 63232)], dom_logits={'mean': -0.066070556640625, 'std': 0.3071903884410858, 'max': 0.263427734375, 'min': -0.429931640625, 'margin': 0.2941800653934479}
2025-11-09 09:35:28 [rank 0] step 0300: total=1.2956, seg=0.7450, domain=0.7839, align=0.0022, stats_align=0.0071, dom_acc=0.500, fg_frac=0.599, label_range=[-1,86], unique_labels=[-1, 0, 1, 3, 5, 7, 8, 9, 11, 13, 15, 16]..., domain_counts=d0=1, d1=1, grad_norm=7.692e+00, seg_grad=7.516e+00, tex_grad=7.896e-01, stats_grad=1.150e-01, enc_grad=1.831e-02, dom_grad=1.429e+00, pred_conf=0.662±0.241, pred_entropy=1.103, prob_range=[0.000,1.000], fg_match=0.675, top_preds=[(83, 372606), (82, 300355), (78, 164020), (35, 95042), (84, 85605)], dom_logits={'mean': -0.06146240234375, 'std': 0.3048873245716095, 'max': 0.261962890625, 'min': -0.430419921875, 'margin': 0.2913055419921875}
2025-11-09 09:35:38 [rank 0] step 0350: total=1.1745, seg=0.8378, domain=0.4811, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.329, label_range=[-1,83], unique_labels=[-1, 12, 16, 17, 18, 21, 22, 26, 28, 33, 34, 35]..., domain_counts=d0=2, grad_norm=4.712e+00, seg_grad=4.211e+00, tex_grad=8.175e-01, stats_grad=1.614e-01, enc_grad=3.837e-02, dom_grad=1.943e+00, pred_conf=0.529±0.277, pred_entropy=1.744, prob_range=[0.000,1.000], fg_match=0.726, top_preds=[(83, 376972), (82, 339171), (84, 182736), (79, 134561), (38, 79283)], dom_logits={'mean': -0.082733154296875, 'std': 0.24193255603313446, 'max': 0.1895751953125, 'min': -0.329345703125, 'margin': 0.2362854778766632}
2025-11-09 09:35:47 [rank 0] step 0400: total=1.8552, seg=1.0475, domain=1.1538, align=0.0000, stats_align=0.0000, dom_acc=0.000, fg_frac=0.499, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 8, 9, 10, 12]..., domain_counts=d0=0, d1=2, grad_norm=7.144e+00, seg_grad=6.085e+00, tex_grad=1.376e+00, stats_grad=2.748e-01, enc_grad=6.767e-02, dom_grad=3.470e+00, pred_conf=0.611±0.248, pred_entropy=1.426, prob_range=[0.000,1.000], fg_match=0.365, top_preds=[(83, 498489), (82, 330381), (84, 125876), (78, 95631), (79, 92146)], dom_logits={'mean': -0.122802734375, 'std': 0.38741806149482727, 'max': 0.274658203125, 'min': -0.52490234375, 'margin': 0.36889952421188354}
2025-11-09 09:35:52 [rank 0] finished train_epoch
2025-11-09 09:35:52 [rank 0] epoch 19 train summary -> total=1.2596, seg=0.8120, domain=0.6390, align=0.0007, stats=0.0012, dom_acc=0.728, batches=426
2025-11-09 09:35:52 [rank 0] epoch 19 train label dist top -> [(82, 54500680, 0.15246614095169475), (83, 32314264, 0.09039944326885968), (78, 24492918, 0.06851915770787266), (79, 22995624, 0.06433046431817319), (35, 17400692, 0.04867859188415681)], pred dist top -> [(82, 56882416, 0.1591290505145157), (83, 35102772, 0.09820030813718474), (78, 25001340, 0.06994146478923437), (79, 23494472, 0.06572598853220078), (35, 18098420, 0.05063048641275928)], fg_fraction=0.475
2025-11-09 09:35:52 [rank 0] epoch 19 parameter stats -> seg_rms=2.2695e-02 (Δ2.41e-05), domain_rms=9.8233e-02 (Δ-1.52e-04), texproj_rms=6.6247e-02 (Δ2.01e-04), statsproj_rms=1.3430e-01 (Δ2.28e-04), encoder_rms=3.3938e-02 (Δ2.62e-04)
2025-11-09 09:35:52 [rank 0] checking should_stop
2025-11-09 09:35:52 [rank 0] should_stop -> False
2025-11-09 09:35:52 [rank 0] before can_run_validation decision
2025-11-09 09:35:52 [rank 0] after can_run_validation -> True
2025-11-09 09:35:52 [rank 0] starting validation on main rank
2025-11-09 09:35:54 [rank 0] val-step 001: loss=0.5378, fg_frac=0.780, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.687±0.210, pred_entropy=1.126, prob_range=[0.000,1.000], fg_match=0.848, top_preds=[(83, 158225), (82, 126693), (78, 53491), (79, 48499), (35, 37534)], batch_label_top=[(82, 81983.0), (78, 50461.0), (79, 48532.0), (83, 45983.0), (36, 37134.0)], batch_pred_top=[(82, 96590.0), (78, 50071.0), (83, 47956.0), (79, 45263.0), (35, 37515.0)]
2025-11-09 09:35:54 [rank 0] val-step 002: loss=0.4949, fg_frac=0.752, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.710±0.215, pred_entropy=1.018, prob_range=[0.000,1.000], fg_match=0.845, top_preds=[(83, 174595), (82, 127048), (78, 54628), (79, 52207), (35, 37073)], batch_label_top=[(82, 81668.0), (83, 55922.0), (79, 48795.0), (78, 46165.0), (36, 40828.0)], batch_pred_top=[(82, 94872.0), (83, 53560.0), (78, 52573.0), (79, 49312.0), (35, 36764.0)]
2025-11-09 09:35:55 [rank 0] finished validation on main rank
2025-11-09 09:35:55 [rank 0] epoch 19 val summary -> loss=0.6985, dice=0.0328, duration=2.73s
2025-11-09 09:35:55 [rank 0] epoch 19 val label dist top -> [(82, 1584556, 0.14381113912911525), (83, 1574683, 0.14291508535971753), (78, 733782, 0.06659658938683166), (79, 730461, 0.06629518205692488), (36, 469411, 0.04260280522098122)], pred dist top -> [(82, 1766603, 0.1603333614078091), (83, 1456057, 0.13214882642640724), (78, 978216, 0.08878093123520191), (35, 581583, 0.052783311999151955), (79, 502077, 0.04556750616609876)], dice top -> [(83, 0.9139), (18, 0.8842), (82, 0.8666), (17, 0.7954), (16, 0.7794)]
2025-11-09 09:35:55 [rank 0] scheduler stepped
2025-11-09 09:35:55 [rank 0] epoch 19 lr=4.889483e-05, remaining=78.18 min (avg train=1.93, avg val=0.05)
2025-11-09 09:35:55 [rank 0] metrics logged and best model check complete
2025-11-09 09:35:55 [rank 0] epoch loop completed
2025-11-09 09:35:55 [rank 0] before can_start_epoch decision
2025-11-09 09:35:55 [rank 0] after can_start_epoch decision -> True
2025-11-09 09:35:55 [rank 0] starting train_epoch
2025-11-09 09:36:17 [rank 0] step 0050: total=1.7597, seg=0.8700, domain=1.2710, align=0.0000, stats_align=0.0000, dom_acc=0.000, fg_frac=0.468, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 8, 9, 10, 12]..., domain_counts=d0=0, d1=2, grad_norm=6.255e+00, seg_grad=4.541e+00, tex_grad=1.518e+00, stats_grad=2.330e-01, enc_grad=7.486e-02, dom_grad=4.017e+00, pred_conf=0.582±0.265, pred_entropy=1.497, prob_range=[0.000,1.000], fg_match=0.541, top_preds=[(83, 408780), (82, 366642), (84, 149327), (79, 87733), (36, 53370)], dom_logits={'mean': -0.1976318359375, 'std': 0.47152402997016907, 'max': 0.29248046875, 'min': -0.70556640625, 'margin': 0.43838220834732056}
2025-11-09 09:36:27 [rank 0] step 0100: total=1.4857, seg=1.1764, domain=0.4419, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.458, label_range=[-1,84], unique_labels=[-1, 9, 19, 20, 21, 23, 24, 25, 26, 27, 28, 29]..., domain_counts=d0=2, grad_norm=3.373e+00, seg_grad=2.903e+00, tex_grad=6.900e-01, stats_grad=1.797e-01, enc_grad=1.828e-02, dom_grad=1.562e+00, pred_conf=0.632±0.289, pred_entropy=1.414, prob_range=[0.000,1.000], fg_match=0.742, top_preds=[(83, 341577), (82, 334113), (78, 174026), (79, 152545), (84, 139343)], dom_logits={'mean': -0.140106201171875, 'std': 0.29642772674560547, 'max': 0.1685791015625, 'min': -0.48583984375, 'margin': 0.2857000231742859}
2025-11-09 09:36:37 [rank 0] step 0150: total=0.8168, seg=0.5516, domain=0.3789, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.663, label_range=[-1,86], unique_labels=[-1, 1, 2, 3, 4, 5, 6, 7, 9, 10, 11, 12]..., domain_counts=d0=2, grad_norm=2.066e+00, seg_grad=1.124e+00, tex_grad=5.826e-01, stats_grad=1.244e-01, enc_grad=1.974e-02, dom_grad=1.628e+00, pred_conf=0.722±0.239, pred_entropy=1.026, prob_range=[0.000,1.000], fg_match=0.926, top_preds=[(79, 306290), (83, 280549), (82, 264289), (36, 124501), (84, 71202)], dom_logits={'mean': -0.10308837890625, 'std': 0.3943054676055908, 'max': 0.372314453125, 'min': -0.54296875, 'margin': 0.3692183494567871}
2025-11-09 09:36:47 [rank 0] step 0200: total=1.7350, seg=0.8846, domain=1.2148, align=0.0000, stats_align=0.0000, dom_acc=0.000, fg_frac=0.558, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=0, d1=2, grad_norm=5.979e+00, seg_grad=4.335e+00, tex_grad=1.364e+00, stats_grad=1.967e-01, enc_grad=3.970e-02, dom_grad=3.879e+00, pred_conf=0.649±0.268, pred_entropy=1.281, prob_range=[0.000,1.000], fg_match=0.579, top_preds=[(83, 445417), (82, 351935), (79, 167741), (36, 116206), (78, 108091)], dom_logits={'mean': -0.184173583984375, 'std': 0.43697237968444824, 'max': 0.257568359375, 'min': -0.7177734375, 'margin': 0.40528905391693115}
2025-11-09 09:36:57 [rank 0] step 0250: total=1.1608, seg=0.8792, domain=0.4023, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.487, label_range=[-1,84], unique_labels=[-1, 9, 19, 20, 30, 31, 32, 33, 34, 35, 36, 37]..., domain_counts=d0=2, grad_norm=7.496e+00, seg_grad=7.294e+00, tex_grad=5.962e-01, stats_grad=1.195e-01, enc_grad=1.730e-02, dom_grad=1.618e+00, pred_conf=0.617±0.273, pred_entropy=1.401, prob_range=[0.000,1.000], fg_match=0.808, top_preds=[(82, 332581), (83, 286895), (79, 184002), (78, 134938), (36, 106630)], dom_logits={'mean': -0.11151123046875, 'std': 0.3558271527290344, 'max': 0.277099609375, 'min': -0.52001953125, 'margin': 0.33815813064575195}
2025-11-09 09:37:07 [rank 0] step 0300: total=1.0268, seg=0.5073, domain=0.7417, align=0.0007, stats_align=0.0006, dom_acc=0.500, fg_frac=0.586, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., domain_counts=d0=1, d1=1, grad_norm=1.009e+01, seg_grad=9.986e+00, tex_grad=6.934e-01, stats_grad=1.914e-01, enc_grad=2.963e-02, dom_grad=1.254e+00, pred_conf=0.724±0.255, pred_entropy=0.937, prob_range=[0.000,1.000], fg_match=0.812, top_preds=[(83, 360845), (82, 293263), (84, 127035), (17, 92634), (16, 86812)], dom_logits={'mean': -0.161224365234375, 'std': 0.3059556782245636, 'max': 0.19482421875, 'min': -0.525390625, 'margin': 0.29126909375190735}
2025-11-09 09:37:17 [rank 0] step 0350: total=1.0937, seg=0.5052, domain=0.8402, align=0.0003, stats_align=0.0014, dom_acc=0.500, fg_frac=0.699, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 6, 8, 9, 10, 11, 12, 13, 14]..., domain_counts=d0=1, d1=1, grad_norm=2.568e+00, seg_grad=1.947e+00, tex_grad=7.005e-01, stats_grad=8.746e-02, enc_grad=1.767e-02, dom_grad=1.518e+00, pred_conf=0.761±0.230, pred_entropy=0.850, prob_range=[0.000,1.000], fg_match=0.904, top_preds=[(83, 309801), (82, 222285), (80, 134222), (37, 120916), (84, 88375)], dom_logits={'mean': -0.08721923828125, 'std': 0.37324008345603943, 'max': 0.346923828125, 'min': -0.541015625, 'margin': 0.3473000228404999}
2025-11-09 09:37:27 [rank 0] step 0400: total=1.3092, seg=0.7261, domain=0.8329, align=0.0002, stats_align=0.0005, dom_acc=0.500, fg_frac=0.177, label_range=[-1,84], unique_labels=[-1, 1, 2, 3, 4, 5, 6, 8, 9, 10, 12, 13]..., domain_counts=d0=1, d1=1, grad_norm=3.489e+00, seg_grad=2.992e+00, tex_grad=7.935e-01, stats_grad=9.627e-02, enc_grad=2.075e-02, dom_grad=1.607e+00, pred_conf=0.525±0.280, pred_entropy=1.829, prob_range=[0.000,1.000], fg_match=0.681, top_preds=[(83, 434187), (82, 363392), (78, 182983), (35, 152184), (84, 147815)], dom_logits={'mean': -0.08636474609375, 'std': 0.3759801387786865, 'max': 0.375, 'min': -0.50390625, 'margin': 0.3512122333049774}
2025-11-09 09:37:32 [rank 0] finished train_epoch
2025-11-09 09:37:32 [rank 0] epoch 20 train summary -> total=1.2461, seg=0.8160, domain=0.6140, align=0.0004, stats=0.0010, dom_acc=0.728, batches=426
2025-11-09 09:37:32 [rank 0] epoch 20 train label dist top -> [(82, 51814180, 0.14721451132839203), (83, 31635776, 0.08988360530523638), (78, 21672268, 0.06157527423956045), (79, 20835886, 0.059198944682403255), (35, 15515078, 0.04408145851177971)], pred dist top -> [(82, 54221720, 0.15405482084820887), (83, 34365988, 0.09764068946192958), (78, 22742804, 0.06461688407903564), (79, 20846724, 0.05922973913575697), (35, 16546318, 0.047011420058004315)], fg_fraction=0.467
2025-11-09 09:37:32 [rank 0] epoch 20 parameter stats -> seg_rms=2.2714e-02 (Δ1.90e-05), domain_rms=9.8165e-02 (Δ-6.84e-05), texproj_rms=6.6295e-02 (Δ4.70e-05), statsproj_rms=1.3451e-01 (Δ2.07e-04), encoder_rms=3.3837e-02 (Δ-1.00e-04)
2025-11-09 09:37:32 [rank 0] checking should_stop
2025-11-09 09:37:32 [rank 0] should_stop -> False
2025-11-09 09:37:32 [rank 0] before can_run_validation decision
2025-11-09 09:37:32 [rank 0] after can_run_validation -> True
2025-11-09 09:37:32 [rank 0] starting validation on main rank
2025-11-09 09:37:34 [rank 0] val-step 001: loss=0.5557, fg_frac=0.780, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.685±0.212, pred_entropy=1.081, prob_range=[0.000,1.000], fg_match=0.836, top_preds=[(83, 154242), (82, 132142), (79, 53275), (78, 45294), (36, 42294)], batch_label_top=[(82, 81983.0), (78, 50461.0), (79, 48532.0), (83, 45983.0), (36, 37134.0)], batch_pred_top=[(82, 88491.0), (79, 52580.0), (83, 50643.0), (78, 43840.0), (36, 42289.0)]
2025-11-09 09:37:34 [rank 0] val-step 002: loss=0.4535, fg_frac=0.752, label_range=[-1,86], unique_labels=[-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]..., pred_conf=0.733±0.205, pred_entropy=0.933, prob_range=[0.000,1.000], fg_match=0.861, top_preds=[(83, 167796), (82, 125401), (79, 56238), (78, 51977), (84, 40935)], batch_label_top=[(82, 81668.0), (83, 55922.0), (79, 48795.0), (78, 46165.0), (36, 40828.0)], batch_pred_top=[(82, 88720.0), (83, 55444.0), (79, 54441.0), (78, 49243.0), (36, 37208.0)]
2025-11-09 09:37:35 [rank 0] finished validation on main rank
2025-11-09 09:37:35 [rank 0] epoch 20 val summary -> loss=0.7769, dice=0.0271, duration=2.85s
2025-11-09 09:37:35 [rank 0] epoch 20 val label dist top -> [(82, 1584556, 0.14381113912911525), (83, 1574683, 0.14291508535971753), (78, 733782, 0.06659658938683166), (79, 730461, 0.06629518205692488), (36, 469411, 0.04260280522098122)], pred dist top -> [(82, 1651910, 0.1499240537025998), (83, 1501369, 0.13626125308486453), (79, 970811, 0.08810886821865273), (36, 564698, 0.0512508631086141), (78, 515762, 0.04680952944516365)], dice top -> [(83, 0.924), (18, 0.8872), (82, 0.8757), (47, 0.7599), (84, 0.712)]
2025-11-09 09:37:35 [rank 0] scheduler stepped
2025-11-09 09:37:35 [rank 0] epoch 20 lr=4.877641e-05, remaining=76.52 min (avg train=1.93, avg val=0.05)
2025-11-09 09:37:35 [rank 0] metrics logged and best model check complete
2025-11-09 09:37:36 [rank 0] epoch loop completed
2025-11-09 09:37:36 [rank 0] before can_start_epoch decision
2025-11-09 09:37:36 [rank 0] after can_start_epoch decision -> True
2025-11-09 09:37:36 [rank 0] starting train_epoch
2025-11-09 09:37:58 [rank 0] step 0050: total=0.8639, seg=0.6112, domain=0.3610, align=0.0000, stats_align=0.0000, dom_acc=1.000, fg_frac=0.575, label_range=[-1,85], unique_labels=[-1, 0, 1, 3, 5, 7, 8, 9, 11, 12, 13, 14]..., domain_counts=d0=2, grad_norm=2.195e+00, seg_grad=1.339e+00, tex_grad=6.021e-01, stats_grad=1.557e-01, enc_grad=2.617e-02, dom_grad=1.624e+00, pred_conf=0.726±0.249, pred_entropy=1.010, prob_range=[0.000,1.000], fg_match=0.907, top_preds=[(83, 312655), (82, 235150), (78, 216240), (84, 144628), (16, 132758)], dom_logits={'mean': -0.300323486328125, 'std': 0.4173189699649811, 'max': 0.141357421875, 'min': -0.74462890625, 'margin': 0.39395472407341003}
